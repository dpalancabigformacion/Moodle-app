{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{M7Gs:function(i,s,e){\"use strict\";e.r(s),e.d(s,\"AddonModAssignLazyModule\",(function(){return ai}));var t=e(\"vY5A\"),n=e(\"L3Fv\"),o=e(\"tyNb\"),a=e(\"MLi9\"),d=e(\"Y+03\"),c=e(\"sYk5\"),r=e(\"mrSG\"),u=e(\"93ts\"),l=e(\"2tv+\"),m=e(\"pHTc\"),g=e(\"9+EE\"),_=e(\"uT8i\"),h=e(\"3LXp\"),b=e(\"4reR\"),p=e(\"j3ag\"),f=e(\"fjkH\"),A=e(\"djuo\"),I=e(\"JDIg\"),v=e(\"W4Cf\"),S=e(\"jQ6G\"),M=e(\"bFG1\"),P=e(\"fXoL\"),E=e(\"TEn/\"),y=e(\"hMzs\"),T=e(\"ACYt\"),D=e(\"nt/U\"),O=e(\"PgjG\"),x=e(\"ofXK\"),L=e(\"3Pt+\"),w=e(\"rztj\"),C=e(\"5450\"),V=e(\"akXa\"),R=e(\"sYmb\");const k=[\"editSubmissionForm\"],_c1=function(){return[300,900]};function AddonModAssignEditPage_ion_list_14_core_timer_1_Template(i,s){if(1&i){const i=P.Fc();P.Ec(0,\"core-timer\",12),P.Mc(\"finished\",(function AddonModAssignEditPage_ion_list_14_core_timer_1_Template_core_timer_finished_0_listener(){P.fd(i);return P.Oc(2).timeUp()})),P.Pc(1,\"translate\"),P.Dc()}if(2&i){const i=P.Oc(2);P.Vc(\"endTime\",i.timeLimitEndTime)(\"timerText\",P.Qc(1,5,\"addon.mod_assign.assigntimeleft\"))(\"align\",\"center\")(\"timeLeftClassThreshold\",-1)(\"underTimeClassThresholds\",P.Zc(7,_c1))}}function AddonModAssignEditPage_ion_list_14_ion_item_2_Template(i,s){if(1&i&&(P.Ec(0,\"ion-item\",13),P.Ec(1,\"ion-label\"),P.zc(2,\"core-format-text\",14),P.Dc(),P.Dc()),2&i){const i=P.Oc(2);P.lc(2),P.Vc(\"text\",i.activityInstructions)(\"component\",i.component)(\"componentId\",i.moduleId)(\"contextInstanceId\",i.moduleId)(\"courseId\",i.courseId)(\"maxHeight\",120)}}function AddonModAssignEditPage_ion_list_14_ng_container_3_core_file_1_Template(i,s){if(1&i&&P.zc(0,\"core-file\",16),2&i){const i=s.$implicit,e=P.Oc(3);P.Vc(\"file\",i)(\"component\",e.component)(\"componentId\",e.moduleId)}}function AddonModAssignEditPage_ion_list_14_ng_container_3_Template(i,s){if(1&i&&(P.Cc(0),P.nd(1,AddonModAssignEditPage_ion_list_14_ng_container_3_core_file_1_Template,1,3,\"core-file\",15),P.Bc()),2&i){const i=P.Oc(2);P.lc(1),P.Vc(\"ngForOf\",i.introAttachments)}}function AddonModAssignEditPage_ion_list_14_ion_item_6_Template(i,s){if(1&i){const i=P.Fc();P.Ec(0,\"ion-item\",13),P.Ec(1,\"ion-label\"),P.zc(2,\"core-format-text\",17),P.Dc(),P.Ec(3,\"ion-checkbox\",18),P.Mc(\"ngModelChange\",(function AddonModAssignEditPage_ion_list_14_ion_item_6_Template_ion_checkbox_ngModelChange_3_listener(s){P.fd(i);return P.Oc(2).submissionStatementAccepted=s})),P.Dc(),P.zc(4,\"input\",19),P.Dc()}if(2&i){const i=P.Oc(2);P.lc(2),P.Vc(\"text\",i.submissionStatement)(\"filter\",!1),P.lc(1),P.Vc(\"ngModel\",i.submissionStatementAccepted),P.lc(1),P.Vc(\"ngModel\",i.submissionStatementAccepted)}}function AddonModAssignEditPage_ion_list_14_addon_mod_assign_submission_plugin_7_Template(i,s){if(1&i&&P.zc(0,\"addon-mod-assign-submission-plugin\",20),2&i){const i=s.$implicit,e=P.Oc(2);P.Vc(\"assign\",e.assign)(\"submission\",e.userSubmission)(\"plugin\",i)(\"edit\",!0)(\"allowOffline\",e.allowOffline)}}function AddonModAssignEditPage_ion_list_14_Template(i,s){if(1&i&&(P.Ec(0,\"ion-list\"),P.nd(1,AddonModAssignEditPage_ion_list_14_core_timer_1_Template,2,8,\"core-timer\",7),P.nd(2,AddonModAssignEditPage_ion_list_14_ion_item_2_Template,3,6,\"ion-item\",8),P.nd(3,AddonModAssignEditPage_ion_list_14_ng_container_3_Template,2,1,\"ng-container\",6),P.Ec(4,\"form\",9,10),P.nd(6,AddonModAssignEditPage_ion_list_14_ion_item_6_Template,5,4,\"ion-item\",8),P.nd(7,AddonModAssignEditPage_ion_list_14_addon_mod_assign_submission_plugin_7_Template,1,5,\"addon-mod-assign-submission-plugin\",11),P.Dc(),P.Dc()),2&i){const i=P.Oc();P.lc(1),P.Vc(\"ngIf\",i.timeLimitEndTime>0),P.lc(1),P.Vc(\"ngIf\",i.activityInstructions),P.lc(1),P.Vc(\"ngIf\",null==i.assign?null:i.assign.submissionattachments),P.lc(3),P.Vc(\"ngIf\",i.submissionStatement),P.lc(1),P.Vc(\"ngForOf\",i.userSubmission.plugins)}}let N=(()=>{class AddonModAssignEditPage{constructor(i){this.route=i,this.allowOffline=!1,this.submissionStatementAccepted=!1,this.loaded=!1,this.timeLimitEndTime=0,this.component=A.d.COMPONENT,this.isBlind=!1,this.saveOffline=!1,this.hasOffline=!1,this.isDestroyed=!1,this.forceLeave=!1,this.userId=g.b.getCurrentSiteUserId(),this.editText=p.M.instant(\"addon.mod_assign.editsubmission\"),this.title=this.editText}ngOnInit(){try{this.moduleId=m.a.getRequiredRouteNumberParam(\"cmId\"),this.courseId=m.a.getRequiredRouteNumberParam(\"courseId\"),this.isBlind=!!m.a.getRouteNumberParam(\"blindId\")}catch(i){return h.a.showErrorModal(i),m.a.back(),void 0}this.fetchAssignment().finally((()=>{this.loaded=!0}))}canLeave(){return Object(r.a)(this,void 0,void 0,(function*(){if(this.forceLeave)return!0;return(yield this.hasDataChanged())&&(yield h.a.showConfirm(p.M.instant(\"core.confirmcanceledit\"))),I.a.clearSubmissionPluginTmpData(this.assign,this.userSubmission,this.getInputData()),b.a.triggerFormCancelledEvent(this.formElement,g.b.getCurrentSiteId()),!0}))}fetchAssignment(){var i,s,e,t,n,o,a;return Object(r.a)(this,void 0,void 0,(function*(){const d=g.b.getCurrentSiteUserId();try{this.assign=yield A.a.getAssignment(this.courseId,this.moduleId),this.title=this.assign.name||this.title,this.isDestroyed||_.a.blockOperation(A.d.COMPONENT,this.assign.id),yield S.a.waitForSync(this.assign.id);const c={userId:this.userId,isBlind:this.isBlind,cmId:this.assign.cmid,filter:!1,readingStrategy:2};let r;try{r=yield A.a.getSubmissionStatus(this.assign.id,c),this.userSubmission=A.a.getSubmissionObjectFromAttempt(this.assign,r.lastattempt)}catch(i){c.filter=!0,c.readingStrategy=1,r=yield A.a.getSubmissionStatus(this.assign.id,c),this.userSubmission=A.a.getSubmissionObjectFromAttempt(this.assign,r.lastattempt);if(!(yield I.a.canEditSubmissionOffline(this.assign,this.userSubmission)))throw this.allowOffline=!1,i}if(!(null===(i=r.lastattempt)||void 0===i?void 0:i.canedit))throw new u.a(p.M.instant(\"core.nopermissions\",{$a:this.editText}));if(r=yield this.startSubmissionIfNeeded(r,c),null===(s=r.assignmentdata)||void 0===s?void 0:s.activity){const i=c.filter?r:yield A.a.getSubmissionStatus(this.assign.id,Object.assign(Object.assign({},c),{filter:!0}));this.activityInstructions=null===(e=i.assignmentdata)||void 0===e?void 0:e.activity}this.introAttachments=null!==(o=null===(n=null===(t=r.assignmentdata)||void 0===t?void 0:t.attachments)||void 0===n?void 0:n.intro)&&void 0!==o?o:this.assign.introattachments,this.allowOffline=!0,this.submissionStatement=this.assign.requiresubmissionstatement&&!this.assign.submissiondrafts&&this.userId==d?this.assign.submissionstatement:void 0,this.timeLimitEndTime=this.assign.timelimit&&(null===(a=this.userSubmission)||void 0===a?void 0:a.timestarted)?I.a.calculateEndTime(this.assign,this.userSubmission):0;try{const i=yield v.a.getSubmission(this.assign.id,this.userId);this.hasOffline=(null==i?void 0:i.plugindata)&&Object.keys(i.plugindata).length>0}catch(i){this.hasOffline=!1}}catch(i){h.a.showErrorModalDefault(i,\"Error getting assigment data.\"),this.leaveWithoutCheck()}}))}startSubmissionIfNeeded(i,s){return Object(r.a)(this,void 0,void 0,(function*(){if(!this.assign||!this.assign.timelimit)return i;if(this.userSubmission&&this.userSubmission.status!==A.e.NEW&&this.userSubmission.status!==A.e.REOPENED)return i;yield A.a.startSubmission(this.assign.id),f.b.trigger(A.d.STARTED_EVENT,{assignmentId:this.assign.id},g.b.getCurrentSiteId());const e=yield A.a.getSubmissionStatus(this.assign.id,Object.assign(Object.assign({},s),{readingStrategy:2}));return this.userSubmission=A.a.getSubmissionObjectFromAttempt(this.assign,e.lastattempt),e}))}getInputData(){return b.a.getDataFromForm(document.forms[\"addon-mod_assign-edit-form\"])}hasDataChanged(){return Object(r.a)(this,void 0,void 0,(function*(){const i=yield h.a.showModalLoading(),s=this.getInputData();return I.a.hasSubmissionDataChanged(this.assign,this.userSubmission,s).finally((()=>{i.dismiss()}))}))}leaveWithoutCheck(){this.forceLeave=!0,m.a.back()}prepareSubmissionData(i){return Object(r.a)(this,void 0,void 0,(function*(){this.saveOffline=this.hasOffline;try{return yield I.a.prepareSubmissionPluginData(this.assign,this.userSubmission,i,this.hasOffline)}catch(s){if(this.allowOffline&&!this.saveOffline&&!M.a.isWebServiceError(s))return this.saveOffline=!0,yield I.a.prepareSubmissionPluginData(this.assign,this.userSubmission,i,!0);throw s}}))}save(){return Object(r.a)(this,void 0,void 0,(function*(){if(!(yield this.hasDataChanged()))return this.leaveWithoutCheck(),void 0;try{yield this.saveSubmission(),this.leaveWithoutCheck()}catch(i){h.a.showErrorModalDefault(i,\"Error saving submission.\")}}))}saveSubmission(){return Object(r.a)(this,void 0,void 0,(function*(){const i=this.getInputData();if(this.submissionStatement&&(!i.submissionstatement||\"false\"===i.submissionstatement))throw p.M.instant(\"addon.mod_assign.acceptsubmissionstatement\");let s=yield h.a.showModalLoading(),e=-1;try{e=yield I.a.getSubmissionSizeForEdit(this.assign,this.userSubmission,i)}catch(i){e=-1}s.dismiss();try{yield l.a.confirmUploadFile(e,!0,this.allowOffline),s=yield h.a.showModalLoading(\"core.sending\",!0);const t=yield this.prepareSubmissionData(i);if(!Object.keys(t).length)return;let n;this.saveOffline?(n=!1,yield v.a.saveSubmission(this.assign.id,this.courseId,t,this.userSubmission.timemodified,!this.assign.submissiondrafts,this.userId)):n=yield A.a.saveSubmission(this.assign.id,this.courseId,t,this.allowOffline,this.userSubmission.timemodified,!!this.assign.submissiondrafts,this.userId),I.a.clearSubmissionPluginTmpData(this.assign,this.userSubmission,i),n&&f.b.trigger(f.b.ACTIVITY_DATA_SENT,{module:\"assign\"}),b.a.triggerFormSubmittedEvent(this.formElement,n,g.b.getCurrentSiteId()),f.b.trigger(A.d.SUBMISSION_SAVED_EVENT,{assignmentId:this.assign.id,submissionId:this.userSubmission.id,userId:this.userId},g.b.getCurrentSiteId()),this.assign.submissiondrafts||f.b.trigger(A.d.SUBMITTED_FOR_GRADING_EVENT,{assignmentId:this.assign.id,submissionId:this.userSubmission.id,userId:this.userId},g.b.getCurrentSiteId())}finally{s.dismiss()}}))}timeUp(){return Object(r.a)(this,void 0,void 0,(function*(){this.timeUpToast=yield h.a.showToastWithOptions({message:p.M.instant(\"addon.mod_assign.caneditsubmission\"),duration:0,buttons:[p.M.instant(\"core.dismiss\")],cssClass:\"core-danger-toast\"})}))}ngOnDestroy(){var i;this.isDestroyed=!0,null===(i=this.timeUpToast)||void 0===i||i.dismiss(),this.assign&&_.a.unblockOperation(A.d.COMPONENT,this.assign.id)}}return AddonModAssignEditPage.ɵfac=function AddonModAssignEditPage_Factory(i){return new(i||AddonModAssignEditPage)(P.yc(o.a))},AddonModAssignEditPage.ɵcmp=P.sc({type:AddonModAssignEditPage,selectors:[[\"page-addon-mod-assign-edit\"]],viewQuery:function AddonModAssignEditPage_Query(i,s){var e;(1&i&&P.ud(k,!0),2&i)&&(P.dd(e=P.Nc())&&(s.formElement=e.first))},decls:15,vars:11,consts:[[\"slot\",\"start\"],[3,\"text\"],[\"contextLevel\",\"module\",3,\"text\",\"contextInstanceId\",\"courseId\"],[\"slot\",\"end\"],[\"fill\",\"clear\",3,\"click\"],[3,\"hideUntil\"],[4,\"ngIf\"],[\"timeUpText\",\"00:00:00\",\"class\",\"ion-margin-horizontal\",3,\"endTime\",\"timerText\",\"align\",\"timeLeftClassThreshold\",\"underTimeClassThresholds\",\"finished\",4,\"ngIf\"],[\"class\",\"ion-text-wrap\",4,\"ngIf\"],[\"name\",\"addon-mod_assign-edit-form\"],[\"editSubmissionForm\",\"\"],[3,\"assign\",\"submission\",\"plugin\",\"edit\",\"allowOffline\",4,\"ngFor\",\"ngForOf\"],[\"timeUpText\",\"00:00:00\",1,\"ion-margin-horizontal\",3,\"endTime\",\"timerText\",\"align\",\"timeLeftClassThreshold\",\"underTimeClassThresholds\",\"finished\"],[1,\"ion-text-wrap\"],[\"contextLevel\",\"module\",3,\"text\",\"component\",\"componentId\",\"contextInstanceId\",\"courseId\",\"maxHeight\"],[3,\"file\",\"component\",\"componentId\",4,\"ngFor\",\"ngForOf\"],[3,\"file\",\"component\",\"componentId\"],[3,\"text\",\"filter\"],[\"slot\",\"end\",\"name\",\"submissionstatement\",3,\"ngModel\",\"ngModelChange\"],[\"type\",\"hidden\",\"name\",\"submissionstatement\",3,\"ngModel\"],[3,\"assign\",\"submission\",\"plugin\",\"edit\",\"allowOffline\"]],template:function AddonModAssignEditPage_Template(i,s){1&i&&(P.Ec(0,\"ion-header\"),P.Ec(1,\"ion-toolbar\"),P.Ec(2,\"ion-buttons\",0),P.zc(3,\"ion-back-button\",1),P.Pc(4,\"translate\"),P.Dc(),P.Ec(5,\"ion-title\"),P.Ec(6,\"h1\"),P.zc(7,\"core-format-text\",2),P.Dc(),P.Dc(),P.Ec(8,\"ion-buttons\",3),P.Ec(9,\"ion-button\",4),P.Mc(\"click\",(function AddonModAssignEditPage_Template_ion_button_click_9_listener(){return s.save()})),P.pd(10),P.Pc(11,\"translate\"),P.Dc(),P.Dc(),P.Dc(),P.Dc(),P.Ec(12,\"ion-content\"),P.Ec(13,\"core-loading\",5),P.nd(14,AddonModAssignEditPage_ion_list_14_Template,8,5,\"ion-list\",6),P.Dc(),P.Dc()),2&i&&(P.lc(3),P.Vc(\"text\",P.Qc(4,7,\"core.back\")),P.lc(4),P.Vc(\"text\",s.title)(\"contextInstanceId\",s.moduleId)(\"courseId\",s.courseId),P.lc(3),P.rd(\" \",P.Qc(11,9,\"core.save\"),\" \"),P.lc(3),P.Vc(\"hideUntil\",s.loaded),P.lc(1),P.Vc(\"ngIf\",s.userSubmission&&s.userSubmission.plugins&&s.userSubmission.plugins.length))},directives:[E.C,E.Ab,E.m,E.h,E.i,E.yb,y.a,T.a,E.l,D.a,E.v,O.a,x.t,E.P,L.H,L.s,L.t,x.s,w.a,E.I,E.O,C.a,E.s,E.d,L.r,L.u,L.c,V.a],pipes:[R.d],styles:[\"[_nghost-%COMP%]     core-timer{display:block}[_nghost-%COMP%]     core-timer .core-timer.core-timer-under-300{background-color:var(--danger-tint);color:var(--danger-shade)}[_nghost-%COMP%]     core-timer .core-timer.core-timer-under-900{background-color:var(--warning-tint);color:var(--warning-shade)}\"]}),AddonModAssignEditPage})();var j=e(\"ghUQ\"),F=e(\"FltD\"),z=e(\"4JiN\");let U=(()=>{class AddonModAssignIndexPage extends j.a{}return AddonModAssignIndexPage.ɵfac=function AddonModAssignIndexPage_Factory(i){return Q(i||AddonModAssignIndexPage)},AddonModAssignIndexPage.ɵcmp=P.sc({type:AddonModAssignIndexPage,selectors:[[\"page-addon-mod-assign-index\"]],viewQuery:function AddonModAssignIndexPage_Query(i,s){var e;(1&i&&P.ud(F.a,!0),2&i)&&(P.dd(e=P.Nc())&&(s.activityComponent=e.first))},features:[P.ic],decls:14,vars:12,consts:[[\"collapsible\",\"\"],[\"slot\",\"start\"],[3,\"text\"],[\"contextLevel\",\"module\",3,\"text\",\"contextInstanceId\",\"courseId\"],[\"slot\",\"end\"],[1,\"limited-width\"],[\"slot\",\"fixed\",3,\"disabled\",\"ionRefresh\"],[3,\"pullingText\"],[3,\"module\",\"courseId\",\"dataRetrieved\"]],template:function AddonModAssignIndexPage_Template(i,s){1&i&&(P.Ec(0,\"ion-header\",0),P.Ec(1,\"ion-toolbar\"),P.Ec(2,\"ion-buttons\",1),P.zc(3,\"ion-back-button\",2),P.Pc(4,\"translate\"),P.Dc(),P.Ec(5,\"ion-title\"),P.Ec(6,\"h1\"),P.zc(7,\"core-format-text\",3),P.Dc(),P.Dc(),P.zc(8,\"ion-buttons\",4),P.Dc(),P.Dc(),P.Ec(9,\"ion-content\",5),P.Ec(10,\"ion-refresher\",6),P.Mc(\"ionRefresh\",(function AddonModAssignIndexPage_Template_ion_refresher_ionRefresh_10_listener(i){return null==s.activityComponent?null:s.activityComponent.doRefresh(i.target)})),P.zc(11,\"ion-refresher-content\",7),P.Pc(12,\"translate\"),P.Dc(),P.Ec(13,\"addon-mod-assign-index\",8),P.Mc(\"dataRetrieved\",(function AddonModAssignIndexPage_Template_addon_mod_assign_index_dataRetrieved_13_listener(i){return s.updateData(i)})),P.Dc(),P.Dc()),2&i&&(P.lc(3),P.Vc(\"text\",P.Qc(4,8,\"core.back\")),P.lc(4),P.Vc(\"text\",s.title)(\"contextInstanceId\",null==s.module?null:s.module.id)(\"courseId\",s.courseId),P.lc(3),P.Vc(\"disabled\",null==s.activityComponent?null:s.activityComponent.showLoading),P.lc(1),P.Wc(\"pullingText\",P.Qc(12,10,\"core.pulltorefresh\")),P.lc(2),P.Vc(\"module\",s.module)(\"courseId\",s.courseId))},directives:[E.C,z.b,E.Ab,E.m,E.h,E.i,E.yb,y.a,D.a,E.v,E.bb,E.cb,F.a],pipes:[R.d],encapsulation:2}),AddonModAssignIndexPage})();const Q=P.Gc(U);var G=e(\"EoRH\"),B=e(\"baaQ\"),q=e(\"46ml\"),$=e(\"PI6X\"),W=e(\"FeAf\"),Y=e(\"r8G5\");function AddonModAssignSubmissionListPage_ion_item_16_ng_container_2_Template(i,s){1&i&&(P.Cc(0),P.pd(1),P.Pc(2,\"translate\"),P.Bc()),2&i&&(P.lc(1),P.qd(P.Qc(2,1,\"core.groupsseparate\")))}function AddonModAssignSubmissionListPage_ion_item_16_ng_container_3_Template(i,s){1&i&&(P.Cc(0),P.pd(1),P.Pc(2,\"translate\"),P.Bc()),2&i&&(P.lc(1),P.qd(P.Qc(2,1,\"core.groupsvisible\")))}function AddonModAssignSubmissionListPage_ion_item_16_ion_select_option_6_Template(i,s){if(1&i&&(P.Ec(0,\"ion-select-option\",15),P.pd(1),P.Dc()),2&i){const i=s.$implicit;P.Vc(\"value\",i.id),P.lc(1),P.rd(\" \",i.name,\" \")}}const submission_list_page_c0=function(i){return{header:i}};function AddonModAssignSubmissionListPage_ion_item_16_Template(i,s){if(1&i){const i=P.Fc();P.Ec(0,\"ion-item\",10),P.Ec(1,\"ion-label\",11),P.nd(2,AddonModAssignSubmissionListPage_ion_item_16_ng_container_2_Template,3,3,\"ng-container\",12),P.nd(3,AddonModAssignSubmissionListPage_ion_item_16_ng_container_3_Template,3,3,\"ng-container\",12),P.Dc(),P.Ec(4,\"ion-select\",13),P.Mc(\"ngModelChange\",(function AddonModAssignSubmissionListPage_ion_item_16_Template_ion_select_ngModelChange_4_listener(s){P.fd(i);return P.Oc().groupId=s}))(\"ionChange\",(function AddonModAssignSubmissionListPage_ion_item_16_Template_ion_select_ionChange_4_listener(){P.fd(i);return P.Oc().reloadSubmissions()})),P.Pc(5,\"translate\"),P.nd(6,AddonModAssignSubmissionListPage_ion_item_16_ion_select_option_6_Template,2,2,\"ion-select-option\",14),P.Dc(),P.Dc()}if(2&i){const i=P.Oc();P.lc(2),P.Vc(\"ngIf\",i.groupInfo.separateGroups),P.lc(1),P.Vc(\"ngIf\",i.groupInfo.visibleGroups),P.lc(1),P.Vc(\"ngModel\",i.groupId)(\"interfaceOptions\",P.ad(7,submission_list_page_c0,P.Qc(5,5,\"core.group\"))),P.lc(2),P.Vc(\"ngForOf\",i.groupInfo.groups)}}function AddonModAssignSubmissionListPage_ng_container_17_p_4_Template(i,s){if(1&i&&(P.Ec(0,\"p\",19),P.pd(1),P.Dc()),2&i){const i=P.Oc().$implicit;P.lc(1),P.qd(i.userfullname)}}function AddonModAssignSubmissionListPage_ng_container_17_p_5_Template(i,s){if(1&i&&(P.Ec(0,\"p\",19),P.pd(1),P.Pc(2,\"translate\"),P.Dc()),2&i){const i=P.Oc().$implicit;P.lc(1),P.sd(\" \",P.Qc(2,2,\"addon.mod_assign.hiddenuser\"),\"\",i.blindid,\" \")}}function AddonModAssignSubmissionListPage_ng_container_17_p_6_span_1_Template(i,s){if(1&i&&(P.Ec(0,\"span\",22),P.pd(1),P.Dc()),2&i){const i=P.Oc(2).$implicit;P.lc(1),P.rd(\" \",i.groupname,\" \")}}function AddonModAssignSubmissionListPage_ng_container_17_p_6_span_2_Template(i,s){1&i&&(P.Ec(0,\"span\",23),P.pd(1),P.Pc(2,\"translate\"),P.Dc()),2&i&&(P.lc(1),P.rd(\" \",P.Qc(2,1,\"addon.mod_assign.noteam\"),\" \"))}function AddonModAssignSubmissionListPage_ng_container_17_p_6_span_3_Template(i,s){1&i&&(P.Ec(0,\"span\",23),P.pd(1),P.Pc(2,\"translate\"),P.Dc()),2&i&&(P.lc(1),P.rd(\" \",P.Qc(2,1,\"addon.mod_assign.multipleteams\"),\" \"))}function AddonModAssignSubmissionListPage_ng_container_17_p_6_span_4_Template(i,s){1&i&&(P.Ec(0,\"span\"),P.pd(1),P.Pc(2,\"translate\"),P.Dc()),2&i&&(P.lc(1),P.rd(\" \",P.Qc(2,1,\"addon.mod_assign.defaultteam\"),\" \"))}function AddonModAssignSubmissionListPage_ng_container_17_p_6_Template(i,s){if(1&i&&(P.Ec(0,\"p\"),P.nd(1,AddonModAssignSubmissionListPage_ng_container_17_p_6_span_1_Template,2,1,\"span\",20),P.nd(2,AddonModAssignSubmissionListPage_ng_container_17_p_6_span_2_Template,3,3,\"span\",21),P.nd(3,AddonModAssignSubmissionListPage_ng_container_17_p_6_span_3_Template,3,3,\"span\",21),P.nd(4,AddonModAssignSubmissionListPage_ng_container_17_p_6_span_4_Template,3,3,\"span\",12),P.Dc()),2&i){const i=P.Oc().$implicit,s=P.Oc();P.lc(1),P.Vc(\"ngIf\",i.groupname),P.lc(1),P.Vc(\"ngIf\",s.assign.preventsubmissionnotingroup&&!i.groupname&&i.noGroups&&!i.blindid),P.lc(1),P.Vc(\"ngIf\",s.assign.preventsubmissionnotingroup&&!i.groupname&&i.manyGroups&&!i.blindid),P.lc(1),P.Vc(\"ngIf\",!s.assign.preventsubmissionnotingroup&&!i.groupname)}}function AddonModAssignSubmissionListPage_ng_container_17_p_7_Template(i,s){if(1&i&&(P.Ec(0,\"p\"),P.Ec(1,\"ion-badge\",24),P.pd(2),P.Dc(),P.Dc()),2&i){const i=P.Oc().$implicit;P.lc(1),P.Vc(\"color\",i.statusColor),P.lc(1),P.rd(\" \",i.statusTranslated,\" \")}}function AddonModAssignSubmissionListPage_ng_container_17_p_8_Template(i,s){if(1&i&&(P.Ec(0,\"p\"),P.Ec(1,\"ion-badge\",24),P.pd(2),P.Pc(3,\"translate\"),P.Dc(),P.Dc()),2&i){const i=P.Oc().$implicit;P.lc(1),P.Vc(\"color\",i.gradingColor),P.lc(1),P.rd(\" \",P.Qc(3,2,i.gradingStatusTranslationId),\" \")}}function AddonModAssignSubmissionListPage_ng_container_17_Template(i,s){if(1&i){const i=P.Fc();P.Cc(0),P.Ec(1,\"ion-item\",16),P.Mc(\"click\",(function AddonModAssignSubmissionListPage_ng_container_17_Template_ion_item_click_1_listener(){P.fd(i);const e=s.$implicit;return P.Oc().submissions.select(e)})),P.zc(2,\"core-user-avatar\",17),P.Ec(3,\"ion-label\"),P.nd(4,AddonModAssignSubmissionListPage_ng_container_17_p_4_Template,2,1,\"p\",18),P.nd(5,AddonModAssignSubmissionListPage_ng_container_17_p_5_Template,3,4,\"p\",18),P.nd(6,AddonModAssignSubmissionListPage_ng_container_17_p_6_Template,5,4,\"p\",12),P.nd(7,AddonModAssignSubmissionListPage_ng_container_17_p_7_Template,3,2,\"p\",12),P.nd(8,AddonModAssignSubmissionListPage_ng_container_17_p_8_Template,4,4,\"p\",12),P.Dc(),P.Dc(),P.Bc()}if(2&i){const i=s.$implicit,e=P.Oc();P.lc(1),P.mc(\"aria-current\",e.submissions.getItemAriaCurrent(i)),P.lc(1),P.Vc(\"user\",i)(\"linkProfile\",!1),P.lc(2),P.Vc(\"ngIf\",i.userfullname),P.lc(1),P.Vc(\"ngIf\",!i.userfullname),P.lc(1),P.Vc(\"ngIf\",e.assign&&e.assign.teamsubmission),P.lc(1),P.Vc(\"ngIf\",i.statusTranslated),P.lc(1),P.Vc(\"ngIf\",i.gradingStatusTranslationId)}}function AddonModAssignSubmissionListPage_core_empty_box_18_Template(i,s){1&i&&(P.zc(0,\"core-empty-box\",25),P.Pc(1,\"translate\")),2&i&&P.Vc(\"message\",P.Qc(1,1,\"addon.mod_assign.submissionstatus_\"))}let H=(()=>{class AddonModAssignSubmissionListPage{constructor(){this.title=\"\",this.gradedObserver=f.b.on(A.d.GRADED_EVENT,(i=>{var s;this.submissions.loaded&&this.submissions.getSource().assign&&i.assignmentId==(null===(s=this.submissions.getSource().assign)||void 0===s?void 0:s.id)&&i.userId==g.b.getCurrentSiteUserId()&&this.refreshAllData(!0)}),g.b.getCurrentSiteId());this.syncObserver=f.b.onMultiple([S.b.AUTO_SYNCED,S.b.MANUAL_SYNCED],(i=>{!this.submissions.loaded||\"context\"in i&&\"submission-list\"==i.context||this.refreshAllData(!1)}),g.b.getCurrentSiteId());try{const i=m.a.getRequiredRouteNumberParam(\"cmId\"),s=m.a.getRequiredRouteNumberParam(\"courseId\"),e=m.a.getRouteNumberParam(\"groupId\")||0,t=m.a.getRouteParam(\"status\"),n=B.a.getOrCreateSource($.b,[s,i,t]);n.groupId=e,this.sourceUnsubscribe=n.addListener({onItemsUpdated:()=>{var i;this.title=(null===(i=this.submissions.getSource().assign)||void 0===i?void 0:i.name)||this.title}}),this.submissions=new G.a(n,AddonModAssignSubmissionListPage)}catch(i){return h.a.showErrorModal(i),m.a.back(),void 0}}get assign(){return this.submissions.getSource().assign}get groupInfo(){return this.submissions.getSource().groupInfo}get moduleId(){return this.submissions.getSource().MODULE_ID}get courseId(){return this.submissions.getSource().COURSE_ID}get groupId(){return this.submissions.getSource().groupId}set groupId(i){this.submissions.getSource().groupId=i}ngAfterViewInit(){const i=this.submissions.getSource().SELECTED_STATUS;this.title=p.M.instant(i?i===$.a.NEED_GRADING?\"addon.mod_assign.numberofsubmissionsneedgrading\":`addon.mod_assign.submissionstatus_${i}`:\"addon.mod_assign.numberofparticipants\"),this.fetchAssignment(!0).finally((()=>{this.submissions.start(this.splitView)}))}fetchAssignment(i=!1){return Object(r.a)(this,void 0,void 0,(function*(){try{yield this.submissions.getSource().loadAssignment(i)}catch(i){h.a.showErrorModalDefault(i,\"Error getting assigment data.\")}}))}refreshAllData(i){return Object(r.a)(this,void 0,void 0,(function*(){try{yield this.submissions.getSource().invalidateCache()}finally{this.fetchAssignment(i)}}))}refreshList(i){this.refreshAllData(!0).finally((()=>{null==i?void 0:i.complete()}))}reloadSubmissions(){return Object(r.a)(this,void 0,void 0,(function*(){yield this.submissions.reload()}))}ngOnDestroy(){var i,s;null===(i=this.gradedObserver)||void 0===i?void 0:i.off(),null===(s=this.syncObserver)||void 0===s||s.off(),this.submissions.destroy(),this.sourceUnsubscribe&&this.sourceUnsubscribe()}}return AddonModAssignSubmissionListPage.ɵfac=function AddonModAssignSubmissionListPage_Factory(i){return new(i||AddonModAssignSubmissionListPage)},AddonModAssignSubmissionListPage.ɵcmp=P.sc({type:AddonModAssignSubmissionListPage,selectors:[[\"page-addon-mod-assign-submission-list\"]],viewQuery:function AddonModAssignSubmissionListPage_Query(i,s){var e;(1&i&&P.ud(q.a,!0),2&i)&&(P.dd(e=P.Nc())&&(s.splitView=e.first))},decls:19,vars:14,consts:[[\"slot\",\"start\"],[3,\"text\"],[\"contextLevel\",\"module\",3,\"text\",\"contextInstanceId\",\"courseId\"],[\"slot\",\"end\"],[\"slot\",\"fixed\",3,\"disabled\",\"ionRefresh\"],[3,\"pullingText\"],[3,\"hideUntil\"],[\"class\",\"ion-text-wrap core-group-selector\",4,\"ngIf\"],[4,\"ngFor\",\"ngForOf\"],[\"icon\",\"fas-file-signature\",3,\"message\",4,\"ngIf\"],[1,\"ion-text-wrap\",\"core-group-selector\"],[\"id\",\"addon-assign-groupslabel-list\"],[4,\"ngIf\"],[\"aria-labelledby\",\"addon-assign-groupslabel-list\",\"interface\",\"action-sheet\",\"slot\",\"end\",3,\"ngModel\",\"interfaceOptions\",\"ngModelChange\",\"ionChange\"],[3,\"value\",4,\"ngFor\",\"ngForOf\"],[3,\"value\"],[\"button\",\"\",\"detail\",\"true\",1,\"ion-text-wrap\",3,\"click\"],[\"slot\",\"start\",3,\"user\",\"linkProfile\"],[\"class\",\"item-heading\",4,\"ngIf\"],[1,\"item-heading\"],[\"class\",\"core-groupname\",4,\"ngIf\"],[\"class\",\"text-danger\",4,\"ngIf\"],[1,\"core-groupname\"],[1,\"text-danger\"],[1,\"ion-text-center\",\"ion-text-wrap\",3,\"color\"],[\"icon\",\"fas-file-signature\",3,\"message\"]],template:function AddonModAssignSubmissionListPage_Template(i,s){1&i&&(P.Ec(0,\"ion-header\"),P.Ec(1,\"ion-toolbar\"),P.Ec(2,\"ion-buttons\",0),P.zc(3,\"ion-back-button\",1),P.Pc(4,\"translate\"),P.Dc(),P.Ec(5,\"ion-title\"),P.Ec(6,\"h1\"),P.zc(7,\"core-format-text\",2),P.Dc(),P.Dc(),P.zc(8,\"ion-buttons\",3),P.Dc(),P.Dc(),P.Ec(9,\"ion-content\"),P.Ec(10,\"core-split-view\"),P.Ec(11,\"ion-refresher\",4),P.Mc(\"ionRefresh\",(function AddonModAssignSubmissionListPage_Template_ion_refresher_ionRefresh_11_listener(i){return s.refreshList(i.target)})),P.zc(12,\"ion-refresher-content\",5),P.Pc(13,\"translate\"),P.Dc(),P.Ec(14,\"core-loading\",6),P.Ec(15,\"ion-list\"),P.nd(16,AddonModAssignSubmissionListPage_ion_item_16_Template,7,9,\"ion-item\",7),P.nd(17,AddonModAssignSubmissionListPage_ng_container_17_Template,9,8,\"ng-container\",8),P.Dc(),P.nd(18,AddonModAssignSubmissionListPage_core_empty_box_18_Template,2,3,\"core-empty-box\",9),P.Dc(),P.Dc(),P.Dc()),2&i&&(P.lc(3),P.Vc(\"text\",P.Qc(4,10,\"core.back\")),P.lc(4),P.Vc(\"text\",s.title)(\"contextInstanceId\",s.moduleId)(\"courseId\",s.courseId),P.lc(4),P.Vc(\"disabled\",!s.submissions.loaded),P.lc(1),P.Wc(\"pullingText\",P.Qc(13,12,\"core.pulltorefresh\")),P.lc(2),P.Vc(\"hideUntil\",s.submissions.loaded),P.lc(2),P.Vc(\"ngIf\",s.groupInfo.separateGroups||s.groupInfo.visibleGroups),P.lc(1),P.Vc(\"ngForOf\",s.submissions.items),P.lc(1),P.Vc(\"ngIf\",!s.submissions||s.submissions.empty))},directives:[E.C,E.Ab,E.m,E.h,E.i,E.yb,y.a,D.a,E.v,q.a,E.bb,E.cb,O.a,E.P,x.t,x.s,E.I,E.O,E.lb,E.Ob,L.r,L.u,E.mb,W.a,E.k,Y.a],pipes:[R.d],encapsulation:2}),AddonModAssignSubmissionListPage})();var J=e(\"eoiU\"),X=e(\"ULAo\"),Z=e(\"q/1B\"),K=e(\"ACV2\"),ii=e(\"OZH1\");function AddonModAssignSubmissionReviewPage_addon_mod_assign_submission_18_Template(i,s){if(1&i&&P.zc(0,\"addon-mod-assign-submission\",10),2&i){const i=P.Oc();P.Vc(\"courseId\",i.courseId)(\"moduleId\",i.moduleId)(\"submitId\",i.submitId)(\"blindId\",i.blindId)}}let si=(()=>{class AddonModAssignSubmissionReviewPage{constructor(i){this.route=i,this.title=\"\",this.loaded=!1,this.canSaveGrades=!1,this.blindMarking=!1,this.forceLeave=!1}ngOnInit(){this.route.queryParams.subscribe((i=>{var s;try{this.moduleId=m.a.getRequiredRouteNumberParam(\"cmId\"),this.courseId=m.a.getRequiredRouteNumberParam(\"courseId\"),this.submitId=m.a.getRouteNumberParam(\"submitId\")||0,this.blindId=m.a.getRouteNumberParam(\"blindId\",{params:i});const e=m.a.getRequiredRouteNumberParam(\"groupId\"),t=m.a.getRouteParam(\"selectedStatus\"),n=B.a.getOrCreateSource($.b,[this.courseId,this.moduleId,t]);null===(s=this.submissions)||void 0===s?void 0:s.destroy(),n.groupId=e,this.submissions=new submission_review_AddonModAssignSubmissionSwipeItemsManager(n),this.submissions.start()}catch(i){return h.a.showErrorModal(i),m.a.back(),void 0}this.fetchSubmission().finally((()=>{this.loaded=!0}))}))}ngOnDestroy(){var i;null===(i=this.submissions)||void 0===i?void 0:i.destroy()}canLeave(){return Object(r.a)(this,void 0,void 0,(function*(){return!(this.submissionComponent&&!this.forceLeave)||this.submissionComponent.canLeave()}))}ionViewDidEnter(){var i;null===(i=this.submissionComponent)||void 0===i?void 0:i.ionViewDidEnter()}ionViewDidLeave(){var i;null===(i=this.submissionComponent)||void 0===i?void 0:i.ionViewDidLeave()}fetchSubmission(){return Object(r.a)(this,void 0,void 0,(function*(){this.assign=yield A.a.getAssignment(this.courseId,this.moduleId),this.title=this.assign.name,this.blindMarking=!!this.assign.blindmarking&&!this.assign.revealidentities;const i=yield X.a.getModuleBasicGradeInfo(this.moduleId);if(i)if(i.advancedgrading&&i.advancedgrading[0]&&void 0!==i.advancedgrading[0].method){this.canSaveGrades=\"simple\"==(i.advancedgrading[0].method||\"simple\")}else this.canSaveGrades=!0}))}refreshAllData(){return Object(r.a)(this,void 0,void 0,(function*(){const i=[];i.push(A.a.invalidateAssignmentData(this.courseId)),this.assign&&(i.push(A.a.invalidateSubmissionData(this.assign.id)),i.push(A.a.invalidateAssignmentUserMappingsData(this.assign.id)),i.push(A.a.invalidateSubmissionStatusData(this.assign.id,this.submitId,void 0,this.blindMarking)));try{yield Promise.all(i)}finally{this.submissionComponent&&this.submissionComponent.invalidateAndRefresh(!0),yield this.fetchSubmission()}}))}refreshSubmission(i){this.refreshAllData().finally((()=>{null==i?void 0:i.complete()}))}submitGrade(){return Object(r.a)(this,void 0,void 0,(function*(){if(this.submissionComponent)try{yield this.submissionComponent.submitGrade(),d.a.isTablet||(this.forceLeave=!0,m.a.back())}catch(i){h.a.showErrorModalDefault(i,\"core.error\",!0)}}))}}return AddonModAssignSubmissionReviewPage.ɵfac=function AddonModAssignSubmissionReviewPage_Factory(i){return new(i||AddonModAssignSubmissionReviewPage)(P.yc(o.a))},AddonModAssignSubmissionReviewPage.ɵcmp=P.sc({type:AddonModAssignSubmissionReviewPage,selectors:[[\"page-addon-mod-assign-submission-review\"]],viewQuery:function AddonModAssignSubmissionReviewPage_Query(i,s){var e;(1&i&&P.ud(Z.a,!0),2&i)&&(P.dd(e=P.Nc())&&(s.submissionComponent=e.first))},decls:19,vars:17,consts:[[\"slot\",\"start\"],[3,\"text\"],[\"contextLevel\",\"module\",3,\"text\",\"contextInstanceId\",\"courseId\"],[\"slot\",\"end\"],[\"fill\",\"clear\",3,\"hidden\",\"click\"],[3,\"core-swipe-navigation\"],[\"slot\",\"fixed\",3,\"disabled\",\"ionRefresh\"],[3,\"pullingText\"],[3,\"hideUntil\"],[3,\"courseId\",\"moduleId\",\"submitId\",\"blindId\",4,\"ngIf\"],[3,\"courseId\",\"moduleId\",\"submitId\",\"blindId\"]],template:function AddonModAssignSubmissionReviewPage_Template(i,s){1&i&&(P.Ec(0,\"ion-header\"),P.Ec(1,\"ion-toolbar\"),P.Ec(2,\"ion-buttons\",0),P.zc(3,\"ion-back-button\",1),P.Pc(4,\"translate\"),P.Dc(),P.Ec(5,\"ion-title\"),P.Ec(6,\"h1\"),P.zc(7,\"core-format-text\",2),P.Dc(),P.Dc(),P.zc(8,\"ion-buttons\",3),P.Dc(),P.Ec(9,\"core-navbar-buttons\",3),P.Ec(10,\"ion-button\",4),P.Mc(\"click\",(function AddonModAssignSubmissionReviewPage_Template_ion_button_click_10_listener(){return s.submitGrade()})),P.pd(11),P.Pc(12,\"translate\"),P.Dc(),P.Dc(),P.Dc(),P.Ec(13,\"ion-content\",5),P.Ec(14,\"ion-refresher\",6),P.Mc(\"ionRefresh\",(function AddonModAssignSubmissionReviewPage_Template_ion_refresher_ionRefresh_14_listener(i){return s.refreshSubmission(i.target)})),P.zc(15,\"ion-refresher-content\",7),P.Pc(16,\"translate\"),P.Dc(),P.Ec(17,\"core-loading\",8),P.nd(18,AddonModAssignSubmissionReviewPage_addon_mod_assign_submission_18_Template,1,4,\"addon-mod-assign-submission\",9),P.Dc(),P.Dc()),2&i&&(P.lc(3),P.Vc(\"text\",P.Qc(4,11,\"core.back\")),P.lc(4),P.Vc(\"text\",s.title)(\"contextInstanceId\",s.moduleId)(\"courseId\",s.courseId),P.lc(3),P.Vc(\"hidden\",!s.canSaveGrades),P.lc(1),P.rd(\" \",P.Qc(12,13,\"core.done\"),\" \"),P.lc(2),P.Vc(\"core-swipe-navigation\",s.submissions),P.lc(1),P.Vc(\"disabled\",!s.loaded),P.lc(1),P.Wc(\"pullingText\",P.Qc(16,15,\"core.pulltorefresh\")),P.lc(2),P.Vc(\"hideUntil\",s.loaded),P.lc(1),P.Vc(\"ngIf\",s.loaded))},directives:[E.C,E.Ab,E.m,E.h,E.i,E.yb,y.a,K.a,T.a,E.l,D.a,E.v,ii.a,E.bb,E.cb,O.a,x.t,Z.a],pipes:[R.d],encapsulation:2}),AddonModAssignSubmissionReviewPage})();class submission_review_AddonModAssignSubmissionSwipeItemsManager extends J.a{getSelectedItemPathFromRoute(i){return i.params.submitId}}const ei=[{path:\":courseId/:cmId\",component:U},{path:\":courseId/:cmId/edit\",component:N,canDeactivate:[a.a]}],ti=[...ei,{path:\":courseId/:cmId/submission\",component:H},{path:\":courseId/:cmId/submission/:submitId\",component:si,canDeactivate:[a.a]}],ni=[...ei,{path:\":courseId/:cmId/submission\",component:H,children:[{path:\":submitId\",component:si,canDeactivate:[a.a]}]}],oi=[...Object(t.c)(ti,(()=>d.a.isMobile)),...Object(t.c)(ni,(()=>d.a.isTablet))];let ai=(()=>{class AddonModAssignLazyModule{}return AddonModAssignLazyModule.ɵmod=P.wc({type:AddonModAssignLazyModule}),AddonModAssignLazyModule.ɵinj=P.vc({factory:function AddonModAssignLazyModule_Factory(i){return new(i||AddonModAssignLazyModule)},imports:[[o.m.forChild(oi),n.a,c.a]]}),AddonModAssignLazyModule})();void((\"undefined\"==typeof ngJitMode||ngJitMode)&&P.kd(ai,{declarations:[U,H,si,N],imports:[o.m,n.a,c.a]}))},eoiU:function(i,s,e){\"use strict\";e.d(s,\"a\",(function(){return CoreSwipeNavigationItemsManager}));var t=e(\"mrSG\"),n=e(\"pHTc\"),o=e(\"CtbY\");class CoreSwipeNavigationItemsManager extends o.a{start(){return Object(t.a)(this,void 0,void 0,(function*(){this.updateSelectedItem()}))}navigateToNextItem(){return Object(t.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(1,\"forward\")}))}navigateToPreviousItem(){return Object(t.a)(this,void 0,void 0,(function*(){yield this.navigateToItemBy(-1,\"back\")}))}hasNextItem(){return Object(t.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(1))}))}hasPreviousItem(){return Object(t.a)(this,void 0,void 0,(function*(){return!!(yield this.getItemBy(-1))}))}getCurrentPageRoute(){return n.a.getCurrentRoute()}getSelectedItemPathFromRoute(i){const s=[];for(;i&&(s.push(...i.url),i.firstChild);)i=i.firstChild;return s.map((i=>i.path)).join(\"/\").replace(/\\/+/,\"/\").trim()||null}navigateToItemBy(i,s){return Object(t.a)(this,void 0,void 0,(function*(){const e=yield this.getItemBy(i);e&&(yield this.navigateToItem(e,{animationDirection:s,replace:!0}))}))}getItemBy(i){var s;return Object(t.a)(this,void 0,void 0,(function*(){const e=this.getSource().getItems(),t=null!==(s=this.selectedItem&&(null==e?void 0:e.indexOf(this.selectedItem)))&&void 0!==s?s:-1;if(-1===t||null===e)return null;const n=i>0?1:-1;let o=t,a=0;for(;a!==i&&(o+=n,!(o<0||o>=e.length));)this.skipItemInSwipe(e[o])||(a+=n);return a===i?e[o]:this.getSource().isCompleted()?null:(yield this.getSource().load(),this.getItemBy(i))}))}skipItemInSwipe(i){return!1}}}}]);","name":"31.07ac94f0e358867130dc.js","input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[31],{\n\n/***/ \"M7Gs\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"AddonModAssignLazyModule\", function() { return /* binding */ assign_lazy_module_AddonModAssignLazyModule; });\n\n// EXTERNAL MODULE: ./src/app/app-routing.module.ts\nvar app_routing_module = __webpack_require__(\"vY5A\");\n\n// EXTERNAL MODULE: ./src/core/shared.module.ts + 3 modules\nvar shared_module = __webpack_require__(\"L3Fv\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/router/__ivy_ngcc__/fesm2015/router.js + 14 modules\nvar router = __webpack_require__(\"tyNb\");\n\n// EXTERNAL MODULE: ./src/core/guards/can-leave.ts\nvar can_leave = __webpack_require__(\"MLi9\");\n\n// EXTERNAL MODULE: ./src/core/services/screen.ts\nvar screen = __webpack_require__(\"Y+03\");\n\n// EXTERNAL MODULE: ./src/addons/mod/assign/components/components.module.ts + 1 modules\nvar components_module = __webpack_require__(\"sYk5\");\n\n// EXTERNAL MODULE: ./node_modules/tslib/tslib.es6.js\nvar tslib_es6 = __webpack_require__(\"mrSG\");\n\n// EXTERNAL MODULE: ./src/core/classes/errors/error.ts\nvar errors_error = __webpack_require__(\"93ts\");\n\n// EXTERNAL MODULE: ./src/core/features/fileuploader/services/fileuploader-helper.ts\nvar fileuploader_helper = __webpack_require__(\"2tv+\");\n\n// EXTERNAL MODULE: ./src/core/services/navigator.ts\nvar services_navigator = __webpack_require__(\"pHTc\");\n\n// EXTERNAL MODULE: ./src/core/services/sites.ts\nvar sites = __webpack_require__(\"9+EE\");\n\n// EXTERNAL MODULE: ./src/core/services/sync.ts\nvar services_sync = __webpack_require__(\"uT8i\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/dom.ts + 2 modules\nvar dom = __webpack_require__(\"3LXp\");\n\n// EXTERNAL MODULE: ./src/core/singletons/form.ts\nvar singletons_form = __webpack_require__(\"4reR\");\n\n// EXTERNAL MODULE: ./src/core/singletons/index.ts\nvar singletons = __webpack_require__(\"j3ag\");\n\n// EXTERNAL MODULE: ./src/core/singletons/events.ts\nvar singletons_events = __webpack_require__(\"fjkH\");\n\n// EXTERNAL MODULE: ./src/addons/mod/assign/services/assign.ts\nvar services_assign = __webpack_require__(\"djuo\");\n\n// EXTERNAL MODULE: ./src/addons/mod/assign/services/assign-helper.ts\nvar assign_helper = __webpack_require__(\"JDIg\");\n\n// EXTERNAL MODULE: ./src/addons/mod/assign/services/assign-offline.ts\nvar assign_offline = __webpack_require__(\"W4Cf\");\n\n// EXTERNAL MODULE: ./src/addons/mod/assign/services/assign-sync.ts\nvar assign_sync = __webpack_require__(\"jQ6G\");\n\n// EXTERNAL MODULE: ./src/core/services/utils/utils.ts\nvar utils = __webpack_require__(\"bFG1\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/core/__ivy_ngcc__/fesm2015/core.js + 4 modules\nvar core = __webpack_require__(\"fXoL\");\n\n// EXTERNAL MODULE: ./node_modules/@ionic/angular/__ivy_ngcc__/fesm2015/ionic-angular.js + 5 modules\nvar ionic_angular = __webpack_require__(\"TEn/\");\n\n// EXTERNAL MODULE: ./src/core/directives/format-text.ts\nvar format_text = __webpack_require__(\"hMzs\");\n\n// EXTERNAL MODULE: ./src/core/directives/update-non-reactive-attributes.ts\nvar update_non_reactive_attributes = __webpack_require__(\"ACYt\");\n\n// EXTERNAL MODULE: ./src/core/directives/content.ts\nvar content = __webpack_require__(\"nt/U\");\n\n// EXTERNAL MODULE: ./src/core/components/loading/loading.ts\nvar loading = __webpack_require__(\"PgjG\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/common/__ivy_ngcc__/fesm2015/common.js\nvar common = __webpack_require__(\"ofXK\");\n\n// EXTERNAL MODULE: ./node_modules/@angular/forms/__ivy_ngcc__/fesm2015/forms.js\nvar fesm2015_forms = __webpack_require__(\"3Pt+\");\n\n// EXTERNAL MODULE: ./src/core/components/timer/timer.ts\nvar timer = __webpack_require__(\"rztj\");\n\n// EXTERNAL MODULE: ./src/core/components/file/file.ts\nvar file = __webpack_require__(\"5450\");\n\n// EXTERNAL MODULE: ./src/addons/mod/assign/components/submission-plugin/submission-plugin.ts\nvar submission_plugin = __webpack_require__(\"akXa\");\n\n// EXTERNAL MODULE: ./node_modules/@ngx-translate/core/__ivy_ngcc__/fesm2015/ngx-translate-core.js + 8 modules\nvar ngx_translate_core = __webpack_require__(\"sYmb\");\n\n// CONCATENATED MODULE: ./src/addons/mod/assign/pages/edit/edit.ts\n\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst _c0 = [\"editSubmissionForm\"];\nconst _c1 = function () { return [300, 900]; };\nfunction AddonModAssignEditPage_ion_list_14_core_timer_1_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r8 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"core-timer\", 12);\n        core[\"Mc\" /* ɵɵlistener */](\"finished\", function AddonModAssignEditPage_ion_list_14_core_timer_1_Template_core_timer_finished_0_listener() { core[\"fd\" /* ɵɵrestoreView */](_r8); const ctx_r7 = core[\"Oc\" /* ɵɵnextContext */](2); return ctx_r7.timeUp(); });\n        core[\"Pc\" /* ɵɵpipe */](1, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r1 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"endTime\", ctx_r1.timeLimitEndTime)(\"timerText\", core[\"Qc\" /* ɵɵpipeBind1 */](1, 5, \"addon.mod_assign.assigntimeleft\"))(\"align\", \"center\")(\"timeLeftClassThreshold\", 0 - 1)(\"underTimeClassThresholds\", core[\"Zc\" /* ɵɵpureFunction0 */](7, _c1));\n    }\n}\nfunction AddonModAssignEditPage_ion_list_14_ion_item_2_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\", 13);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-label\");\n        core[\"zc\" /* ɵɵelement */](2, \"core-format-text\", 14);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r2 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"text\", ctx_r2.activityInstructions)(\"component\", ctx_r2.component)(\"componentId\", ctx_r2.moduleId)(\"contextInstanceId\", ctx_r2.moduleId)(\"courseId\", ctx_r2.courseId)(\"maxHeight\", 120);\n    }\n}\nfunction AddonModAssignEditPage_ion_list_14_ng_container_3_core_file_1_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"core-file\", 16);\n    }\n    if (rf & 2) {\n        const file_r10 = ctx.$implicit;\n        const ctx_r9 = core[\"Oc\" /* ɵɵnextContext */](3);\n        core[\"Vc\" /* ɵɵproperty */](\"file\", file_r10)(\"component\", ctx_r9.component)(\"componentId\", ctx_r9.moduleId);\n    }\n}\nfunction AddonModAssignEditPage_ion_list_14_ng_container_3_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"nd\" /* ɵɵtemplate */](1, AddonModAssignEditPage_ion_list_14_ng_container_3_core_file_1_Template, 1, 3, \"core-file\", 15);\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r3 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", ctx_r3.introAttachments);\n    }\n}\nfunction AddonModAssignEditPage_ion_list_14_ion_item_6_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r12 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\", 13);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-label\");\n        core[\"zc\" /* ɵɵelement */](2, \"core-format-text\", 17);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](3, \"ion-checkbox\", 18);\n        core[\"Mc\" /* ɵɵlistener */](\"ngModelChange\", function AddonModAssignEditPage_ion_list_14_ion_item_6_Template_ion_checkbox_ngModelChange_3_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r12); const ctx_r11 = core[\"Oc\" /* ɵɵnextContext */](2); return ctx_r11.submissionStatementAccepted = $event; });\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"zc\" /* ɵɵelement */](4, \"input\", 19);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r5 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"text\", ctx_r5.submissionStatement)(\"filter\", false);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngModel\", ctx_r5.submissionStatementAccepted);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngModel\", ctx_r5.submissionStatementAccepted);\n    }\n}\nfunction AddonModAssignEditPage_ion_list_14_addon_mod_assign_submission_plugin_7_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"addon-mod-assign-submission-plugin\", 20);\n    }\n    if (rf & 2) {\n        const plugin_r13 = ctx.$implicit;\n        const ctx_r6 = core[\"Oc\" /* ɵɵnextContext */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"assign\", ctx_r6.assign)(\"submission\", ctx_r6.userSubmission)(\"plugin\", plugin_r13)(\"edit\", true)(\"allowOffline\", ctx_r6.allowOffline);\n    }\n}\nfunction AddonModAssignEditPage_ion_list_14_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-list\");\n        core[\"nd\" /* ɵɵtemplate */](1, AddonModAssignEditPage_ion_list_14_core_timer_1_Template, 2, 8, \"core-timer\", 7);\n        core[\"nd\" /* ɵɵtemplate */](2, AddonModAssignEditPage_ion_list_14_ion_item_2_Template, 3, 6, \"ion-item\", 8);\n        core[\"nd\" /* ɵɵtemplate */](3, AddonModAssignEditPage_ion_list_14_ng_container_3_Template, 2, 1, \"ng-container\", 6);\n        core[\"Ec\" /* ɵɵelementStart */](4, \"form\", 9, 10);\n        core[\"nd\" /* ɵɵtemplate */](6, AddonModAssignEditPage_ion_list_14_ion_item_6_Template, 5, 4, \"ion-item\", 8);\n        core[\"nd\" /* ɵɵtemplate */](7, AddonModAssignEditPage_ion_list_14_addon_mod_assign_submission_plugin_7_Template, 1, 5, \"addon-mod-assign-submission-plugin\", 11);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r0 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r0.timeLimitEndTime > 0);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r0.activityInstructions);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r0.assign == null ? null : ctx_r0.assign.submissionattachments);\n        core[\"lc\" /* ɵɵadvance */](3);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r0.submissionStatement);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", ctx_r0.userSubmission.plugins);\n    }\n}\n/**\n * Page that allows adding or editing an assigment submission.\n */\nlet edit_AddonModAssignEditPage = /*@__PURE__*/ (() => {\n    class AddonModAssignEditPage {\n        constructor(route) {\n            this.route = route;\n            this.allowOffline = false; // Whether offline is allowed.\n            this.submissionStatementAccepted = false; // Whether submission statement is accepted.\n            this.loaded = false; // Whether data has been loaded.\n            this.timeLimitEndTime = 0; // If time limit is enabled, the end time for the timer.\n            this.component = services_assign[\"d\" /* AddonModAssignProvider */].COMPONENT;\n            this.isBlind = false; // Whether blind is used.\n            this.saveOffline = false; // Whether to save data in offline.\n            this.hasOffline = false; // Whether the assignment has offline data.\n            this.isDestroyed = false; // Whether the component has been destroyed.\n            this.forceLeave = false; // To allow leaving the page without checking for changes.\n            this.userId = sites[\"b\" /* CoreSites */].getCurrentSiteUserId(); // Right now we can only edit current user's submissions.\n            this.editText = singletons[\"M\" /* Translate */].instant('addon.mod_assign.editsubmission');\n            this.title = this.editText;\n        }\n        /**\n         * Component being initialized.\n         */\n        ngOnInit() {\n            try {\n                this.moduleId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('cmId');\n                this.courseId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('courseId');\n                this.isBlind = !!services_navigator[\"a\" /* CoreNavigator */].getRouteNumberParam('blindId');\n            }\n            catch (error) {\n                dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                services_navigator[\"a\" /* CoreNavigator */].back();\n                return;\n            }\n            this.fetchAssignment().finally(() => {\n                this.loaded = true;\n            });\n        }\n        /**\n         * Check if we can leave the page or not.\n         *\n         * @return Resolved if we can leave it, rejected if not.\n         */\n        canLeave() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                if (this.forceLeave) {\n                    return true;\n                }\n                // Check if data has changed.\n                const changed = yield this.hasDataChanged();\n                if (changed) {\n                    yield dom[\"a\" /* CoreDomUtils */].showConfirm(singletons[\"M\" /* Translate */].instant('core.confirmcanceledit'));\n                }\n                // Nothing has changed or user confirmed to leave. Clear temporary data from plugins.\n                assign_helper[\"a\" /* AddonModAssignHelper */].clearSubmissionPluginTmpData(this.assign, this.userSubmission, this.getInputData());\n                singletons_form[\"a\" /* CoreForms */].triggerFormCancelledEvent(this.formElement, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n                return true;\n            });\n        }\n        /**\n         * Fetch assignment data.\n         *\n         * @return Promise resolved when done.\n         */\n        fetchAssignment() {\n            var _a, _b, _c, _d, _e, _f, _g;\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                const currentUserId = sites[\"b\" /* CoreSites */].getCurrentSiteUserId();\n                try {\n                    // Get assignment data.\n                    this.assign = yield services_assign[\"a\" /* AddonModAssign */].getAssignment(this.courseId, this.moduleId);\n                    this.title = this.assign.name || this.title;\n                    if (!this.isDestroyed) {\n                        // Block the assignment.\n                        services_sync[\"a\" /* CoreSync */].blockOperation(services_assign[\"d\" /* AddonModAssignProvider */].COMPONENT, this.assign.id);\n                    }\n                    // Wait for sync to be over (if any).\n                    yield assign_sync[\"a\" /* AddonModAssignSync */].waitForSync(this.assign.id);\n                    // Get submission status. Ignore cache to get the latest data.\n                    const options = {\n                        userId: this.userId,\n                        isBlind: this.isBlind,\n                        cmId: this.assign.cmid,\n                        filter: false,\n                        readingStrategy: 2 /* ONLY_NETWORK */,\n                    };\n                    let submissionStatus;\n                    try {\n                        submissionStatus = yield services_assign[\"a\" /* AddonModAssign */].getSubmissionStatus(this.assign.id, options);\n                        this.userSubmission =\n                            services_assign[\"a\" /* AddonModAssign */].getSubmissionObjectFromAttempt(this.assign, submissionStatus.lastattempt);\n                    }\n                    catch (error) {\n                        // Cannot connect. Get cached data.\n                        options.filter = true;\n                        options.readingStrategy = 1 /* PREFER_CACHE */;\n                        submissionStatus = yield services_assign[\"a\" /* AddonModAssign */].getSubmissionStatus(this.assign.id, options);\n                        this.userSubmission =\n                            services_assign[\"a\" /* AddonModAssign */].getSubmissionObjectFromAttempt(this.assign, submissionStatus.lastattempt);\n                        // Check if the user can edit it in offline.\n                        const canEditOffline = yield assign_helper[\"a\" /* AddonModAssignHelper */].canEditSubmissionOffline(this.assign, this.userSubmission);\n                        if (!canEditOffline) {\n                            // Submission cannot be edited in offline, reject.\n                            this.allowOffline = false;\n                            throw error;\n                        }\n                    }\n                    if (!((_a = submissionStatus.lastattempt) === null || _a === void 0 ? void 0 : _a.canedit)) {\n                        // Can't edit. Reject.\n                        throw new errors_error[\"a\" /* CoreError */](singletons[\"M\" /* Translate */].instant('core.nopermissions', { $a: this.editText }));\n                    }\n                    submissionStatus = yield this.startSubmissionIfNeeded(submissionStatus, options);\n                    if ((_b = submissionStatus.assignmentdata) === null || _b === void 0 ? void 0 : _b.activity) {\n                        // There are activity instructions. Make sure to display it with filters applied.\n                        const filteredSubmissionStatus = options.filter ?\n                            submissionStatus :\n                            yield services_assign[\"a\" /* AddonModAssign */].getSubmissionStatus(this.assign.id, Object.assign(Object.assign({}, options), { filter: true }));\n                        this.activityInstructions = (_c = filteredSubmissionStatus.assignmentdata) === null || _c === void 0 ? void 0 : _c.activity;\n                    }\n                    this.introAttachments = (_f = (_e = (_d = submissionStatus.assignmentdata) === null || _d === void 0 ? void 0 : _d.attachments) === null || _e === void 0 ? void 0 : _e.intro) !== null && _f !== void 0 ? _f : this.assign.introattachments;\n                    this.allowOffline = true; // If offline isn't allowed we shouldn't have reached this point.\n                    // Only show submission statement if we are editing our own submission.\n                    if (this.assign.requiresubmissionstatement && !this.assign.submissiondrafts && this.userId == currentUserId) {\n                        this.submissionStatement = this.assign.submissionstatement;\n                    }\n                    else {\n                        this.submissionStatement = undefined;\n                    }\n                    if (this.assign.timelimit && ((_g = this.userSubmission) === null || _g === void 0 ? void 0 : _g.timestarted)) {\n                        this.timeLimitEndTime = assign_helper[\"a\" /* AddonModAssignHelper */].calculateEndTime(this.assign, this.userSubmission);\n                    }\n                    else {\n                        this.timeLimitEndTime = 0;\n                    }\n                    try {\n                        // Check if there's any offline data for this submission.\n                        const offlineData = yield assign_offline[\"a\" /* AddonModAssignOffline */].getSubmission(this.assign.id, this.userId);\n                        this.hasOffline = (offlineData === null || offlineData === void 0 ? void 0 : offlineData.plugindata) && Object.keys(offlineData.plugindata).length > 0;\n                    }\n                    catch (_h) {\n                        // No offline data found.\n                        this.hasOffline = false;\n                    }\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'Error getting assigment data.');\n                    // Leave the player.\n                    this.leaveWithoutCheck();\n                }\n            });\n        }\n        /**\n         * Start the submission if needed.\n         *\n         * @param submissionStatus Current submission status.\n         * @param options Options.\n         * @return Promise resolved with the new submission status if it changed, original submission status otherwise.\n         */\n        startSubmissionIfNeeded(submissionStatus, options) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                if (!this.assign || !this.assign.timelimit) {\n                    // Submission only needs to be started if there's a timelimit.\n                    return submissionStatus;\n                }\n                if (this.userSubmission && this.userSubmission.status !== services_assign[\"e\" /* AddonModAssignSubmissionStatusValues */].NEW &&\n                    this.userSubmission.status !== services_assign[\"e\" /* AddonModAssignSubmissionStatusValues */].REOPENED) {\n                    // There is an ongoing submission, no need to start it.\n                    return submissionStatus;\n                }\n                yield services_assign[\"a\" /* AddonModAssign */].startSubmission(this.assign.id);\n                singletons_events[\"b\" /* CoreEvents */].trigger(services_assign[\"d\" /* AddonModAssignProvider */].STARTED_EVENT, {\n                    assignmentId: this.assign.id,\n                }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n                // Submission started, update the submission status.\n                const newSubmissionStatus = yield services_assign[\"a\" /* AddonModAssign */].getSubmissionStatus(this.assign.id, Object.assign(Object.assign({}, options), { readingStrategy: 2 /* ONLY_NETWORK */ }));\n                this.userSubmission = services_assign[\"a\" /* AddonModAssign */].getSubmissionObjectFromAttempt(this.assign, newSubmissionStatus.lastattempt);\n                return newSubmissionStatus;\n            });\n        }\n        /**\n         * Get the input data.\n         *\n         * @return Input data.\n         */\n        getInputData() {\n            return singletons_form[\"a\" /* CoreForms */].getDataFromForm(document.forms['addon-mod_assign-edit-form']);\n        }\n        /**\n         * Check if data has changed.\n         *\n         * @return Promise resolved with boolean: whether data has changed.\n         */\n        hasDataChanged() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                // Usually the hasSubmissionDataChanged call will be resolved inmediately, causing the modal to be shown just an instant.\n                // We'll wait a bit before showing it to prevent this \"blink\".\n                const modal = yield dom[\"a\" /* CoreDomUtils */].showModalLoading();\n                const data = this.getInputData();\n                return assign_helper[\"a\" /* AddonModAssignHelper */].hasSubmissionDataChanged(this.assign, this.userSubmission, data).finally(() => {\n                    modal.dismiss();\n                });\n            });\n        }\n        /**\n         * Leave the view without checking for changes.\n         */\n        leaveWithoutCheck() {\n            this.forceLeave = true;\n            services_navigator[\"a\" /* CoreNavigator */].back();\n        }\n        /**\n         * Get data to submit based on the input data.\n         *\n         * @param inputData The input data.\n         * @return Promise resolved with the data to submit.\n         */\n        prepareSubmissionData(inputData) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                // If there's offline data, always save it in offline.\n                this.saveOffline = this.hasOffline;\n                try {\n                    return yield assign_helper[\"a\" /* AddonModAssignHelper */].prepareSubmissionPluginData(this.assign, this.userSubmission, inputData, this.hasOffline);\n                }\n                catch (error) {\n                    if (this.allowOffline && !this.saveOffline && !utils[\"a\" /* CoreUtils */].isWebServiceError(error)) {\n                        // Cannot submit in online, prepare for offline usage.\n                        this.saveOffline = true;\n                        return yield assign_helper[\"a\" /* AddonModAssignHelper */].prepareSubmissionPluginData(this.assign, this.userSubmission, inputData, true);\n                    }\n                    throw error;\n                }\n            });\n        }\n        /**\n         * Save the submission.\n         */\n        save() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                // Check if data has changed.\n                const changed = yield this.hasDataChanged();\n                if (!changed) {\n                    // Nothing to save, just go back.\n                    this.leaveWithoutCheck();\n                    return;\n                }\n                try {\n                    yield this.saveSubmission();\n                    this.leaveWithoutCheck();\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'Error saving submission.');\n                }\n            });\n        }\n        /**\n         * Save the submission.\n         *\n         * @return Promise resolved when done.\n         */\n        saveSubmission() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                const inputData = this.getInputData();\n                if (this.submissionStatement && (!inputData.submissionstatement || inputData.submissionstatement === 'false')) {\n                    throw singletons[\"M\" /* Translate */].instant('addon.mod_assign.acceptsubmissionstatement');\n                }\n                let modal = yield dom[\"a\" /* CoreDomUtils */].showModalLoading();\n                let size = -1;\n                // Get size to ask for confirmation.\n                try {\n                    size = yield assign_helper[\"a\" /* AddonModAssignHelper */].getSubmissionSizeForEdit(this.assign, this.userSubmission, inputData);\n                }\n                catch (error) {\n                    // Error calculating size, return -1.\n                    size = -1;\n                }\n                modal.dismiss();\n                try {\n                    // Confirm action.\n                    yield fileuploader_helper[\"a\" /* CoreFileUploaderHelper */].confirmUploadFile(size, true, this.allowOffline);\n                    modal = yield dom[\"a\" /* CoreDomUtils */].showModalLoading('core.sending', true);\n                    const pluginData = yield this.prepareSubmissionData(inputData);\n                    if (!Object.keys(pluginData).length) {\n                        // Nothing to save.\n                        return;\n                    }\n                    let sent;\n                    if (this.saveOffline) {\n                        // Save submission in offline.\n                        sent = false;\n                        yield assign_offline[\"a\" /* AddonModAssignOffline */].saveSubmission(this.assign.id, this.courseId, pluginData, this.userSubmission.timemodified, !this.assign.submissiondrafts, this.userId);\n                    }\n                    else {\n                        // Try to send it to server.\n                        sent = yield services_assign[\"a\" /* AddonModAssign */].saveSubmission(this.assign.id, this.courseId, pluginData, this.allowOffline, this.userSubmission.timemodified, !!this.assign.submissiondrafts, this.userId);\n                    }\n                    // Clear temporary data from plugins.\n                    assign_helper[\"a\" /* AddonModAssignHelper */].clearSubmissionPluginTmpData(this.assign, this.userSubmission, inputData);\n                    if (sent) {\n                        singletons_events[\"b\" /* CoreEvents */].trigger(singletons_events[\"b\" /* CoreEvents */].ACTIVITY_DATA_SENT, { module: 'assign' });\n                    }\n                    // Submission saved, trigger events.\n                    singletons_form[\"a\" /* CoreForms */].triggerFormSubmittedEvent(this.formElement, sent, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n                    singletons_events[\"b\" /* CoreEvents */].trigger(services_assign[\"d\" /* AddonModAssignProvider */].SUBMISSION_SAVED_EVENT, {\n                        assignmentId: this.assign.id,\n                        submissionId: this.userSubmission.id,\n                        userId: this.userId,\n                    }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n                    if (!this.assign.submissiondrafts) {\n                        // No drafts allowed, so it was submitted. Trigger event.\n                        singletons_events[\"b\" /* CoreEvents */].trigger(services_assign[\"d\" /* AddonModAssignProvider */].SUBMITTED_FOR_GRADING_EVENT, {\n                            assignmentId: this.assign.id,\n                            submissionId: this.userSubmission.id,\n                            userId: this.userId,\n                        }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n                    }\n                }\n                finally {\n                    modal.dismiss();\n                }\n            });\n        }\n        /**\n         * Function called when the time is up.\n         */\n        timeUp() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                this.timeUpToast = yield dom[\"a\" /* CoreDomUtils */].showToastWithOptions({\n                    message: singletons[\"M\" /* Translate */].instant('addon.mod_assign.caneditsubmission'),\n                    duration: 0,\n                    buttons: [singletons[\"M\" /* Translate */].instant('core.dismiss')],\n                    cssClass: 'core-danger-toast',\n                });\n            });\n        }\n        /**\n         * Component being destroyed.\n         */\n        ngOnDestroy() {\n            var _a;\n            this.isDestroyed = true;\n            (_a = this.timeUpToast) === null || _a === void 0 ? void 0 : _a.dismiss();\n            // Unblock the assignment.\n            if (this.assign) {\n                services_sync[\"a\" /* CoreSync */].unblockOperation(services_assign[\"d\" /* AddonModAssignProvider */].COMPONENT, this.assign.id);\n            }\n        }\n    }\n    AddonModAssignEditPage.ɵfac = function AddonModAssignEditPage_Factory(t) { return new (t || AddonModAssignEditPage)(core[\"yc\" /* ɵɵdirectiveInject */](router[\"a\" /* ActivatedRoute */])); };\n    AddonModAssignEditPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: AddonModAssignEditPage, selectors: [[\"page-addon-mod-assign-edit\"]], viewQuery: function AddonModAssignEditPage_Query(rf, ctx) {\n            if (rf & 1) {\n                core[\"ud\" /* ɵɵviewQuery */](_c0, true);\n            }\n            if (rf & 2) {\n                var _t;\n                core[\"dd\" /* ɵɵqueryRefresh */](_t = core[\"Nc\" /* ɵɵloadQuery */]()) && (ctx.formElement = _t.first);\n            }\n        }, decls: 15, vars: 11, consts: [[\"slot\", \"start\"], [3, \"text\"], [\"contextLevel\", \"module\", 3, \"text\", \"contextInstanceId\", \"courseId\"], [\"slot\", \"end\"], [\"fill\", \"clear\", 3, \"click\"], [3, \"hideUntil\"], [4, \"ngIf\"], [\"timeUpText\", \"00:00:00\", \"class\", \"ion-margin-horizontal\", 3, \"endTime\", \"timerText\", \"align\", \"timeLeftClassThreshold\", \"underTimeClassThresholds\", \"finished\", 4, \"ngIf\"], [\"class\", \"ion-text-wrap\", 4, \"ngIf\"], [\"name\", \"addon-mod_assign-edit-form\"], [\"editSubmissionForm\", \"\"], [3, \"assign\", \"submission\", \"plugin\", \"edit\", \"allowOffline\", 4, \"ngFor\", \"ngForOf\"], [\"timeUpText\", \"00:00:00\", 1, \"ion-margin-horizontal\", 3, \"endTime\", \"timerText\", \"align\", \"timeLeftClassThreshold\", \"underTimeClassThresholds\", \"finished\"], [1, \"ion-text-wrap\"], [\"contextLevel\", \"module\", 3, \"text\", \"component\", \"componentId\", \"contextInstanceId\", \"courseId\", \"maxHeight\"], [3, \"file\", \"component\", \"componentId\", 4, \"ngFor\", \"ngForOf\"], [3, \"file\", \"component\", \"componentId\"], [3, \"text\", \"filter\"], [\"slot\", \"end\", \"name\", \"submissionstatement\", 3, \"ngModel\", \"ngModelChange\"], [\"type\", \"hidden\", \"name\", \"submissionstatement\", 3, \"ngModel\"], [3, \"assign\", \"submission\", \"plugin\", \"edit\", \"allowOffline\"]], template: function AddonModAssignEditPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\");\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 0);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 1);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"zc\" /* ɵɵelement */](7, \"core-format-text\", 2);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](8, \"ion-buttons\", 3);\n                core[\"Ec\" /* ɵɵelementStart */](9, \"ion-button\", 4);\n                core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonModAssignEditPage_Template_ion_button_click_9_listener() { return ctx.save(); });\n                core[\"pd\" /* ɵɵtext */](10);\n                core[\"Pc\" /* ɵɵpipe */](11, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](12, \"ion-content\");\n                core[\"Ec\" /* ɵɵelementStart */](13, \"core-loading\", 5);\n                core[\"nd\" /* ɵɵtemplate */](14, AddonModAssignEditPage_ion_list_14_Template, 8, 5, \"ion-list\", 6);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 7, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", ctx.title)(\"contextInstanceId\", ctx.moduleId)(\"courseId\", ctx.courseId);\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](11, 9, \"core.save\"), \" \");\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", ctx.loaded);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.userSubmission && ctx.userSubmission.plugins && ctx.userSubmission.plugins.length);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], format_text[\"a\" /* CoreFormatTextDirective */], update_non_reactive_attributes[\"a\" /* CoreUpdateNonReactiveAttributesDirective */], ionic_angular[\"l\" /* IonButton */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], loading[\"a\" /* CoreLoadingComponent */], common[\"t\" /* NgIf */], ionic_angular[\"P\" /* IonList */], fesm2015_forms[\"H\" /* ɵangular_packages_forms_forms_y */], fesm2015_forms[\"s\" /* NgControlStatusGroup */], fesm2015_forms[\"t\" /* NgForm */], common[\"s\" /* NgForOf */], timer[\"a\" /* CoreTimerComponent */], ionic_angular[\"I\" /* IonItem */], ionic_angular[\"O\" /* IonLabel */], file[\"a\" /* CoreFileComponent */], ionic_angular[\"s\" /* IonCheckbox */], ionic_angular[\"d\" /* BooleanValueAccessor */], fesm2015_forms[\"r\" /* NgControlStatus */], fesm2015_forms[\"u\" /* NgModel */], fesm2015_forms[\"c\" /* DefaultValueAccessor */], submission_plugin[\"a\" /* AddonModAssignSubmissionPluginComponent */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */]], styles: [\"[_nghost-%COMP%]     core-timer{display:block}[_nghost-%COMP%]     core-timer .core-timer.core-timer-under-300{background-color:var(--danger-tint);color:var(--danger-shade)}[_nghost-%COMP%]     core-timer .core-timer.core-timer-under-900{background-color:var(--warning-tint);color:var(--warning-shade)}\"] });\n    return AddonModAssignEditPage;\n})();\n\n// EXTERNAL MODULE: ./src/core/features/course/classes/main-activity-page.ts\nvar main_activity_page = __webpack_require__(\"ghUQ\");\n\n// EXTERNAL MODULE: ./src/addons/mod/assign/components/index/index.ts\nvar index = __webpack_require__(\"FltD\");\n\n// EXTERNAL MODULE: ./src/core/directives/collapsible-header.ts\nvar collapsible_header = __webpack_require__(\"4JiN\");\n\n// CONCATENATED MODULE: ./src/addons/mod/assign/pages/index/index.page.ts\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n/**\n * Page that displays an assign.\n */\nlet index_page_AddonModAssignIndexPage = /*@__PURE__*/ (() => {\n    class AddonModAssignIndexPage extends main_activity_page[\"a\" /* CoreCourseModuleMainActivityPage */] {\n    }\n    AddonModAssignIndexPage.ɵfac = function AddonModAssignIndexPage_Factory(t) { return ɵAddonModAssignIndexPage_BaseFactory(t || AddonModAssignIndexPage); };\n    AddonModAssignIndexPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: AddonModAssignIndexPage, selectors: [[\"page-addon-mod-assign-index\"]], viewQuery: function AddonModAssignIndexPage_Query(rf, ctx) {\n            if (rf & 1) {\n                core[\"ud\" /* ɵɵviewQuery */](index[\"a\" /* AddonModAssignIndexComponent */], true);\n            }\n            if (rf & 2) {\n                var _t;\n                core[\"dd\" /* ɵɵqueryRefresh */](_t = core[\"Nc\" /* ɵɵloadQuery */]()) && (ctx.activityComponent = _t.first);\n            }\n        }, features: [core[\"ic\" /* ɵɵInheritDefinitionFeature */]], decls: 14, vars: 12, consts: [[\"collapsible\", \"\"], [\"slot\", \"start\"], [3, \"text\"], [\"contextLevel\", \"module\", 3, \"text\", \"contextInstanceId\", \"courseId\"], [\"slot\", \"end\"], [1, \"limited-width\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"module\", \"courseId\", \"dataRetrieved\"]], template: function AddonModAssignIndexPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\", 0);\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 1);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 2);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"zc\" /* ɵɵelement */](7, \"core-format-text\", 3);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"zc\" /* ɵɵelement */](8, \"ion-buttons\", 4);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](9, \"ion-content\", 5);\n                core[\"Ec\" /* ɵɵelementStart */](10, \"ion-refresher\", 6);\n                core[\"Mc\" /* ɵɵlistener */](\"ionRefresh\", function AddonModAssignIndexPage_Template_ion_refresher_ionRefresh_10_listener($event) { return ctx.activityComponent == null ? null : ctx.activityComponent.doRefresh($event.target); });\n                core[\"zc\" /* ɵɵelement */](11, \"ion-refresher-content\", 7);\n                core[\"Pc\" /* ɵɵpipe */](12, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](13, \"addon-mod-assign-index\", 8);\n                core[\"Mc\" /* ɵɵlistener */](\"dataRetrieved\", function AddonModAssignIndexPage_Template_addon_mod_assign_index_dataRetrieved_13_listener($event) { return ctx.updateData($event); });\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 8, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", ctx.title)(\"contextInstanceId\", ctx.module == null ? null : ctx.module.id)(\"courseId\", ctx.courseId);\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"disabled\", ctx.activityComponent == null ? null : ctx.activityComponent.showLoading);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Wc\" /* ɵɵpropertyInterpolate */](\"pullingText\", core[\"Qc\" /* ɵɵpipeBind1 */](12, 10, \"core.pulltorefresh\"));\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"module\", ctx.module)(\"courseId\", ctx.courseId);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], collapsible_header[\"b\" /* CoreCollapsibleHeaderDirective */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], format_text[\"a\" /* CoreFormatTextDirective */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], ionic_angular[\"bb\" /* IonRefresher */], ionic_angular[\"cb\" /* IonRefresherContent */], index[\"a\" /* AddonModAssignIndexComponent */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */]], encapsulation: 2 });\n    return AddonModAssignIndexPage;\n})();\nconst ɵAddonModAssignIndexPage_BaseFactory = /*@__PURE__*/ core[\"Gc\" /* ɵɵgetInheritedFactory */](index_page_AddonModAssignIndexPage);\n\n// EXTERNAL MODULE: ./src/core/classes/items-management/list-items-manager.ts\nvar list_items_manager = __webpack_require__(\"EoRH\");\n\n// EXTERNAL MODULE: ./src/core/classes/items-management/routed-items-manager-sources-tracker.ts\nvar routed_items_manager_sources_tracker = __webpack_require__(\"baaQ\");\n\n// EXTERNAL MODULE: ./src/core/components/split-view/split-view.ts\nvar split_view = __webpack_require__(\"46ml\");\n\n// EXTERNAL MODULE: ./src/addons/mod/assign/classes/submissions-source.ts\nvar submissions_source = __webpack_require__(\"PI6X\");\n\n// EXTERNAL MODULE: ./src/core/components/user-avatar/user-avatar.ts\nvar user_avatar = __webpack_require__(\"FeAf\");\n\n// EXTERNAL MODULE: ./src/core/components/empty-box/empty-box.ts\nvar empty_box = __webpack_require__(\"r8G5\");\n\n// CONCATENATED MODULE: ./src/addons/mod/assign/pages/submission-list/submission-list.page.ts\n\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction AddonModAssignSubmissionListPage_ion_item_16_ng_container_2_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"core.groupsseparate\"));\n    }\n}\nfunction AddonModAssignSubmissionListPage_ion_item_16_ng_container_3_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"qd\" /* ɵɵtextInterpolate */](core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"core.groupsvisible\"));\n    }\n}\nfunction AddonModAssignSubmissionListPage_ion_item_16_ion_select_option_6_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-select-option\", 15);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const groupOpt_r6 = ctx.$implicit;\n        core[\"Vc\" /* ɵɵproperty */](\"value\", groupOpt_r6.id);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", groupOpt_r6.name, \" \");\n    }\n}\nconst submission_list_page_c0 = function (a0) { return { header: a0 }; };\nfunction AddonModAssignSubmissionListPage_ion_item_16_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r8 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Ec\" /* ɵɵelementStart */](0, \"ion-item\", 10);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-label\", 11);\n        core[\"nd\" /* ɵɵtemplate */](2, AddonModAssignSubmissionListPage_ion_item_16_ng_container_2_Template, 3, 3, \"ng-container\", 12);\n        core[\"nd\" /* ɵɵtemplate */](3, AddonModAssignSubmissionListPage_ion_item_16_ng_container_3_Template, 3, 3, \"ng-container\", 12);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Ec\" /* ɵɵelementStart */](4, \"ion-select\", 13);\n        core[\"Mc\" /* ɵɵlistener */](\"ngModelChange\", function AddonModAssignSubmissionListPage_ion_item_16_Template_ion_select_ngModelChange_4_listener($event) { core[\"fd\" /* ɵɵrestoreView */](_r8); const ctx_r7 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r7.groupId = $event; })(\"ionChange\", function AddonModAssignSubmissionListPage_ion_item_16_Template_ion_select_ionChange_4_listener() { core[\"fd\" /* ɵɵrestoreView */](_r8); const ctx_r9 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r9.reloadSubmissions(); });\n        core[\"Pc\" /* ɵɵpipe */](5, \"translate\");\n        core[\"nd\" /* ɵɵtemplate */](6, AddonModAssignSubmissionListPage_ion_item_16_ion_select_option_6_Template, 2, 2, \"ion-select-option\", 14);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const ctx_r0 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r0.groupInfo.separateGroups);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r0.groupInfo.visibleGroups);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngModel\", ctx_r0.groupId)(\"interfaceOptions\", core[\"ad\" /* ɵɵpureFunction1 */](7, submission_list_page_c0, core[\"Qc\" /* ɵɵpipeBind1 */](5, 5, \"core.group\")));\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", ctx_r0.groupInfo.groups);\n    }\n}\nfunction AddonModAssignSubmissionListPage_ng_container_17_p_4_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\", 19);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const submission_r10 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"qd\" /* ɵɵtextInterpolate */](submission_r10.userfullname);\n    }\n}\nfunction AddonModAssignSubmissionListPage_ng_container_17_p_5_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\", 19);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const submission_r10 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"sd\" /* ɵɵtextInterpolate2 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](2, 2, \"addon.mod_assign.hiddenuser\"), \"\", submission_r10.blindid, \" \");\n    }\n}\nfunction AddonModAssignSubmissionListPage_ng_container_17_p_6_span_1_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"span\", 22);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const submission_r10 = core[\"Oc\" /* ɵɵnextContext */](2).$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", submission_r10.groupname, \" \");\n    }\n}\nfunction AddonModAssignSubmissionListPage_ng_container_17_p_6_span_2_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"span\", 23);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"addon.mod_assign.noteam\"), \" \");\n    }\n}\nfunction AddonModAssignSubmissionListPage_ng_container_17_p_6_span_3_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"span\", 23);\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"addon.mod_assign.multipleteams\"), \" \");\n    }\n}\nfunction AddonModAssignSubmissionListPage_ng_container_17_p_6_span_4_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"span\");\n        core[\"pd\" /* ɵɵtext */](1);\n        core[\"Pc\" /* ɵɵpipe */](2, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](2, 1, \"addon.mod_assign.defaultteam\"), \" \");\n    }\n}\nfunction AddonModAssignSubmissionListPage_ng_container_17_p_6_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\");\n        core[\"nd\" /* ɵɵtemplate */](1, AddonModAssignSubmissionListPage_ng_container_17_p_6_span_1_Template, 2, 1, \"span\", 20);\n        core[\"nd\" /* ɵɵtemplate */](2, AddonModAssignSubmissionListPage_ng_container_17_p_6_span_2_Template, 3, 3, \"span\", 21);\n        core[\"nd\" /* ɵɵtemplate */](3, AddonModAssignSubmissionListPage_ng_container_17_p_6_span_3_Template, 3, 3, \"span\", 21);\n        core[\"nd\" /* ɵɵtemplate */](4, AddonModAssignSubmissionListPage_ng_container_17_p_6_span_4_Template, 3, 3, \"span\", 12);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const submission_r10 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        const ctx_r13 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", submission_r10.groupname);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r13.assign.preventsubmissionnotingroup && !submission_r10.groupname && submission_r10.noGroups && !submission_r10.blindid);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r13.assign.preventsubmissionnotingroup && !submission_r10.groupname && submission_r10.manyGroups && !submission_r10.blindid);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx_r13.assign.preventsubmissionnotingroup && !submission_r10.groupname);\n    }\n}\nfunction AddonModAssignSubmissionListPage_ng_container_17_p_7_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\");\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-badge\", 24);\n        core[\"pd\" /* ɵɵtext */](2);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const submission_r10 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"color\", submission_r10.statusColor);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", submission_r10.statusTranslated, \" \");\n    }\n}\nfunction AddonModAssignSubmissionListPage_ng_container_17_p_8_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"Ec\" /* ɵɵelementStart */](0, \"p\");\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-badge\", 24);\n        core[\"pd\" /* ɵɵtext */](2);\n        core[\"Pc\" /* ɵɵpipe */](3, \"translate\");\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n    }\n    if (rf & 2) {\n        const submission_r10 = core[\"Oc\" /* ɵɵnextContext */]().$implicit;\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"color\", submission_r10.gradingColor);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](3, 2, submission_r10.gradingStatusTranslationId), \" \");\n    }\n}\nfunction AddonModAssignSubmissionListPage_ng_container_17_Template(rf, ctx) {\n    if (rf & 1) {\n        const _r27 = core[\"Fc\" /* ɵɵgetCurrentView */]();\n        core[\"Cc\" /* ɵɵelementContainerStart */](0);\n        core[\"Ec\" /* ɵɵelementStart */](1, \"ion-item\", 16);\n        core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonModAssignSubmissionListPage_ng_container_17_Template_ion_item_click_1_listener() { core[\"fd\" /* ɵɵrestoreView */](_r27); const submission_r10 = ctx.$implicit; const ctx_r26 = core[\"Oc\" /* ɵɵnextContext */](); return ctx_r26.submissions.select(submission_r10); });\n        core[\"zc\" /* ɵɵelement */](2, \"core-user-avatar\", 17);\n        core[\"Ec\" /* ɵɵelementStart */](3, \"ion-label\");\n        core[\"nd\" /* ɵɵtemplate */](4, AddonModAssignSubmissionListPage_ng_container_17_p_4_Template, 2, 1, \"p\", 18);\n        core[\"nd\" /* ɵɵtemplate */](5, AddonModAssignSubmissionListPage_ng_container_17_p_5_Template, 3, 4, \"p\", 18);\n        core[\"nd\" /* ɵɵtemplate */](6, AddonModAssignSubmissionListPage_ng_container_17_p_6_Template, 5, 4, \"p\", 12);\n        core[\"nd\" /* ɵɵtemplate */](7, AddonModAssignSubmissionListPage_ng_container_17_p_7_Template, 3, 2, \"p\", 12);\n        core[\"nd\" /* ɵɵtemplate */](8, AddonModAssignSubmissionListPage_ng_container_17_p_8_Template, 4, 4, \"p\", 12);\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Dc\" /* ɵɵelementEnd */]();\n        core[\"Bc\" /* ɵɵelementContainerEnd */]();\n    }\n    if (rf & 2) {\n        const submission_r10 = ctx.$implicit;\n        const ctx_r1 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"mc\" /* ɵɵattribute */](\"aria-current\", ctx_r1.submissions.getItemAriaCurrent(submission_r10));\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"user\", submission_r10)(\"linkProfile\", false);\n        core[\"lc\" /* ɵɵadvance */](2);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", submission_r10.userfullname);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !submission_r10.userfullname);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx_r1.assign && ctx_r1.assign.teamsubmission);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", submission_r10.statusTranslated);\n        core[\"lc\" /* ɵɵadvance */](1);\n        core[\"Vc\" /* ɵɵproperty */](\"ngIf\", submission_r10.gradingStatusTranslationId);\n    }\n}\nfunction AddonModAssignSubmissionListPage_core_empty_box_18_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"core-empty-box\", 25);\n        core[\"Pc\" /* ɵɵpipe */](1, \"translate\");\n    }\n    if (rf & 2) {\n        core[\"Vc\" /* ɵɵproperty */](\"message\", core[\"Qc\" /* ɵɵpipeBind1 */](1, 1, \"addon.mod_assign.submissionstatus_\"));\n    }\n}\n/**\n * Page that displays a list of submissions of an assignment.\n */\nlet submission_list_page_AddonModAssignSubmissionListPage = /*@__PURE__*/ (() => {\n    class AddonModAssignSubmissionListPage {\n        constructor() {\n            this.title = '';\n            // Update data if some grade changes.\n            this.gradedObserver = singletons_events[\"b\" /* CoreEvents */].on(services_assign[\"d\" /* AddonModAssignProvider */].GRADED_EVENT, (data) => {\n                var _a;\n                if (this.submissions.loaded &&\n                    this.submissions.getSource().assign &&\n                    data.assignmentId == ((_a = this.submissions.getSource().assign) === null || _a === void 0 ? void 0 : _a.id) &&\n                    data.userId == sites[\"b\" /* CoreSites */].getCurrentSiteUserId()) {\n                    // Grade changed, refresh the data.\n                    this.refreshAllData(true);\n                }\n            }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n            // Refresh data if this assign is synchronized.\n            const events = [assign_sync[\"b\" /* AddonModAssignSyncProvider */].AUTO_SYNCED, assign_sync[\"b\" /* AddonModAssignSyncProvider */].MANUAL_SYNCED];\n            this.syncObserver = singletons_events[\"b\" /* CoreEvents */].onMultiple(events, (data) => {\n                if (!this.submissions.loaded || ('context' in data && data.context == 'submission-list')) {\n                    return;\n                }\n                this.refreshAllData(false);\n            }, sites[\"b\" /* CoreSites */].getCurrentSiteId());\n            try {\n                const moduleId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('cmId');\n                const courseId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('courseId');\n                const groupId = services_navigator[\"a\" /* CoreNavigator */].getRouteNumberParam('groupId') || 0;\n                const selectedStatus = services_navigator[\"a\" /* CoreNavigator */].getRouteParam('status');\n                const submissionsSource = routed_items_manager_sources_tracker[\"a\" /* CoreRoutedItemsManagerSourcesTracker */].getOrCreateSource(submissions_source[\"b\" /* AddonModAssignSubmissionsSource */], [courseId, moduleId, selectedStatus]);\n                submissionsSource.groupId = groupId;\n                this.sourceUnsubscribe = submissionsSource.addListener({\n                    onItemsUpdated: () => {\n                        var _a;\n                        this.title = ((_a = this.submissions.getSource().assign) === null || _a === void 0 ? void 0 : _a.name) || this.title;\n                    },\n                });\n                this.submissions = new list_items_manager[\"a\" /* CoreListItemsManager */](submissionsSource, AddonModAssignSubmissionListPage);\n            }\n            catch (error) {\n                dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                services_navigator[\"a\" /* CoreNavigator */].back();\n                return;\n            }\n        }\n        get assign() {\n            return this.submissions.getSource().assign;\n        }\n        get groupInfo() {\n            return this.submissions.getSource().groupInfo;\n        }\n        get moduleId() {\n            return this.submissions.getSource().MODULE_ID;\n        }\n        get courseId() {\n            return this.submissions.getSource().COURSE_ID;\n        }\n        get groupId() {\n            return this.submissions.getSource().groupId;\n        }\n        set groupId(value) {\n            this.submissions.getSource().groupId = value;\n        }\n        /**\n         * @inheritdoc\n         */\n        ngAfterViewInit() {\n            const selectedStatus = this.submissions.getSource().SELECTED_STATUS;\n            this.title = singletons[\"M\" /* Translate */].instant(selectedStatus\n                ? (selectedStatus === submissions_source[\"a\" /* AddonModAssignListFilterName */].NEED_GRADING\n                    ? 'addon.mod_assign.numberofsubmissionsneedgrading'\n                    : `addon.mod_assign.submissionstatus_${selectedStatus}`)\n                : 'addon.mod_assign.numberofparticipants');\n            this.fetchAssignment(true).finally(() => {\n                this.submissions.start(this.splitView);\n            });\n        }\n        /**\n         * Fetch assignment data.\n         *\n         * @param sync Whether to try to synchronize data.\n         * @return Promise resolved when done.\n         */\n        fetchAssignment(sync = false) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                try {\n                    yield this.submissions.getSource().loadAssignment(sync);\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'Error getting assigment data.');\n                }\n            });\n        }\n        /**\n         * Refresh all the data.\n         *\n         * @param sync Whether to try to synchronize data.\n         * @return Promise resolved when done.\n         */\n        refreshAllData(sync) {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                try {\n                    yield this.submissions.getSource().invalidateCache();\n                }\n                finally {\n                    this.fetchAssignment(sync);\n                }\n            });\n        }\n        /**\n         * Refresh the list.\n         *\n         * @param refresher Refresher.\n         */\n        refreshList(refresher) {\n            this.refreshAllData(true).finally(() => {\n                refresher === null || refresher === void 0 ? void 0 : refresher.complete();\n            });\n        }\n        /**\n         * Reload submissions list.\n         */\n        reloadSubmissions() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                yield this.submissions.reload();\n            });\n        }\n        /**\n         * Component being destroyed.\n         */\n        ngOnDestroy() {\n            var _a, _b;\n            (_a = this.gradedObserver) === null || _a === void 0 ? void 0 : _a.off();\n            (_b = this.syncObserver) === null || _b === void 0 ? void 0 : _b.off();\n            this.submissions.destroy();\n            this.sourceUnsubscribe && this.sourceUnsubscribe();\n        }\n    }\n    AddonModAssignSubmissionListPage.ɵfac = function AddonModAssignSubmissionListPage_Factory(t) { return new (t || AddonModAssignSubmissionListPage)(); };\n    AddonModAssignSubmissionListPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: AddonModAssignSubmissionListPage, selectors: [[\"page-addon-mod-assign-submission-list\"]], viewQuery: function AddonModAssignSubmissionListPage_Query(rf, ctx) {\n            if (rf & 1) {\n                core[\"ud\" /* ɵɵviewQuery */](split_view[\"a\" /* CoreSplitViewComponent */], true);\n            }\n            if (rf & 2) {\n                var _t;\n                core[\"dd\" /* ɵɵqueryRefresh */](_t = core[\"Nc\" /* ɵɵloadQuery */]()) && (ctx.splitView = _t.first);\n            }\n        }, decls: 19, vars: 14, consts: [[\"slot\", \"start\"], [3, \"text\"], [\"contextLevel\", \"module\", 3, \"text\", \"contextInstanceId\", \"courseId\"], [\"slot\", \"end\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"hideUntil\"], [\"class\", \"ion-text-wrap core-group-selector\", 4, \"ngIf\"], [4, \"ngFor\", \"ngForOf\"], [\"icon\", \"fas-file-signature\", 3, \"message\", 4, \"ngIf\"], [1, \"ion-text-wrap\", \"core-group-selector\"], [\"id\", \"addon-assign-groupslabel-list\"], [4, \"ngIf\"], [\"aria-labelledby\", \"addon-assign-groupslabel-list\", \"interface\", \"action-sheet\", \"slot\", \"end\", 3, \"ngModel\", \"interfaceOptions\", \"ngModelChange\", \"ionChange\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [\"button\", \"\", \"detail\", \"true\", 1, \"ion-text-wrap\", 3, \"click\"], [\"slot\", \"start\", 3, \"user\", \"linkProfile\"], [\"class\", \"item-heading\", 4, \"ngIf\"], [1, \"item-heading\"], [\"class\", \"core-groupname\", 4, \"ngIf\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [1, \"core-groupname\"], [1, \"text-danger\"], [1, \"ion-text-center\", \"ion-text-wrap\", 3, \"color\"], [\"icon\", \"fas-file-signature\", 3, \"message\"]], template: function AddonModAssignSubmissionListPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\");\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 0);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 1);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"zc\" /* ɵɵelement */](7, \"core-format-text\", 2);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"zc\" /* ɵɵelement */](8, \"ion-buttons\", 3);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](9, \"ion-content\");\n                core[\"Ec\" /* ɵɵelementStart */](10, \"core-split-view\");\n                core[\"Ec\" /* ɵɵelementStart */](11, \"ion-refresher\", 4);\n                core[\"Mc\" /* ɵɵlistener */](\"ionRefresh\", function AddonModAssignSubmissionListPage_Template_ion_refresher_ionRefresh_11_listener($event) { return ctx.refreshList($event.target); });\n                core[\"zc\" /* ɵɵelement */](12, \"ion-refresher-content\", 5);\n                core[\"Pc\" /* ɵɵpipe */](13, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](14, \"core-loading\", 6);\n                core[\"Ec\" /* ɵɵelementStart */](15, \"ion-list\");\n                core[\"nd\" /* ɵɵtemplate */](16, AddonModAssignSubmissionListPage_ion_item_16_Template, 7, 9, \"ion-item\", 7);\n                core[\"nd\" /* ɵɵtemplate */](17, AddonModAssignSubmissionListPage_ng_container_17_Template, 9, 8, \"ng-container\", 8);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"nd\" /* ɵɵtemplate */](18, AddonModAssignSubmissionListPage_core_empty_box_18_Template, 2, 3, \"core-empty-box\", 9);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 10, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", ctx.title)(\"contextInstanceId\", ctx.moduleId)(\"courseId\", ctx.courseId);\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"Vc\" /* ɵɵproperty */](\"disabled\", !ctx.submissions.loaded);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Wc\" /* ɵɵpropertyInterpolate */](\"pullingText\", core[\"Qc\" /* ɵɵpipeBind1 */](13, 12, \"core.pulltorefresh\"));\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", ctx.submissions.loaded);\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.groupInfo.separateGroups || ctx.groupInfo.visibleGroups);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngForOf\", ctx.submissions.items);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", !ctx.submissions || ctx.submissions.empty);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], format_text[\"a\" /* CoreFormatTextDirective */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], split_view[\"a\" /* CoreSplitViewComponent */], ionic_angular[\"bb\" /* IonRefresher */], ionic_angular[\"cb\" /* IonRefresherContent */], loading[\"a\" /* CoreLoadingComponent */], ionic_angular[\"P\" /* IonList */], common[\"t\" /* NgIf */], common[\"s\" /* NgForOf */], ionic_angular[\"I\" /* IonItem */], ionic_angular[\"O\" /* IonLabel */], ionic_angular[\"lb\" /* IonSelect */], ionic_angular[\"Ob\" /* SelectValueAccessor */], fesm2015_forms[\"r\" /* NgControlStatus */], fesm2015_forms[\"u\" /* NgModel */], ionic_angular[\"mb\" /* IonSelectOption */], user_avatar[\"a\" /* CoreUserAvatarComponent */], ionic_angular[\"k\" /* IonBadge */], empty_box[\"a\" /* CoreEmptyBoxComponent */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */]], encapsulation: 2 });\n    return AddonModAssignSubmissionListPage;\n})();\n\n// EXTERNAL MODULE: ./src/core/classes/items-management/swipe-navigation-items-manager.ts\nvar swipe_navigation_items_manager = __webpack_require__(\"eoiU\");\n\n// EXTERNAL MODULE: ./src/core/features/course/services/course.ts\nvar course = __webpack_require__(\"ULAo\");\n\n// EXTERNAL MODULE: ./src/addons/mod/assign/components/submission/submission.ts\nvar submission = __webpack_require__(\"q/1B\");\n\n// EXTERNAL MODULE: ./src/core/components/navbar-buttons/navbar-buttons.ts\nvar navbar_buttons = __webpack_require__(\"ACV2\");\n\n// EXTERNAL MODULE: ./src/core/directives/swipe-navigation.ts\nvar swipe_navigation = __webpack_require__(\"OZH1\");\n\n// CONCATENATED MODULE: ./src/addons/mod/assign/pages/submission-review/submission-review.ts\n\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction AddonModAssignSubmissionReviewPage_addon_mod_assign_submission_18_Template(rf, ctx) {\n    if (rf & 1) {\n        core[\"zc\" /* ɵɵelement */](0, \"addon-mod-assign-submission\", 10);\n    }\n    if (rf & 2) {\n        const ctx_r0 = core[\"Oc\" /* ɵɵnextContext */]();\n        core[\"Vc\" /* ɵɵproperty */](\"courseId\", ctx_r0.courseId)(\"moduleId\", ctx_r0.moduleId)(\"submitId\", ctx_r0.submitId)(\"blindId\", ctx_r0.blindId);\n    }\n}\n/**\n * Page that displays a submission.\n */\nlet submission_review_AddonModAssignSubmissionReviewPage = /*@__PURE__*/ (() => {\n    class AddonModAssignSubmissionReviewPage {\n        constructor(route) {\n            this.route = route;\n            this.title = ''; // Title to display.\n            this.loaded = false; // Whether data has been loaded.\n            this.canSaveGrades = false; // Whether the user can save grades.\n            this.blindMarking = false; // Whether it uses blind marking.\n            this.forceLeave = false; // To allow leaving the page without checking for changes.\n        }\n        /**\n         * @inheritdoc\n         */\n        ngOnInit() {\n            this.route.queryParams.subscribe((params) => {\n                var _a;\n                try {\n                    this.moduleId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('cmId');\n                    this.courseId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('courseId');\n                    this.submitId = services_navigator[\"a\" /* CoreNavigator */].getRouteNumberParam('submitId') || 0;\n                    this.blindId = services_navigator[\"a\" /* CoreNavigator */].getRouteNumberParam('blindId', { params });\n                    const groupId = services_navigator[\"a\" /* CoreNavigator */].getRequiredRouteNumberParam('groupId');\n                    const selectedStatus = services_navigator[\"a\" /* CoreNavigator */].getRouteParam('selectedStatus');\n                    const submissionsSource = routed_items_manager_sources_tracker[\"a\" /* CoreRoutedItemsManagerSourcesTracker */].getOrCreateSource(submissions_source[\"b\" /* AddonModAssignSubmissionsSource */], [this.courseId, this.moduleId, selectedStatus]);\n                    (_a = this.submissions) === null || _a === void 0 ? void 0 : _a.destroy();\n                    submissionsSource.groupId = groupId;\n                    this.submissions = new submission_review_AddonModAssignSubmissionSwipeItemsManager(submissionsSource);\n                    this.submissions.start();\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModal(error);\n                    services_navigator[\"a\" /* CoreNavigator */].back();\n                    return;\n                }\n                this.fetchSubmission().finally(() => {\n                    this.loaded = true;\n                });\n            });\n        }\n        /**\n         * @inheritdoc\n         */\n        ngOnDestroy() {\n            var _a;\n            (_a = this.submissions) === null || _a === void 0 ? void 0 : _a.destroy();\n        }\n        /**\n         * Check if we can leave the page or not.\n         *\n         * @return Resolved if we can leave it, rejected if not.\n         */\n        canLeave() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                if (!this.submissionComponent || this.forceLeave) {\n                    return true;\n                }\n                // Check if data has changed.\n                return this.submissionComponent.canLeave();\n            });\n        }\n        /**\n         * User entered the page.\n         */\n        ionViewDidEnter() {\n            var _a;\n            (_a = this.submissionComponent) === null || _a === void 0 ? void 0 : _a.ionViewDidEnter();\n        }\n        /**\n         * User left the page.\n         */\n        ionViewDidLeave() {\n            var _a;\n            (_a = this.submissionComponent) === null || _a === void 0 ? void 0 : _a.ionViewDidLeave();\n        }\n        /**\n         * Get the submission.\n         *\n         * @return Promise resolved when done.\n         */\n        fetchSubmission() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                this.assign = yield services_assign[\"a\" /* AddonModAssign */].getAssignment(this.courseId, this.moduleId);\n                this.title = this.assign.name;\n                this.blindMarking = !!this.assign.blindmarking && !this.assign.revealidentities;\n                const gradeInfo = yield course[\"a\" /* CoreCourse */].getModuleBasicGradeInfo(this.moduleId);\n                if (!gradeInfo) {\n                    return;\n                }\n                // Grades can be saved if simple grading.\n                if (gradeInfo.advancedgrading && gradeInfo.advancedgrading[0] &&\n                    gradeInfo.advancedgrading[0].method !== undefined) {\n                    const method = gradeInfo.advancedgrading[0].method || 'simple';\n                    this.canSaveGrades = method == 'simple';\n                }\n                else {\n                    this.canSaveGrades = true;\n                }\n            });\n        }\n        /**\n         * Refresh all the data.\n         *\n         * @return Promise resolved when done.\n         */\n        refreshAllData() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                const promises = [];\n                promises.push(services_assign[\"a\" /* AddonModAssign */].invalidateAssignmentData(this.courseId));\n                if (this.assign) {\n                    promises.push(services_assign[\"a\" /* AddonModAssign */].invalidateSubmissionData(this.assign.id));\n                    promises.push(services_assign[\"a\" /* AddonModAssign */].invalidateAssignmentUserMappingsData(this.assign.id));\n                    promises.push(services_assign[\"a\" /* AddonModAssign */].invalidateSubmissionStatusData(this.assign.id, this.submitId, undefined, this.blindMarking));\n                }\n                try {\n                    yield Promise.all(promises);\n                }\n                finally {\n                    this.submissionComponent && this.submissionComponent.invalidateAndRefresh(true);\n                    yield this.fetchSubmission();\n                }\n            });\n        }\n        /**\n         * Refresh the data.\n         *\n         * @param refresher Refresher.\n         */\n        refreshSubmission(refresher) {\n            this.refreshAllData().finally(() => {\n                refresher === null || refresher === void 0 ? void 0 : refresher.complete();\n            });\n        }\n        /**\n         * Submit a grade and feedback.\n         */\n        submitGrade() {\n            return Object(tslib_es6[\"a\" /* __awaiter */])(this, void 0, void 0, function* () {\n                if (!this.submissionComponent) {\n                    return;\n                }\n                try {\n                    yield this.submissionComponent.submitGrade();\n                    // Grade submitted, leave the view if not in tablet.\n                    if (!screen[\"a\" /* CoreScreen */].isTablet) {\n                        this.forceLeave = true;\n                        services_navigator[\"a\" /* CoreNavigator */].back();\n                    }\n                }\n                catch (error) {\n                    dom[\"a\" /* CoreDomUtils */].showErrorModalDefault(error, 'core.error', true);\n                }\n            });\n        }\n    }\n    AddonModAssignSubmissionReviewPage.ɵfac = function AddonModAssignSubmissionReviewPage_Factory(t) { return new (t || AddonModAssignSubmissionReviewPage)(core[\"yc\" /* ɵɵdirectiveInject */](router[\"a\" /* ActivatedRoute */])); };\n    AddonModAssignSubmissionReviewPage.ɵcmp = core[\"sc\" /* ɵɵdefineComponent */]({ type: AddonModAssignSubmissionReviewPage, selectors: [[\"page-addon-mod-assign-submission-review\"]], viewQuery: function AddonModAssignSubmissionReviewPage_Query(rf, ctx) {\n            if (rf & 1) {\n                core[\"ud\" /* ɵɵviewQuery */](submission[\"a\" /* AddonModAssignSubmissionComponent */], true);\n            }\n            if (rf & 2) {\n                var _t;\n                core[\"dd\" /* ɵɵqueryRefresh */](_t = core[\"Nc\" /* ɵɵloadQuery */]()) && (ctx.submissionComponent = _t.first);\n            }\n        }, decls: 19, vars: 17, consts: [[\"slot\", \"start\"], [3, \"text\"], [\"contextLevel\", \"module\", 3, \"text\", \"contextInstanceId\", \"courseId\"], [\"slot\", \"end\"], [\"fill\", \"clear\", 3, \"hidden\", \"click\"], [3, \"core-swipe-navigation\"], [\"slot\", \"fixed\", 3, \"disabled\", \"ionRefresh\"], [3, \"pullingText\"], [3, \"hideUntil\"], [3, \"courseId\", \"moduleId\", \"submitId\", \"blindId\", 4, \"ngIf\"], [3, \"courseId\", \"moduleId\", \"submitId\", \"blindId\"]], template: function AddonModAssignSubmissionReviewPage_Template(rf, ctx) {\n            if (rf & 1) {\n                core[\"Ec\" /* ɵɵelementStart */](0, \"ion-header\");\n                core[\"Ec\" /* ɵɵelementStart */](1, \"ion-toolbar\");\n                core[\"Ec\" /* ɵɵelementStart */](2, \"ion-buttons\", 0);\n                core[\"zc\" /* ɵɵelement */](3, \"ion-back-button\", 1);\n                core[\"Pc\" /* ɵɵpipe */](4, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](5, \"ion-title\");\n                core[\"Ec\" /* ɵɵelementStart */](6, \"h1\");\n                core[\"zc\" /* ɵɵelement */](7, \"core-format-text\", 2);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"zc\" /* ɵɵelement */](8, \"ion-buttons\", 3);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](9, \"core-navbar-buttons\", 3);\n                core[\"Ec\" /* ɵɵelementStart */](10, \"ion-button\", 4);\n                core[\"Mc\" /* ɵɵlistener */](\"click\", function AddonModAssignSubmissionReviewPage_Template_ion_button_click_10_listener() { return ctx.submitGrade(); });\n                core[\"pd\" /* ɵɵtext */](11);\n                core[\"Pc\" /* ɵɵpipe */](12, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](13, \"ion-content\", 5);\n                core[\"Ec\" /* ɵɵelementStart */](14, \"ion-refresher\", 6);\n                core[\"Mc\" /* ɵɵlistener */](\"ionRefresh\", function AddonModAssignSubmissionReviewPage_Template_ion_refresher_ionRefresh_14_listener($event) { return ctx.refreshSubmission($event.target); });\n                core[\"zc\" /* ɵɵelement */](15, \"ion-refresher-content\", 7);\n                core[\"Pc\" /* ɵɵpipe */](16, \"translate\");\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Ec\" /* ɵɵelementStart */](17, \"core-loading\", 8);\n                core[\"nd\" /* ɵɵtemplate */](18, AddonModAssignSubmissionReviewPage_addon_mod_assign_submission_18_Template, 1, 4, \"addon-mod-assign-submission\", 9);\n                core[\"Dc\" /* ɵɵelementEnd */]();\n                core[\"Dc\" /* ɵɵelementEnd */]();\n            }\n            if (rf & 2) {\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", core[\"Qc\" /* ɵɵpipeBind1 */](4, 11, \"core.back\"));\n                core[\"lc\" /* ɵɵadvance */](4);\n                core[\"Vc\" /* ɵɵproperty */](\"text\", ctx.title)(\"contextInstanceId\", ctx.moduleId)(\"courseId\", ctx.courseId);\n                core[\"lc\" /* ɵɵadvance */](3);\n                core[\"Vc\" /* ɵɵproperty */](\"hidden\", !ctx.canSaveGrades);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"rd\" /* ɵɵtextInterpolate1 */](\" \", core[\"Qc\" /* ɵɵpipeBind1 */](12, 13, \"core.done\"), \" \");\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"core-swipe-navigation\", ctx.submissions);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"disabled\", !ctx.loaded);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Wc\" /* ɵɵpropertyInterpolate */](\"pullingText\", core[\"Qc\" /* ɵɵpipeBind1 */](16, 15, \"core.pulltorefresh\"));\n                core[\"lc\" /* ɵɵadvance */](2);\n                core[\"Vc\" /* ɵɵproperty */](\"hideUntil\", ctx.loaded);\n                core[\"lc\" /* ɵɵadvance */](1);\n                core[\"Vc\" /* ɵɵproperty */](\"ngIf\", ctx.loaded);\n            }\n        }, directives: [ionic_angular[\"C\" /* IonHeader */], ionic_angular[\"Ab\" /* IonToolbar */], ionic_angular[\"m\" /* IonButtons */], ionic_angular[\"h\" /* IonBackButton */], ionic_angular[\"i\" /* IonBackButtonDelegate */], ionic_angular[\"yb\" /* IonTitle */], format_text[\"a\" /* CoreFormatTextDirective */], navbar_buttons[\"a\" /* CoreNavBarButtonsComponent */], update_non_reactive_attributes[\"a\" /* CoreUpdateNonReactiveAttributesDirective */], ionic_angular[\"l\" /* IonButton */], content[\"a\" /* CoreContentDirective */], ionic_angular[\"v\" /* IonContent */], swipe_navigation[\"a\" /* CoreSwipeNavigationDirective */], ionic_angular[\"bb\" /* IonRefresher */], ionic_angular[\"cb\" /* IonRefresherContent */], loading[\"a\" /* CoreLoadingComponent */], common[\"t\" /* NgIf */], submission[\"a\" /* AddonModAssignSubmissionComponent */]], pipes: [ngx_translate_core[\"d\" /* TranslatePipe */]], encapsulation: 2 });\n    return AddonModAssignSubmissionReviewPage;\n})();\n/**\n * Helper to manage swiping within a collection of submissions.\n */\nclass submission_review_AddonModAssignSubmissionSwipeItemsManager extends swipe_navigation_items_manager[\"a\" /* CoreSwipeNavigationItemsManager */] {\n    /**\n     * @inheritdoc\n     */\n    getSelectedItemPathFromRoute(route) {\n        return route.params.submitId;\n    }\n}\n\n// CONCATENATED MODULE: ./src/addons/mod/assign/assign-lazy.module.ts\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst commonRoutes = [\n    {\n        path: ':courseId/:cmId',\n        component: index_page_AddonModAssignIndexPage,\n    },\n    {\n        path: ':courseId/:cmId/edit',\n        component: edit_AddonModAssignEditPage,\n        canDeactivate: [can_leave[\"a\" /* CanLeaveGuard */]],\n    },\n];\nconst mobileRoutes = [\n    ...commonRoutes,\n    {\n        path: ':courseId/:cmId/submission',\n        component: submission_list_page_AddonModAssignSubmissionListPage,\n    },\n    {\n        path: ':courseId/:cmId/submission/:submitId',\n        component: submission_review_AddonModAssignSubmissionReviewPage,\n        canDeactivate: [can_leave[\"a\" /* CanLeaveGuard */]],\n    },\n];\nconst tabletRoutes = [\n    ...commonRoutes,\n    {\n        path: ':courseId/:cmId/submission',\n        component: submission_list_page_AddonModAssignSubmissionListPage,\n        children: [\n            {\n                path: ':submitId',\n                component: submission_review_AddonModAssignSubmissionReviewPage,\n                canDeactivate: [can_leave[\"a\" /* CanLeaveGuard */]],\n            },\n        ],\n    },\n];\nconst routes = [\n    ...Object(app_routing_module[\"c\" /* conditionalRoutes */])(mobileRoutes, () => screen[\"a\" /* CoreScreen */].isMobile),\n    ...Object(app_routing_module[\"c\" /* conditionalRoutes */])(tabletRoutes, () => screen[\"a\" /* CoreScreen */].isTablet),\n];\nlet assign_lazy_module_AddonModAssignLazyModule = /*@__PURE__*/ (() => {\n    class AddonModAssignLazyModule {\n    }\n    AddonModAssignLazyModule.ɵmod = core[\"wc\" /* ɵɵdefineNgModule */]({ type: AddonModAssignLazyModule });\n    AddonModAssignLazyModule.ɵinj = core[\"vc\" /* ɵɵdefineInjector */]({ factory: function AddonModAssignLazyModule_Factory(t) { return new (t || AddonModAssignLazyModule)(); }, imports: [[\n                router[\"m\" /* RouterModule */].forChild(routes),\n                shared_module[\"a\" /* CoreSharedModule */],\n                components_module[\"a\" /* AddonModAssignComponentsModule */],\n            ]] });\n    return AddonModAssignLazyModule;\n})();\n(function () {\n    (typeof ngJitMode === \"undefined\" || ngJitMode) && core[\"kd\" /* ɵɵsetNgModuleScope */](assign_lazy_module_AddonModAssignLazyModule, { declarations: [index_page_AddonModAssignIndexPage,\n            submission_list_page_AddonModAssignSubmissionListPage,\n            submission_review_AddonModAssignSubmissionReviewPage,\n            edit_AddonModAssignEditPage], imports: [router[\"m\" /* RouterModule */], shared_module[\"a\" /* CoreSharedModule */],\n            components_module[\"a\" /* AddonModAssignComponentsModule */]] });\n})();\n\n\n/***/ }),\n\n/***/ \"eoiU\":\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"a\", function() { return CoreSwipeNavigationItemsManager; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(\"mrSG\");\n/* harmony import */ var _services_navigator__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(\"pHTc\");\n/* harmony import */ var _routed_items_manager__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(\"CtbY\");\n// (C) Copyright 2015 Moodle Pty Ltd.\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\n\n\n/**\n * Helper class to manage the state and routing of a swipeable page.\n */\nclass CoreSwipeNavigationItemsManager extends _routed_items_manager__WEBPACK_IMPORTED_MODULE_2__[/* CoreRoutedItemsManager */ \"a\"] {\n    /**\n     * Process page started operations.\n     */\n    start() {\n        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __awaiter */ \"a\"])(this, void 0, void 0, function* () {\n            this.updateSelectedItem();\n        });\n    }\n    /**\n     * Navigate to the next item.\n     */\n    navigateToNextItem() {\n        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __awaiter */ \"a\"])(this, void 0, void 0, function* () {\n            yield this.navigateToItemBy(1, 'forward');\n        });\n    }\n    /**\n     * Navigate to the previous item.\n     */\n    navigateToPreviousItem() {\n        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __awaiter */ \"a\"])(this, void 0, void 0, function* () {\n            yield this.navigateToItemBy(-1, 'back');\n        });\n    }\n    /**\n     * Has a next item.\n     */\n    hasNextItem() {\n        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __awaiter */ \"a\"])(this, void 0, void 0, function* () {\n            const item = yield this.getItemBy(1);\n            return !!item;\n        });\n    }\n    /**\n     * Has a previous item.\n     */\n    hasPreviousItem() {\n        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __awaiter */ \"a\"])(this, void 0, void 0, function* () {\n            const item = yield this.getItemBy(-1);\n            return !!item;\n        });\n    }\n    /**\n     * @inheritdoc\n     */\n    getCurrentPageRoute() {\n        return _services_navigator__WEBPACK_IMPORTED_MODULE_1__[/* CoreNavigator */ \"a\"].getCurrentRoute();\n    }\n    /**\n     * @inheritdoc\n     */\n    getSelectedItemPathFromRoute(route) {\n        const segments = [];\n        while (route) {\n            segments.push(...route.url);\n            if (!route.firstChild) {\n                break;\n            }\n            route = route.firstChild;\n        }\n        return segments.map(segment => segment.path).join('/').replace(/\\/+/, '/').trim() || null;\n    }\n    /**\n     * Navigate to an item by an offset.\n     *\n     * @param delta Index offset.\n     * @param animationDirection Animation direction.\n     */\n    navigateToItemBy(delta, animationDirection) {\n        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __awaiter */ \"a\"])(this, void 0, void 0, function* () {\n            const item = yield this.getItemBy(delta);\n            if (!item) {\n                return;\n            }\n            yield this.navigateToItem(item, { animationDirection, replace: true });\n        });\n    }\n    /**\n     * Get item by an offset.\n     *\n     * @param delta Index offset.\n     */\n    getItemBy(delta) {\n        var _a;\n        return Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __awaiter */ \"a\"])(this, void 0, void 0, function* () {\n            const items = this.getSource().getItems();\n            const selectedIndex = (_a = (this.selectedItem && (items === null || items === void 0 ? void 0 : items.indexOf(this.selectedItem)))) !== null && _a !== void 0 ? _a : -1;\n            if (selectedIndex === -1 || items === null) {\n                return null;\n            }\n            const deltaStep = delta > 0 ? 1 : -1;\n            let nextIndex = selectedIndex;\n            let deltaMoved = 0;\n            while (deltaMoved !== delta) {\n                nextIndex += deltaStep;\n                if (nextIndex < 0 || nextIndex >= items.length) {\n                    break;\n                }\n                if (this.skipItemInSwipe(items[nextIndex])) {\n                    continue;\n                }\n                deltaMoved += deltaStep;\n            }\n            if (deltaMoved === delta) {\n                return items[nextIndex];\n            }\n            if (!this.getSource().isCompleted()) {\n                yield this.getSource().load();\n                return this.getItemBy(delta);\n            }\n            return null;\n        });\n    }\n    /**\n     * Check if an item should be skipped during swipe navigation.\n     *\n     * @param item Item.\n     * @returns Whether to skip this item during swipe navigation.\n     */\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    skipItemInSwipe(item) {\n        return false;\n    }\n}\n\n\n/***/ })\n\n}]);","inputSourceMap":null}