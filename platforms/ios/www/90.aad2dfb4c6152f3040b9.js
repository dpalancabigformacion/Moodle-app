(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{"Yxj/":function(e,t,n){"use strict";n.r(t),n.d(t,"CoreCommentsViewerPageModule",(function(){return F}));var o=n("tyNb"),i=n("L3Fv"),s=n("mrSG"),a=n("fjkH"),c=n("MUy3"),r=n("9+EE"),m=n("5pQw"),d=n("kQNd"),l=n("TEn/"),g=n("BaYo"),h=n("pHTc"),_=n("j3ag"),C=n("bFG1"),u=n("3LXp"),f=n("4pns"),p=n("vuGA"),P=n("93ts"),b=n("rdx0"),O=n("Q98t"),w=n("nvXB"),v=n("wd/R"),M=n.n(v),I=n("fXoL"),x=n("hMzs"),D=n("ofXK"),y=n("fQ68"),V=n("8/N+"),E=n("nt/U"),T=n("PgjG"),k=n("xpMl"),L=n("ACYt"),N=n("3CSS"),A=n("r8G5"),z=n("FeAf"),S=n("O4u7"),U=n("sYmb"),R=n("uYHD");function CoreCommentsViewerPage_ion_button_9_Template(e,t){if(1&e){const e=I.Fc();I.Ec(0,"ion-button",15),I.Mc("click",(function CoreCommentsViewerPage_ion_button_9_Template_ion_button_click_0_listener(){I.fd(e);return I.Oc().toggleDelete()})),I.Pc(1,"translate"),I.zc(2,"ion-icon",16),I.Dc()}2&e&&I.mc("aria-label",I.Qc(1,1,"core.toggledelete"))}function CoreCommentsViewerPage_core_empty_box_20_Template(e,t){1&e&&(I.zc(0,"core-empty-box",17),I.Pc(1,"translate")),2&e&&I.Vc("message",I.Qc(1,1,"core.comments.nocomments"))}function CoreCommentsViewerPage_ng_container_23_p_1_Template(e,t){if(1&e&&(I.Ec(0,"p",25),I.pd(1),I.Pc(2,"coreFormatDate"),I.Dc()),2&e){const e=I.Oc().$implicit;I.lc(1),I.rd(" ",I.Rc(2,1,1e3*e.timecreated,"strftimedayshort")," ")}}function CoreCommentsViewerPage_ng_container_23_h2_4_Template(e,t){if(1&e&&(I.Ec(0,"h2",26),I.zc(1,"core-user-avatar",27),I.Ec(2,"div"),I.pd(3),I.Dc(),I.Dc()),2&e){const e=I.Oc().$implicit;I.lc(1),I.Vc("user",e)("linkProfile",!1),I.lc(2),I.qd(e.fullname)}}function CoreCommentsViewerPage_ng_container_23_ng_container_8_Template(e,t){if(1&e&&(I.Cc(0),I.pd(1),I.Pc(2,"coreFormatDate"),I.Bc()),2&e){const e=I.Oc().$implicit;I.lc(1),I.rd(" ",I.Rc(2,1,1e3*e.timecreated,"strftimetime")," ")}}function CoreCommentsViewerPage_ng_container_23_ng_container_9_Template(e,t){1&e&&(I.Cc(0),I.zc(1,"ion-icon",28),I.Ec(2,"span",29),I.pd(3),I.Pc(4,"translate"),I.Dc(),I.Bc()),2&e&&(I.lc(3),I.rd(" ",I.Qc(4,1,"core.deletedoffline")," "))}function CoreCommentsViewerPage_ng_container_23_div_10_Template(e,t){1&e&&I.zc(0,"div",30)}function CoreCommentsViewerPage_ng_container_23_ion_button_11_Template(e,t){if(1&e){const e=I.Fc();I.Ec(0,"ion-button",31),I.Mc("click",(function CoreCommentsViewerPage_ng_container_23_ion_button_11_Template_ion_button_click_0_listener(t){I.fd(e);const n=I.Oc().$implicit;return I.Oc().deleteComment(t,n)})),I.Pc(1,"translate"),I.zc(2,"ion-icon",32),I.Dc()}2&e&&(I.Vc("@coreSlideInOut","fromRight"),I.mc("aria-label",I.Qc(1,2,"core.delete")))}function CoreCommentsViewerPage_ng_container_23_ion_button_12_Template(e,t){if(1&e){const e=I.Fc();I.Ec(0,"ion-button",31),I.Mc("click",(function CoreCommentsViewerPage_ng_container_23_ion_button_12_Template_ion_button_click_0_listener(t){I.fd(e);const n=I.Oc().$implicit;return I.Oc().undoDeleteComment(t,n)})),I.Pc(1,"translate"),I.zc(2,"ion-icon",33),I.Dc()}2&e&&I.mc("aria-label",I.Qc(1,1,"core.restore"))}function CoreCommentsViewerPage_ng_container_23_Template(e,t){if(1&e&&(I.Cc(0),I.nd(1,CoreCommentsViewerPage_ng_container_23_p_1_Template,3,4,"p",18),I.Ec(2,"ion-item",19),I.Ec(3,"ion-label"),I.nd(4,CoreCommentsViewerPage_ng_container_23_h2_4_Template,4,3,"h2",20),I.Ec(5,"div",21),I.zc(6,"core-format-text",2),I.Dc(),I.Dc(),I.Ec(7,"ion-note",3),I.nd(8,CoreCommentsViewerPage_ng_container_23_ng_container_8_Template,3,4,"ng-container",22),I.nd(9,CoreCommentsViewerPage_ng_container_23_ng_container_9_Template,5,3,"ng-container",22),I.Dc(),I.nd(10,CoreCommentsViewerPage_ng_container_23_div_10_Template,1,0,"div",23),I.nd(11,CoreCommentsViewerPage_ng_container_23_ion_button_11_Template,3,4,"ion-button",24),I.nd(12,CoreCommentsViewerPage_ng_container_23_ion_button_12_Template,3,3,"ion-button",24),I.Dc(),I.Bc()),2&e){const e=t.$implicit,n=I.Oc();I.lc(1),I.Vc("ngIf",e.showDate),I.lc(1),I.qc("addon-message-mine",e.userid==n.currentUserId)("addon-message-not-mine",e.userid!=n.currentUserId)("addon-message-no-user",!e.showUserData),I.Vc("@coreSlideInOut",e.userid==n.currentUserId?"":"fromLeft"),I.lc(2),I.Vc("ngIf",e.showUserData),I.lc(2),I.Vc("text",e.content)("contextLevel",n.contextLevel)("contextInstanceId",n.instanceId)("courseId",n.courseId),I.lc(2),I.Vc("ngIf",!e.deleted),I.lc(1),I.Vc("ngIf",e.deleted),I.lc(1),I.Vc("ngIf",e.showTail),I.lc(1),I.Vc("ngIf",n.showDelete&&!e.deleted&&e.delete),I.lc(1),I.Vc("ngIf",n.showDelete&&e.deleted)}}function CoreCommentsViewerPage_ion_item_24_ion_button_15_Template(e,t){if(1&e){const e=I.Fc();I.Ec(0,"ion-button",31),I.Mc("click",(function CoreCommentsViewerPage_ion_item_24_ion_button_15_Template_ion_button_click_0_listener(t){I.fd(e);const n=I.Oc(2);return n.deleteComment(t,n.offlineComment)})),I.Pc(1,"translate"),I.zc(2,"ion-icon",32),I.Dc()}2&e&&(I.Vc("@coreSlideInOut","fromRight"),I.mc("aria-label",I.Qc(1,2,"core.delete")))}const _c0=function(e){return{$a:e}};function CoreCommentsViewerPage_ion_item_24_Template(e,t){if(1&e&&(I.Ec(0,"ion-item",34),I.Ec(1,"ion-label"),I.Ec(2,"p",35),I.zc(3,"ion-icon",36),I.pd(4),I.Pc(5,"translate"),I.Pc(6,"lowercase"),I.Pc(7,"translate"),I.Dc(),I.Ec(8,"div",21),I.zc(9,"core-format-text",2),I.Dc(),I.Dc(),I.Ec(10,"ion-note"),I.zc(11,"ion-icon",37),I.pd(12),I.Pc(13,"translate"),I.Dc(),I.zc(14,"div",30),I.nd(15,CoreCommentsViewerPage_ion_item_24_ion_button_15_Template,3,4,"ion-button",24),I.Dc()),2&e){const e=I.Oc();I.lc(4),I.rd(" ",I.Rc(5,7,"core.thereisdatatosync",I.ad(16,_c0,I.Qc(6,10,I.Qc(7,12,"core.comments.comments"))))," "),I.lc(5),I.Vc("text",e.offlineComment.content)("contextLevel",e.contextLevel)("contextInstanceId",e.instanceId)("courseId",e.courseId),I.lc(3),I.rd(" ",I.Qc(13,14,"core.notsent")," "),I.lc(3),I.Vc("ngIf",e.showDelete)}}function CoreCommentsViewerPage_ion_footer_25_Template(e,t){if(1&e){const e=I.Fc();I.Ec(0,"ion-footer",38),I.Ec(1,"ion-toolbar",39),I.Ec(2,"core-send-message-form",40),I.Mc("onSubmit",(function CoreCommentsViewerPage_ion_footer_25_Template_core_send_message_form_onSubmit_2_listener(t){I.fd(e);return I.Oc().addComment(t)})),I.Pc(3,"translate"),I.Dc(),I.Dc(),I.Dc()}if(2&e){const e=I.Oc();I.lc(2),I.Vc("sendDisabled",e.sending)("message",e.newComment)("placeholder",I.Qc(3,3,"core.comments.addcomment"))}}let Q=(()=>{class CoreCommentsViewerPage{constructor(e){this.route=e,this.comments=[],this.commentsLoaded=!1,this.itemId=0,this.area="",this.page=0,this.title="",this.canLoadMore=!1,this.loadMoreError=!1,this.canAddComments=!1,this.canDeleteComments=!1,this.showDelete=!1,this.hasOffline=!1,this.refreshIcon=g.a.ICON_LOADING,this.syncIcon=g.a.ICON_LOADING,this.sending=!1,this.newComment="",this.addDeleteCommentsAvailable=!1,this.viewDestroyed=!1,this.currentUserId=r.b.getCurrentSiteUserId(),this.syncObserver=a.b.on(d.b.AUTO_SYNCED,(e=>{e.contextLevel==this.contextLevel&&e.instanceId==this.instanceId&&e.componentName==this.componentName&&e.itemId==this.itemId&&e.area==this.area&&(this.showSyncWarnings(e.warnings),this.commentsLoaded=!1,this.refreshIcon=g.a.ICON_LOADING,this.syncIcon=g.a.ICON_LOADING,this.page=0,this.comments=[],this.fetchComments(!1))}),r.b.getCurrentSiteId()),this.isOnline=w.a.isOnline(),this.onlineObserver=_.B.onChange().subscribe((()=>{_.C.run((()=>{this.isOnline=w.a.isOnline()}))}))}ngOnInit(){return Object(s.a)(this,void 0,void 0,(function*(){try{this.contextLevel=h.a.getRequiredRouteParam("contextLevel"),this.instanceId=h.a.getRequiredRouteNumberParam("instanceId"),this.componentName=h.a.getRequiredRouteParam("componentName"),this.itemId=h.a.getRequiredRouteNumberParam("itemId"),this.area=h.a.getRouteParam("area")||"",this.title=h.a.getRouteNumberParam("title")||_.M.instant("core.comments.comments"),this.courseId=h.a.getRouteNumberParam("courseId")}catch(e){return u.a.showErrorModal(e),h.a.back(),void 0}this.addDeleteCommentsAvailable=yield m.a.isAddCommentsAvailable(),this.currentUserId=r.b.getCurrentSiteUserId(),this.commentsLoaded=!1,yield this.fetchComments(!0)}))}fetchComments(e,t=!1){return Object(s.a)(this,void 0,void 0,(function*(){this.loadMoreError=!1,e&&(yield C.a.ignoreErrors(this.syncComments(t)));try{const e=yield m.a.getComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area,this.page);this.canAddComments=this.addDeleteCommentsAvailable&&!!e.canpost;let t=e.comments.sort(((e,t)=>e.timecreated-t.timecreated));this.canLoadMore=void 0!==e.count?this.comments.length+t.length<e.count:e.comments.length>0&&e.comments.length>=m.b.pageSize,t=yield Promise.all(t.map((e=>this.loadCommentProfile(e)))),this.comments=t.concat(this.comments),this.comments.forEach(((e,t)=>{e.showDate=this.showDate(e,this.comments[t-1]),e.showUserData=this.showUserData(e,this.comments[t-1]),e.showTail=this.showTail(e,this.comments[t+1])})),this.canDeleteComments=this.addDeleteCommentsAvailable&&(this.hasOffline||this.comments.some((e=>!!e.delete))),yield this.loadOfflineData()}catch(e){this.loadMoreError=!0,e&&"assignsubmission_comments"==this.componentName?u.a.showAlertTranslated("core.notice","core.comments.commentsnotworking"):u.a.showErrorModalDefault(e,_.M.instant("core.error")+": get_comments")}finally{this.commentsLoaded=!0,this.refreshIcon=g.a.ICON_REFRESH,this.syncIcon=g.a.ICON_SYNC,0==this.page&&this.scrollToBottom()}}))}loadPrevious(e){return this.page++,this.canLoadMore=!1,this.fetchComments(!0).finally((()=>{e&&e()}))}refreshComments(e,t){return Object(s.a)(this,void 0,void 0,(function*(){this.commentsLoaded=!1,this.refreshIcon=g.a.ICON_LOADING,this.syncIcon=g.a.ICON_LOADING;try{yield this.invalidateComments()}finally{this.page=0,this.comments=[];try{yield this.fetchComments(!0,e)}finally{null==t?void 0:t.complete()}}}))}showSyncWarnings(e){const t=p.a.buildMessage(e);t&&u.a.showErrorModal(t)}syncComments(e){return Object(s.a)(this,void 0,void 0,(function*(){try{const e=yield d.a.syncComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area);this.showSyncWarnings((null==e?void 0:e.warnings)||[])}catch(t){throw e&&u.a.showErrorModalDefault(t,"core.errorsync",!0),new P.a(t)}}))}addComment(e){return Object(s.a)(this,void 0,void 0,(function*(){w.a.closeKeyboard();const t=yield u.a.showModalLoading("core.sending",!0);this.sending=!0;try{const n=yield m.a.addComment(e,this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area);if(u.a.showToast(n?"core.comments.eventcommentcreated":"core.datastoredoffline",!0,3e3),n){this.invalidateComments();const e=yield this.loadCommentProfile(n);e.showDate=this.showDate(e,this.comments[this.comments.length-1]),e.showUserData=this.showUserData(e,this.comments[this.comments.length-1]),e.showTail=this.showTail(e,this.comments[this.comments.length+1]),this.comments=this.comments.concat([e]),this.canDeleteComments=this.addDeleteCommentsAvailable,a.b.trigger(m.b.COMMENTS_COUNT_CHANGED_EVENT,{contextLevel:this.contextLevel,instanceId:this.instanceId,component:this.componentName,itemId:this.itemId,area:this.area,countChange:1},r.b.getCurrentSiteId())}else!1===n&&(yield this.loadOfflineData())}catch(e){u.a.showErrorModal(e)}finally{t.dismiss(),this.sending=!1,this.scrollToBottom()}}))}deleteComment(e,t){return Object(s.a)(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation();const n=O.a.userDate(1e3*("lastmodified"in t?t.lastmodified:t.timecreated),"core.strftimerecentfull"),o={contextlevel:this.contextLevel,instanceid:this.instanceId,component:this.componentName,itemid:this.itemId,area:this.area,content:t.content,id:"id"in t?t.id:void 0};try{yield u.a.showDeleteConfirm("core.comments.deletecommentbyon",{$a:{user:t.fullname||"",time:n}})}catch(e){return}try{const e=yield m.a.deleteComment(o);if(this.showDelete=!1,e&&"id"in t){const e=this.comments.findIndex((e=>e.id==t.id));e>=0&&(this.comments.splice(e,1),a.b.trigger(m.b.COMMENTS_COUNT_CHANGED_EVENT,{contextLevel:this.contextLevel,instanceId:this.instanceId,component:this.componentName,itemId:this.itemId,area:this.area,countChange:-1},r.b.getCurrentSiteId()))}else this.loadOfflineData();this.invalidateComments(),u.a.showToast("core.comments.eventcommentdeleted",!0,3e3)}catch(e){u.a.showErrorModalDefault(e,"Delete comment failed.")}}))}invalidateComments(){return m.a.invalidateCommentsData(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area)}loadCommentProfile(e){return Object(s.a)(this,void 0,void 0,(function*(){try{const t=yield f.a.getProfile(e.userid,void 0,!0);e.profileimageurl=t.profileimageurl,e.fullname=t.fullname}catch(e){}return e}))}showUserData(e,t){return!(e.userid==this.currentUserId||t&&t.userid==e.userid&&!e.showDate)}showTail(e,t){return!t||t.userid!=e.userid||!!t.showDate}showDate(e,t){return!t||!M()(1e3*e.timecreated).isSame(1e3*t.timecreated,"day")}loadOfflineData(){return Object(s.a)(this,void 0,void 0,(function*(){const e=[];let t=!1;e.push(b.a.getComment(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then((e=>Object(s.a)(this,void 0,void 0,(function*(){this.offlineComment=e,e&&(""==this.newComment&&(this.newComment=this.offlineComment.content),this.offlineComment.userid=this.currentUserId)}))))),e.push(b.a.getDeletedComments(this.contextLevel,this.instanceId,this.componentName,this.itemId,this.area).then((e=>{t=e&&e.length>0,t&&e.forEach((e=>{const t=this.comments.find((t=>t.id==e.commentid));t&&(t.deleted=!!e.deleted)}))}))),yield Promise.all(e),this.hasOffline=!!this.offlineComment||t}))}undoDeleteComment(e,t){return Object(s.a)(this,void 0,void 0,(function*(){e.preventDefault(),e.stopPropagation(),yield b.a.undoDeleteComment(t.id),t.deleted=!1,this.showDelete=!1}))}scrollToBottom(){setTimeout((()=>{var e;this.viewDestroyed||(null===(e=this.content)||void 0===e?void 0:e.scrollToBottom())}),100)}toggleDelete(){this.showDelete=!this.showDelete}ngOnDestroy(){var e;null===(e=this.syncObserver)||void 0===e?void 0:e.off(),this.onlineObserver.unsubscribe(),this.viewDestroyed=!0}}return CoreCommentsViewerPage.ɵfac=function CoreCommentsViewerPage_Factory(e){return new(e||CoreCommentsViewerPage)(I.yc(o.a))},CoreCommentsViewerPage.ɵcmp=I.sc({type:CoreCommentsViewerPage,selectors:[["page-core-comments-viewer"]],viewQuery:function CoreCommentsViewerPage_Query(e,t){var n;(1&e&&I.ud(l.v,!0),2&e)&&(I.dd(n=I.Nc())&&(t.content=n.first))},decls:26,vars:33,consts:[["slot","start"],[3,"text"],[3,"text","contextLevel","contextInstanceId","courseId"],["slot","end"],["slot","end","fill","clear",3,"click",4,"ngIf"],[3,"hidden","priority","content","iconAction","closeOnClick","action"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["icon","fas-comments",3,"message",4,"ngIf"],["position","top",3,"enabled","error","action"],[1,"addon-messages-discussion-container"],[4,"ngFor","ngForOf"],["class","ion-text-wrap addon-message addon-message-mine",4,"ngIf"],["class","footer-adjustable",4,"ngIf"],["slot","end","fill","clear",3,"click"],["name","fas-pen","slot","icon-only","aria-hidden","true"],["icon","fas-comments",3,"message"],["class","ion-text-center addon-messages-date",4,"ngIf"],[1,"ion-text-wrap","addon-message"],["class","addon-message-user",4,"ngIf"],[1,"addon-message-text"],[4,"ngIf"],["class","tail",4,"ngIf"],["slot","end","fill","clear","color","danger","class","addon-messages-delete-button",3,"click",4,"ngIf"],[1,"ion-text-center","addon-messages-date"],[1,"addon-message-user"],["slot","start",3,"user","linkProfile"],["name","fas-trash","aria-hidden","true"],[1,"ion-text-wrap"],[1,"tail"],["slot","end","fill","clear","color","danger",1,"addon-messages-delete-button",3,"click"],["name","fas-trash","slot","icon-only","aria-hidden","true"],["name","fas-undo-alt","slot","icon-only","aria-hidden","true"],[1,"ion-text-wrap","addon-message","addon-message-mine"],[1,"ion-text-center"],["name","fas-exclamation-triangle","aria-hidden","true"],["name","fas-clock","aria-hidden","true"],[1,"footer-adjustable"],["color","contrast"],[3,"sendDisabled","message","placeholder","onSubmit"]],template:function CoreCommentsViewerPage_Template(e,t){1&e&&(I.Ec(0,"ion-header"),I.Ec(1,"ion-toolbar"),I.Ec(2,"ion-buttons",0),I.zc(3,"ion-back-button",1),I.Pc(4,"translate"),I.Dc(),I.Ec(5,"ion-title"),I.Ec(6,"h1"),I.zc(7,"core-format-text",2),I.Dc(),I.Dc(),I.Ec(8,"ion-buttons",3),I.nd(9,CoreCommentsViewerPage_ion_button_9_Template,3,3,"ion-button",4),I.Ec(10,"core-context-menu"),I.Ec(11,"core-context-menu-item",5),I.Mc("action",(function CoreCommentsViewerPage_Template_core_context_menu_item_action_11_listener(){return t.refreshComments(!1)})),I.Pc(12,"translate"),I.Dc(),I.Ec(13,"core-context-menu-item",5),I.Mc("action",(function CoreCommentsViewerPage_Template_core_context_menu_item_action_13_listener(){return t.refreshComments(!0)})),I.Pc(14,"translate"),I.Dc(),I.Dc(),I.Dc(),I.Dc(),I.Dc(),I.Ec(15,"ion-content"),I.Ec(16,"ion-refresher",6),I.Mc("ionRefresh",(function CoreCommentsViewerPage_Template_ion_refresher_ionRefresh_16_listener(e){return t.refreshComments(!1,e.target)})),I.zc(17,"ion-refresher-content",7),I.Pc(18,"translate"),I.Dc(),I.Ec(19,"core-loading",8),I.nd(20,CoreCommentsViewerPage_core_empty_box_20_Template,2,3,"core-empty-box",9),I.Ec(21,"core-infinite-loading",10),I.Mc("action",(function CoreCommentsViewerPage_Template_core_infinite_loading_action_21_listener(e){return t.loadPrevious(e)})),I.Dc(),I.Ec(22,"ion-list",11),I.nd(23,CoreCommentsViewerPage_ng_container_23_Template,13,18,"ng-container",12),I.nd(24,CoreCommentsViewerPage_ion_item_24_Template,16,18,"ion-item",13),I.Dc(),I.Dc(),I.Dc(),I.nd(25,CoreCommentsViewerPage_ion_footer_25_Template,4,5,"ion-footer",14)),2&e&&(I.lc(3),I.Vc("text",I.Qc(4,25,"core.back")),I.lc(4),I.Vc("text",t.title)("contextLevel",t.contextLevel)("contextInstanceId",t.instanceId)("courseId",t.courseId),I.lc(2),I.Vc("ngIf",t.canDeleteComments),I.lc(2),I.Vc("hidden",!(t.commentsLoaded&&!t.hasOffline))("priority",100)("content",I.Qc(12,27,"core.refresh"))("iconAction",t.refreshIcon)("closeOnClick",!0),I.lc(2),I.Vc("hidden",!(t.commentsLoaded&&t.hasOffline&&t.isOnline))("priority",100)("content",I.Qc(14,29,"core.settings.synchronizenow"))("iconAction",t.syncIcon)("closeOnClick",!1),I.lc(3),I.Vc("disabled",!t.commentsLoaded),I.lc(1),I.Wc("pullingText",I.Qc(18,31,"core.pulltorefresh")),I.lc(2),I.Vc("hideUntil",t.commentsLoaded),I.lc(1),I.Vc("ngIf",!(null!=t.comments&&t.comments.length||t.offlineComment)),I.lc(1),I.Vc("enabled",t.canLoadMore)("error",t.loadMoreError),I.lc(2),I.Vc("ngForOf",t.comments),I.lc(1),I.Vc("ngIf",t.offlineComment),I.lc(1),I.Vc("ngIf",t.commentsLoaded&&t.canAddComments))},directives:[l.C,l.Ab,l.m,l.h,l.i,l.yb,x.a,D.t,y.a,V.a,E.a,l.v,l.bb,l.cb,T.a,k.a,l.P,D.s,L.a,l.l,l.D,N.a,A.a,l.I,l.O,l.W,z.a,l.A,S.a],pipes:[U.d,R.a,D.p],styles:['.ios[_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child, .ios   [_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child{padding-bottom:4px;min-height:0}ion-content[_ngcontent-%COMP%]{--content-background:var(--background-alternative);--background:var(--content-background)}ion-content[_ngcontent-%COMP%]::part(scroll){padding-bottom:0!important}.addon-messages-discussion-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:16px!important;background:var(--content-background)}.addon-messages-date[_ngcontent-%COMP%]{font-weight:400;font-size:.9rem}ion-item.addon-message[_ngcontent-%COMP%]{--message-background:var(--addon-messages-message-bg);--message-activated-background:var(--addon-messages-message-activated-bg);--message-alignment:flex-start;border:0;border-radius:var(--medium-radius);padding:0 8px;margin:8px;--background:var(--message-background);background:var(--message-background);align-self:var(--message-alignment);width:90%;max-width:var(--list-item-max-width);--min-height:var(--a11y-min-target-size);position:relative;transition:width .5s ease-in-out;overflow:visible}ion-item.addon-message[_ngcontent-%COMP%]::part(native){--inner-border-width:0px;--inner-padding-end:0px;padding:0;margin:0}ion-item.addon-message[_ngcontent-%COMP%]:hover{filter:drop-shadow(2px 2px 2px rgba(0,0,0,.3))}ion-item.addon-message[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:only-child{display:inline}ion-item.addon-message[_ngcontent-%COMP%]   .addon-message-user[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:.5rem;margin-top:0;color:var(--ion-text-color)}ion-item.addon-message[_ngcontent-%COMP%]   .addon-message-user[_ngcontent-%COMP%]   core-user-avatar[_ngcontent-%COMP%]{display:block;--core-avatar-size:var(--addon-messages-avatar-size);margin:0}ion-item.addon-message[_ngcontent-%COMP%]   .addon-message-user[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-weight:500;flex-grow:1;padding-left:.5rem;padding-right:.5rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}ion-item.addon-message[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{color:var(--addon-messages-message-note-text);font-size:var(--addon-messages-message-note-font-size);margin:0;padding:8px 0;align-self:flex-start}ion-item.addon-message[tappable][_ngcontent-%COMP%]:active{--message-background:var(--message-activated-background)}ion-item.addon-message[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0;padding:8px 0}ion-item.addon-message[_ngcontent-%COMP%]   .addon-message-text[_ngcontent-%COMP%]{display:inline-flex}ion-item.addon-message[_ngcontent-%COMP%]   .addon-message-text[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:var(--ion-text-color)}ion-item.addon-message[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{content:"";width:0;height:0;position:absolute;touch-action:none;bottom:0;border:.5rem solid transparent;border-bottom:.5rem solid var(--message-background)}ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]{--message-background:var(--addon-messages-message-mine-bg);--message-activated-background:var(--addon-messages-message-mine-activated-bg);--message-alignment:flex-end}ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{float:right;margin:2px -3px -2px 5px}[dir=rtl][_nghost-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{float:left}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{margin-left:unset;margin-right:unset;-webkit-margin-start:5px;margin-inline-start:5px;-webkit-margin-end:-3px;margin-inline-end:-3px}}ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px}ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{right:-8px;margin-right:-.5rem}[dir=rtl][_nghost-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{left:unset;right:unset;left:-8px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{margin-right:unset;-webkit-margin-end:-.5rem;margin-inline-end:-.5rem}}ion-item.addon-message.addon-message-not-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{left:-8px;margin-left:-.5rem}[dir=rtl][_nghost-%COMP%]   ion-item.addon-message.addon-message-not-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   ion-item.addon-message.addon-message-not-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   ion-item.addon-message.addon-message-not-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{left:unset;right:unset;right:-8px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){ion-item.addon-message.addon-message-not-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{margin-left:unset;-webkit-margin-start:-.5rem;margin-inline-start:-.5rem}}ion-item.addon-message[_ngcontent-%COMP%]   .addon-messages-delete-button[_ngcontent-%COMP%]{min-height:0;line-height:normal;margin-top:0;margin-bottom:0;height:var(--a11y-min-target-size)!important;align-self:flex-end}ion-item.addon-message[_ngcontent-%COMP%]   .addon-messages-delete-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.4em;line-height:normal;color:var(--danger)}ion-item.addon-message.addon-message-no-user[_ngcontent-%COMP%]{margin-top:0}'],data:{animation:[c.a.SLIDE_IN_OUT]}}),CoreCommentsViewerPage})();const j=[{path:"",component:Q}];let F=(()=>{class CoreCommentsViewerPageModule{}return CoreCommentsViewerPageModule.ɵmod=I.wc({type:CoreCommentsViewerPageModule}),CoreCommentsViewerPageModule.ɵinj=I.vc({factory:function CoreCommentsViewerPageModule_Factory(e){return new(e||CoreCommentsViewerPageModule)},imports:[[o.m.forChild(j),i.a],o.m]}),CoreCommentsViewerPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&I.kd(F,{declarations:[Q],imports:[o.m,i.a],exports:[o.m]}))}}]);