(window.webpackJsonp=window.webpackJsonp||[]).push([[57],{B1At:function(e,o,n){"use strict";n.r(o),n.d(o,"AddonModFeedbackNonRespondentsPageModule",(function(){return R}));var t=n("L3Fv"),d=n("tyNb"),a=n("mrSG"),c=n("mWdr"),s=n("pHTc"),i=n("3LXp"),r=n("bFG1"),l=n("MNPK"),p=n("96hm"),_=n("fXoL"),g=n("TEn/"),u=n("nt/U"),b=n("PgjG"),f=n("ofXK"),h=n("xpMl"),m=n("3Pt+"),M=n("FeAf"),k=n("sYmb");function AddonModFeedbackNonRespondentsPage_ion_item_15_ng_container_2_Template(e,o){1&e&&(_.Cc(0),_.pd(1),_.Pc(2,"translate"),_.Bc()),2&e&&(_.lc(1),_.qd(_.Qc(2,1,"core.groupsseparate")))}function AddonModFeedbackNonRespondentsPage_ion_item_15_ng_container_3_Template(e,o){1&e&&(_.Cc(0),_.pd(1),_.Pc(2,"translate"),_.Bc()),2&e&&(_.lc(1),_.qd(_.Qc(2,1,"core.groupsvisible")))}function AddonModFeedbackNonRespondentsPage_ion_item_15_ion_select_option_6_Template(e,o){if(1&e&&(_.Ec(0,"ion-select-option",13),_.pd(1),_.Dc()),2&e){const e=o.$implicit;_.Vc("value",e.id),_.lc(1),_.rd(" ",e.name," ")}}const _c0=function(e){return{header:e}};function AddonModFeedbackNonRespondentsPage_ion_item_15_Template(e,o){if(1&e){const e=_.Fc();_.Ec(0,"ion-item",9),_.Ec(1,"ion-label",10),_.nd(2,AddonModFeedbackNonRespondentsPage_ion_item_15_ng_container_2_Template,3,3,"ng-container",7),_.nd(3,AddonModFeedbackNonRespondentsPage_ion_item_15_ng_container_3_Template,3,3,"ng-container",7),_.Dc(),_.Ec(4,"ion-select",11),_.Mc("ngModelChange",(function AddonModFeedbackNonRespondentsPage_ion_item_15_Template_ion_select_ngModelChange_4_listener(o){_.fd(e);return _.Oc().selectedGroup=o}))("ionChange",(function AddonModFeedbackNonRespondentsPage_ion_item_15_Template_ion_select_ionChange_4_listener(){_.fd(e);const o=_.Oc();return o.loadAttempts(o.selectedGroup)})),_.Pc(5,"translate"),_.nd(6,AddonModFeedbackNonRespondentsPage_ion_item_15_ion_select_option_6_Template,2,2,"ion-select-option",12),_.Dc(),_.Dc()}if(2&e){const e=_.Oc();_.lc(2),_.Vc("ngIf",e.groupInfo.separateGroups),_.lc(1),_.Vc("ngIf",e.groupInfo.visibleGroups),_.lc(1),_.Vc("ngModel",e.selectedGroup)("interfaceOptions",_.ad(7,_c0,_.Qc(5,5,"core.group"))),_.lc(2),_.Vc("ngForOf",e.groupInfo.groups)}}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_6_Template(e,o){1&e&&(_.Ec(0,"ion-badge",20),_.pd(1),_.Pc(2,"translate"),_.Dc()),2&e&&(_.lc(1),_.rd(" ",_.Qc(2,1,"addon.mod_feedback.started")," "))}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_7_Template(e,o){1&e&&(_.Ec(0,"ion-badge",21),_.pd(1),_.Pc(2,"translate"),_.Dc()),2&e&&(_.lc(1),_.rd(" ",_.Qc(2,1,"addon.mod_feedback.not_started")," "))}function AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_Template(e,o){if(1&e&&(_.Ec(0,"ion-item",15),_.zc(1,"core-user-avatar",16),_.Ec(2,"ion-label"),_.Ec(3,"p",17),_.pd(4),_.Dc(),_.Ec(5,"p"),_.nd(6,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_6_Template,3,3,"ion-badge",18),_.nd(7,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_ion_badge_7_Template,3,3,"ion-badge",19),_.Dc(),_.Dc(),_.Dc()),2&e){const e=o.$implicit;_.lc(1),_.Vc("user",e),_.lc(3),_.qd(e.fullname),_.lc(2),_.Vc("ngIf",e.started),_.lc(1),_.Vc("ngIf",!e.started)}}function AddonModFeedbackNonRespondentsPage_ng_container_21_Template(e,o){if(1&e&&(_.Cc(0),_.nd(1,AddonModFeedbackNonRespondentsPage_ng_container_21_ion_item_1_Template,8,4,"ion-item",14),_.Bc()),2&e){const e=_.Oc();_.lc(1),_.Vc("ngForOf",e.users)}}const _c1=function(e){return{$a:e}};let P=(()=>{class AddonModFeedbackNonRespondentsPage{constructor(){this.page=0,this.users=[],this.total=0,this.canLoadMore=!1,this.loaded=!1,this.loadMoreError=!1}ngOnInit(){try{this.cmId=s.a.getRequiredRouteNumberParam("cmId"),this.courseId=s.a.getRequiredRouteNumberParam("courseId"),this.selectedGroup=s.a.getRouteNumberParam("group")||0}catch(e){return i.a.showErrorModal(e),s.a.back(),void 0}this.fetchData()}fetchData(e=!1){return Object(a.a)(this,void 0,void 0,(function*(){this.page=0,this.total=0,this.users=[];try{this.feedback=yield l.a.getFeedback(this.courseId,this.cmId),this.groupInfo=yield c.a.getActivityGroupInfo(this.cmId),this.selectedGroup=c.a.validateGroupId(this.selectedGroup,this.groupInfo),yield this.loadGroupUsers(this.selectedGroup)}catch(o){i.a.showErrorModalDefault(o,"core.course.errorgetmodule",!0),e||s.a.back()}}))}loadGroupUsers(e){return Object(a.a)(this,void 0,void 0,(function*(){this.loadMoreError=!1,void 0===e?this.page++:(this.selectedGroup=e,this.page=0,this.total=0,this.users=[],this.loaded=!1);try{const e=yield p.a.getNonRespondents(this.feedback.id,{groupId:this.selectedGroup,page:this.page,cmId:this.cmId});this.total=e.total,this.users.length<e.total&&(this.users=this.users.concat(e.users)),this.canLoadMore=this.users.length<e.total}catch(e){throw this.loadMoreError=!0,e}finally{this.loaded=!0}}))}loadAttempts(e,o){return Object(a.a)(this,void 0,void 0,(function*(){try{yield this.loadGroupUsers(e)}catch(e){i.a.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{o&&o()}}))}refreshFeedback(e){return Object(a.a)(this,void 0,void 0,(function*(){try{const o=[];o.push(c.a.invalidateActivityGroupInfo(this.cmId)),this.feedback&&o.push(l.a.invalidateNonRespondentsData(this.feedback.id)),yield r.a.ignoreErrors(Promise.all(o)),yield this.fetchData(!0)}finally{e.complete()}}))}}return AddonModFeedbackNonRespondentsPage.ɵfac=function AddonModFeedbackNonRespondentsPage_Factory(e){return new(e||AddonModFeedbackNonRespondentsPage)},AddonModFeedbackNonRespondentsPage.ɵcmp=_.sc({type:AddonModFeedbackNonRespondentsPage,selectors:[["page-addon-mod-feedback-nonrespondents"]],decls:23,vars:21,consts:[["slot","start"],[3,"text"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],[1,"ion-no-margin"],["class","ion-text-wrap core-group-selector",4,"ngIf"],[4,"ngIf"],[3,"enabled","error","action"],[1,"ion-text-wrap","core-group-selector"],["id","addon-feedback-groupslabel"],["aria-labelledby","addon-feedback-groupslabel","interface","action-sheet",3,"ngModel","interfaceOptions","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","ion-text-wrap",4,"ngFor","ngForOf"],[1,"ion-text-wrap"],["slot","start",3,"user"],[1,"item-heading"],["color","success",4,"ngIf"],["color","danger",4,"ngIf"],["color","success"],["color","danger"]],template:function AddonModFeedbackNonRespondentsPage_Template(e,o){1&e&&(_.Ec(0,"ion-header"),_.Ec(1,"ion-toolbar"),_.Ec(2,"ion-buttons",0),_.zc(3,"ion-back-button",1),_.Pc(4,"translate"),_.Dc(),_.Ec(5,"ion-title"),_.Ec(6,"h1"),_.pd(7),_.Pc(8,"translate"),_.Dc(),_.Dc(),_.Dc(),_.Dc(),_.Ec(9,"ion-content"),_.Ec(10,"ion-refresher",2),_.Mc("ionRefresh",(function AddonModFeedbackNonRespondentsPage_Template_ion_refresher_ionRefresh_10_listener(e){return o.refreshFeedback(e.target)})),_.zc(11,"ion-refresher-content",3),_.Pc(12,"translate"),_.Dc(),_.Ec(13,"core-loading",4),_.Ec(14,"ion-list",5),_.nd(15,AddonModFeedbackNonRespondentsPage_ion_item_15_Template,7,9,"ion-item",6),_.Ec(16,"ion-item-divider"),_.Ec(17,"ion-label"),_.Ec(18,"h2"),_.pd(19),_.Pc(20,"translate"),_.Dc(),_.Dc(),_.Dc(),_.nd(21,AddonModFeedbackNonRespondentsPage_ng_container_21_Template,2,1,"ng-container",7),_.Ec(22,"core-infinite-loading",8),_.Mc("action",(function AddonModFeedbackNonRespondentsPage_Template_core_infinite_loading_action_22_listener(e){return o.loadAttempts(void 0,e)})),_.Dc(),_.Dc(),_.Dc(),_.Dc()),2&e&&(_.lc(3),_.Vc("text",_.Qc(4,10,"core.back")),_.lc(4),_.qd(_.Qc(8,12,"addon.mod_feedback.responses")),_.lc(3),_.Vc("disabled",!o.loaded),_.lc(1),_.Wc("pullingText",_.Qc(12,14,"core.pulltorefresh")),_.lc(2),_.Vc("hideUntil",o.loaded),_.lc(2),_.Vc("ngIf",o.groupInfo&&(o.groupInfo.separateGroups||o.groupInfo.visibleGroups)),_.lc(4),_.qd(_.Rc(20,16,"addon.mod_feedback.non_respondents_students",_.ad(19,_c1,o.total))),_.lc(2),_.Vc("ngIf",o.total>0),_.lc(1),_.Vc("enabled",o.canLoadMore)("error",o.loadMoreError))},directives:[g.C,g.Ab,g.m,g.h,g.i,g.yb,u.a,g.v,g.bb,g.cb,b.a,g.P,f.t,g.J,g.O,h.a,g.I,g.lb,g.Ob,m.r,m.u,f.s,g.mb,M.a,g.k],pipes:[k.d],encapsulation:2}),AddonModFeedbackNonRespondentsPage})();const F=[{path:"",component:P}];let R=(()=>{class AddonModFeedbackNonRespondentsPageModule{}return AddonModFeedbackNonRespondentsPageModule.ɵmod=_.wc({type:AddonModFeedbackNonRespondentsPageModule}),AddonModFeedbackNonRespondentsPageModule.ɵinj=_.vc({factory:function AddonModFeedbackNonRespondentsPageModule_Factory(e){return new(e||AddonModFeedbackNonRespondentsPageModule)},imports:[[d.m.forChild(F),t.a],d.m]}),AddonModFeedbackNonRespondentsPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&_.kd(R,{declarations:[P],imports:[d.m,t.a],exports:[d.m]}))}}]);