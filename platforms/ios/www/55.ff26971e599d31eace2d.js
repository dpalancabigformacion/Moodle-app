(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{vNWJ:function(t,n,e){"use strict";e.r(n),e.d(n,"AddonModDataLazyModule",(function(){return tt}));var a=e("L3Fv"),o=e("tyNb"),d=e("rGK3"),i=e("WsvK"),r=e("JCPi"),c=e("MLi9"),s=e("ay5P"),g=e("KarO"),l=e("mrSG"),h=e("3Pt+"),u=e("93ts"),p=e("hSQQ"),m=e("kWmn"),_=e("TEn/"),f=e("mWdr"),M=e("pHTc"),v=e("9+EE"),P=e("3LXp"),O=e("4reR"),C=e("bFG1"),b=e("j3ag"),y=e("fjkH"),I=e("39eS"),x=e("kTL9"),E=e("6s78"),D=e("fXoL"),w=e("hMzs"),A=e("ofXK"),k=e("nt/U"),T=e("PgjG"),F=e("ACYt"),G=e("QQhE"),L=e("eiAi"),R=e("sYmb");const V=["editFormEl"];function AddonModDataEditPage_ion_button_9_Template(t,n){if(1&t){const t=D.Fc();D.Ec(0,"ion-button",8),D.Mc("click",(function AddonModDataEditPage_ion_button_9_Template_ion_button_click_0_listener(n){D.fd(t);return D.Oc().save(n)})),D.pd(1),D.Pc(2,"translate"),D.Dc()}2&t&&(D.lc(1),D.rd(" ",D.Qc(2,1,"core.save")," "))}function AddonModDataEditPage_ion_item_12_ng_container_2_Template(t,n){1&t&&(D.Cc(0),D.pd(1),D.Pc(2,"translate"),D.Bc()),2&t&&(D.lc(1),D.qd(D.Qc(2,1,"core.groupsseparate")))}function AddonModDataEditPage_ion_item_12_ng_container_3_Template(t,n){1&t&&(D.Cc(0),D.pd(1),D.Pc(2,"translate"),D.Bc()),2&t&&(D.lc(1),D.qd(D.Qc(2,1,"core.groupsvisible")))}function AddonModDataEditPage_ion_item_12_ion_select_option_6_Template(t,n){if(1&t&&(D.Ec(0,"ion-select-option",14),D.pd(1),D.Dc()),2&t){const t=n.$implicit;D.Vc("value",t.id),D.lc(1),D.rd(" ",t.name," ")}}const _c1=function(t){return{header:t}};function AddonModDataEditPage_ion_item_12_Template(t,n){if(1&t){const t=D.Fc();D.Ec(0,"ion-item",9),D.Ec(1,"ion-label",10),D.nd(2,AddonModDataEditPage_ion_item_12_ng_container_2_Template,3,3,"ng-container",11),D.nd(3,AddonModDataEditPage_ion_item_12_ng_container_3_Template,3,3,"ng-container",11),D.Dc(),D.Ec(4,"ion-select",12),D.Mc("ngModelChange",(function AddonModDataEditPage_ion_item_12_Template_ion_select_ngModelChange_4_listener(n){D.fd(t);return D.Oc().selectedGroup=n}))("ionChange",(function AddonModDataEditPage_ion_item_12_Template_ion_select_ionChange_4_listener(){D.fd(t);const n=D.Oc();return n.setGroup(n.selectedGroup)})),D.Pc(5,"translate"),D.nd(6,AddonModDataEditPage_ion_item_12_ion_select_option_6_Template,2,2,"ion-select-option",13),D.Dc(),D.Dc()}if(2&t){const t=D.Oc();D.lc(2),D.Vc("ngIf",t.groupInfo.separateGroups),D.lc(1),D.Vc("ngIf",t.groupInfo.visibleGroups),D.lc(1),D.Vc("ngModel",t.selectedGroup)("interfaceOptions",D.ad(7,_c1,D.Qc(5,5,"core.group"))),D.lc(2),D.Vc("ngForOf",t.groupInfo.groups)}}function AddonModDataEditPage_div_13_Template(t,n){if(1&t){const t=D.Fc();D.Ec(0,"div"),D.zc(1,"core-style",15),D.Ec(2,"form",16,17),D.Mc("ngSubmit",(function AddonModDataEditPage_div_13_Template_form_ngSubmit_2_listener(n){D.fd(t);return D.Oc().save(n)})),D.zc(4,"core-compile-html",18),D.Dc(),D.Dc()}if(2&t){const t=D.Oc();D.oc("addon-data-contents ",t.cssClass,""),D.lc(1),D.Xc("prefix",".",t.cssClass,""),D.Vc("css",t.database.csstemplate),D.lc(1),D.Vc("formGroup",t.editForm),D.lc(2),D.Vc("text",t.editFormRender)("jsData",t.jsData)("extraImports",t.extraImports)}}let N=(()=>{class AddonModDataEditPage{constructor(){this.fieldsArray=[],this.offline=!1,this.forceLeave=!1,this.isEditing=!1,this.originalData={},this.fields={},this.moduleId=0,this.title="",this.component=I.c.COMPONENT,this.loaded=!1,this.selectedGroup=0,this.cssClass="",this.editFormRender="",this.extraImports=[s.a],this.errors={},this.siteId=v.b.getCurrentSiteId(),this.editForm=new h.j({})}ngOnInit(){try{this.moduleId=M.a.getRequiredRouteNumberParam("cmId"),this.courseId=M.a.getRequiredRouteNumberParam("courseId"),this.title=M.a.getRouteParam("title")||"",this.entryId=M.a.getRouteNumberParam("entryId")||void 0,this.selectedGroup=M.a.getRouteNumberParam("group")||0}catch(t){return P.a.showErrorModal(t),M.a.back(),void 0}this.isEditing=void 0!==this.entryId&&this.entryId>0,this.fetchEntryData(!0)}canLeave(){return Object(l.a)(this,void 0,void 0,(function*(){if(this.forceLeave||!this.entry)return!0;const t=this.editForm.value;let n=x.a.hasEditDataChanged(t,this.fieldsArray,this.originalData);n=n||!this.isEditing&&this.initialSelectedGroup!=this.selectedGroup,n&&(yield P.a.showConfirm(b.M.instant("core.confirmcanceledit")));const e=yield x.a.getEditTmpFiles(t,this.fieldsArray,this.entry.contents);return p.a.clearTmpFiles(e),O.a.triggerFormCancelledEvent(this.formElement,this.siteId),!0}))}fetchEntryData(t=!1){var n;return Object(l.a)(this,void 0,void 0,(function*(){try{this.database=yield I.a.getDatabase(this.courseId,this.moduleId),this.title=this.database.name||this.title,this.cssClass="addon-data-entries-"+this.database.id,this.fieldsArray=yield I.a.getFields(this.database.id,{cmId:this.moduleId}),this.fields=C.a.arrayToObject(this.fieldsArray,"id");const e=yield x.a.fetchEntry(this.database,this.fieldsArray,this.entryId||0);if(this.entry=e.entry,this.originalData=C.a.clone(this.entry.contents),this.entryId&&(this.selectedGroup=this.entry.groupid),!this.isEditing){let e=!1,a=this.groupInfo;if(t&&(a=yield f.a.getActivityGroupInfo(this.database.coursemodule),a.visibleGroups&&(null===(n=a.groups)||void 0===n?void 0:n.length)&&(a.groups=a.groups.filter((t=>0!==t.id)),a.defaultGroupId=a.groups[0].id),this.selectedGroup=f.a.validateGroupId(this.selectedGroup,a),this.initialSelectedGroup=this.selectedGroup),(null==a?void 0:a.groups)&&(null==a?void 0:a.groups.length)>0)if(t){const t={};yield Promise.all(a.groups.map((n=>Object(l.a)(this,void 0,void 0,(function*(){const e=yield I.a.getDatabaseAccessInformation(this.database.id,{cmId:this.moduleId,groupId:n.id});t[n.id]=e.canaddentry}))))),a.groups=a.groups.filter((n=>!!t[n.id])),e=t[this.selectedGroup]}else e=!0;else{e=(yield I.a.getDatabaseAccessInformation(this.database.id,{cmId:this.moduleId})).canaddentry}if(this.groupInfo=a,!e)return P.a.showErrorModal("addon.mod_data.noaccess",!0),this.forceLeave=!0,M.a.back(),void 0}this.editFormRender=this.displayEditFields()}catch(t){P.a.showErrorModalDefault(t,"core.course.errorgetmodule",!0)}this.loaded=!0}))}save(t){var n,e,a;return Object(l.a)(this,void 0,void 0,(function*(){t.preventDefault(),t.stopPropagation();const o=this.editForm.value;try{let t=x.a.hasEditDataChanged(o,this.fieldsArray,(null===(n=this.entry)||void 0===n?void 0:n.contents)||{});if(t=t||!this.isEditing&&this.initialSelectedGroup!=this.selectedGroup,!t){if(this.entryId)return yield this.returnToEntryList(),void 0;throw new u.a(b.M.instant("addon.mod_data.emptyaddform"))}const d=yield P.a.showModalLoading("core.sending",!0),i=this.entryId?this.entryId:-(new Date).getTime();let r=[];try{try{r=yield x.a.getEditDataFromForm(o,this.fieldsArray,this.database.id,i,(null===(e=this.entry)||void 0===e?void 0:e.contents)||{},this.offline)}catch(t){if(this.offline||C.a.isWebServiceError(t))throw t;this.offline=!0,r=yield x.a.getEditDataFromForm(o,this.fieldsArray,this.database.id,i,(null===(a=this.entry)||void 0===a?void 0:a.contents)||{},this.offline)}if(r.length<=0)throw new u.a(b.M.instant("addon.mod_data.emptyaddform"));let t;if(t=this.isEditing?yield I.a.editEntry(this.database.id,this.entryId,this.courseId,r,this.fieldsArray,this.siteId,this.offline):yield I.a.addEntry(this.database.id,i,this.courseId,r,this.selectedGroup,this.fieldsArray,this.siteId,this.offline),this.isEditing&&"updated"in t&&t.updated||!this.isEditing&&"newentryid"in t&&t.newentryid){O.a.triggerFormSubmittedEvent(this.formElement,t.sent,this.siteId);const n=[];t.sent&&(y.b.trigger(y.b.ACTIVITY_DATA_SENT,{module:"data"}),this.isEditing&&n.push(I.a.invalidateEntryData(this.database.id,this.entryId,this.siteId)),n.push(I.a.invalidateEntriesData(this.database.id,this.siteId)));try{yield Promise.all(n),y.b.trigger(I.c.ENTRY_CHANGED,{dataId:this.database.id,entryId:this.entryId},this.siteId)}finally{this.returnToEntryList()}}else this.errors={},t.fieldnotifications&&t.fieldnotifications.forEach((t=>{const n=this.fieldsArray.find((n=>n.name==t.fieldname));n&&(this.errors[n.id]=t.notification)})),this.jsData.errors=this.errors,this.scrollToFirstError()}finally{d.dismiss()}}catch(t){P.a.showErrorModalDefault(t,"Cannot edit entry",!0)}}))}setGroup(t){return this.selectedGroup=t,this.loaded=!1,this.fetchEntryData()}displayEditFields(){var t;this.jsData={fields:this.fields,contents:C.a.clone(null===(t=this.entry)||void 0===t?void 0:t.contents)||{},form:this.editForm,database:this.database,errors:this.errors,onFieldInit:this.onFieldInit.bind(this)};let n=x.a.getTemplate(this.database,I.e.ADD,this.fieldsArray);this.fieldsArray.forEach((t=>{let e="[["+t.name+"]]";e=e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&");let a=new RegExp(e,"gi");n=n.replace(a,'<addon-mod-data-field-plugin [class.has-errors]="!!errors['+t.id+']" mode="edit"                 [field]="fields['+t.id+']" [value]="contents['+t.id+']" [form]="form" [database]="database"                 [error]="errors['+t.id+']" (onFieldInit)="onFieldInit($event)"></addon-mod-data-field-plugin>'),e="[["+t.name+"#id]]",e=e.replace(/[-[\]/{}()*+?.\\^$|]/g,"\\$&"),a=new RegExp(e,"gi"),n=n.replace(a,"field_"+t.id)}));const e=new RegExp("##tags##","gi"),a=m.a.areTagsAvailableInSite()?"<p class=\"item-dimmed\">{{ 'addon.mod_data.edittagsnotsupported' | translate }}</p>":"";return n=n.replace(e,a),n}onFieldInit(t){var n,e,a,o,d,i,r;this.originalData[t.fieldid]||(this.originalData[t.fieldid]={id:0,recordid:null!==(e=null===(n=this.entry)||void 0===n?void 0:n.id)&&void 0!==e?e:0,fieldid:t.fieldid,content:t.content,content1:null!==(a=t.content1)&&void 0!==a?a:null,content2:null!==(o=t.content2)&&void 0!==o?o:null,content3:null!==(d=t.content3)&&void 0!==d?d:null,content4:null!==(i=t.content4)&&void 0!==i?i:null,files:null!==(r=t.files)&&void 0!==r?r:[]})}returnToEntryList(){var t;return Object(l.a)(this,void 0,void 0,(function*(){const n=this.editForm.value;try{const e=yield x.a.getEditTmpFiles(n,this.fieldsArray,(null===(t=this.entry)||void 0===t?void 0:t.contents)||{});p.a.clearTmpFiles(e)}finally{this.forceLeave=!0,M.a.back()}}))}scrollToFirstError(){var t;return Object(l.a)(this,void 0,void 0,(function*(){(yield E.a.scrollToElement(this.formElement.nativeElement,".addon-data-error"))||(null===(t=this.content)||void 0===t?void 0:t.scrollToTop())}))}}return AddonModDataEditPage.ɵfac=function AddonModDataEditPage_Factory(t){return new(t||AddonModDataEditPage)},AddonModDataEditPage.ɵcmp=D.sc({type:AddonModDataEditPage,selectors:[["page-addon-mod-data-edit"]],viewQuery:function AddonModDataEditPage_Query(t,n){var e;(1&t&&(D.ud(_.v,!0),D.ud(V,!0)),2&t)&&(D.dd(e=D.Nc())&&(n.content=e.first),D.dd(e=D.Nc())&&(n.formElement=e.first))},decls:14,vars:10,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],["fill","clear",3,"click",4,"ngIf"],[3,"hideUntil"],["class","ion-text-wrap core-group-selector",4,"ngIf"],[3,"class",4,"ngIf"],["fill","clear",3,"click"],[1,"ion-text-wrap","core-group-selector"],["id","addon-data-groupslabel"],[4,"ngIf"],["aria-labelledby","addon-data-groupslabel","interface","action-sheet",3,"ngModel","interfaceOptions","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"css","prefix"],[3,"formGroup","ngSubmit"],["editFormEl",""],[3,"text","jsData","extraImports"]],template:function AddonModDataEditPage_Template(t,n){1&t&&(D.Ec(0,"ion-header"),D.Ec(1,"ion-toolbar"),D.Ec(2,"ion-buttons",0),D.zc(3,"ion-back-button",1),D.Pc(4,"translate"),D.Dc(),D.Ec(5,"ion-title"),D.Ec(6,"h1"),D.zc(7,"core-format-text",2),D.Dc(),D.Dc(),D.Ec(8,"ion-buttons",3),D.nd(9,AddonModDataEditPage_ion_button_9_Template,3,3,"ion-button",4),D.Dc(),D.Dc(),D.Dc(),D.Ec(10,"ion-content"),D.Ec(11,"core-loading",5),D.nd(12,AddonModDataEditPage_ion_item_12_Template,7,9,"ion-item",6),D.nd(13,AddonModDataEditPage_div_13_Template,5,9,"div",7),D.Dc(),D.Dc()),2&t&&(D.lc(3),D.Vc("text",D.Qc(4,8,"core.back")),D.lc(4),D.Vc("text",n.title)("contextInstanceId",n.moduleId)("courseId",n.courseId),D.lc(2),D.Vc("ngIf",n.entry),D.lc(2),D.Vc("hideUntil",n.loaded),D.lc(1),D.Vc("ngIf",n.groupInfo&&(n.groupInfo.separateGroups||n.groupInfo.visibleGroups)),D.lc(1),D.Vc("ngIf",n.database))},directives:[_.C,_.Ab,_.m,_.h,_.i,_.yb,w.a,A.t,k.a,_.v,T.a,F.a,_.l,_.I,_.O,_.lb,_.Ob,h.r,h.u,A.s,_.mb,G.a,h.H,h.s,h.k,L.a],pipes:[R.d],styles:["[_nghost-%COMP%]{--border-color:var(--stroke)}.addon-data-contents[_ngcontent-%COMP%]{overflow:visible;white-space:normal;word-break:break-word;padding:16px;background-color:var(--ion-item-background);border-bottom:1px solid var(--border-color)}.addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tbody{display:block}.addon-data-contents[_ngcontent-%COMP%]     tr{display:flex;flex-wrap:wrap;padding:0}@media (max-width:575.98px){.addon-data-contents[_ngcontent-%COMP%]     tr{flex-direction:column}}.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));margin:0;box-sizing:border-box;position:relative;flex-basis:0;flex-grow:1;width:100%;max-width:100%;min-height:auto}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px))}}@media (min-width:576px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px))}}}@media (min-width:768px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px))}}}@media (min-width:992px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px))}}}@media (min-width:1200px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px))}}}.addon-data-contents[_ngcontent-%COMP%]     address, .addon-data-contents[_ngcontent-%COMP%]     article, .addon-data-contents[_ngcontent-%COMP%]     aside, .addon-data-contents[_ngcontent-%COMP%]     blockquote, .addon-data-contents[_ngcontent-%COMP%]     canvas, .addon-data-contents[_ngcontent-%COMP%]     dd, .addon-data-contents[_ngcontent-%COMP%]     div, .addon-data-contents[_ngcontent-%COMP%]     dl, .addon-data-contents[_ngcontent-%COMP%]     dt, .addon-data-contents[_ngcontent-%COMP%]     fieldset, .addon-data-contents[_ngcontent-%COMP%]     figcaption, .addon-data-contents[_ngcontent-%COMP%]     figure, .addon-data-contents[_ngcontent-%COMP%]     footer, .addon-data-contents[_ngcontent-%COMP%]     form, .addon-data-contents[_ngcontent-%COMP%]     h1, .addon-data-contents[_ngcontent-%COMP%]     h2, .addon-data-contents[_ngcontent-%COMP%]     h3, .addon-data-contents[_ngcontent-%COMP%]     h4, .addon-data-contents[_ngcontent-%COMP%]     h5, .addon-data-contents[_ngcontent-%COMP%]     h6, .addon-data-contents[_ngcontent-%COMP%]     header, .addon-data-contents[_ngcontent-%COMP%]     li, .addon-data-contents[_ngcontent-%COMP%]     main, .addon-data-contents[_ngcontent-%COMP%]     nav, .addon-data-contents[_ngcontent-%COMP%]     noscript, .addon-data-contents[_ngcontent-%COMP%]     ol, .addon-data-contents[_ngcontent-%COMP%]     p, .addon-data-contents[_ngcontent-%COMP%]     pre, .addon-data-contents[_ngcontent-%COMP%]     section, .addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tfoot, .addon-data-contents[_ngcontent-%COMP%]     ul, .addon-data-contents[_ngcontent-%COMP%]     video{width:auto!important;height:auto!important;min-width:auto!important;min-height:auto!important;max-height:none!important}.addon-data-contents[_ngcontent-%COMP%]     hr{border-top:1px solid var(--stroke)}","[_nghost-%COMP%]{--input-border-color:var(--stroke);--input-border-width:1px;--select-border-width:0px}[_nghost-%COMP%]     table{width:100%}[_nghost-%COMP%]     td{vertical-align:top}[_nghost-%COMP%]     .addon-data-latlong{display:flex}[_nghost-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]{padding:16px;width:100%}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%], [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]{background-color:var(--ion-item-background)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input{border-bottom:var(--input-border-width) solid var(--input-border-color)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid{--input-border-width:2px}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus{--input-border-color:var(--primary)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.has-focus.ion-valid{--input-border-color:var(--success)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-input.ion-touched.ion-invalid{--input-border-color:var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor{border-bottom:var(--select-border-width) solid var(--input-border-color)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid{--select-border-width:2px}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-valid{--input-border-color:var(--success)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     core-rich-text-editor.ion-touched.ng-invalid{--input-border-color:var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select{border-bottom:var(--select-border-width) solid var(--input-border-color)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid{--select-border-width:2px}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-valid{--input-border-color:var(--success)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     ion-select.ion-touched.ion-invalid{--input-border-color:var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .has-errors ion-input.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .has-errors ion-input.ion-invalid{--input-border-width:2px;--input-border-color:var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .has-errors core-rich-text-editor.ng-invalid, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .has-errors ion-select.ion-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .has-errors core-rich-text-editor.ng-invalid, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .has-errors ion-select.ion-invalid{--select-border-width:2px;--input-border-color:var(--danger)}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required{float:right}[dir=rtl][_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required, [dir=rtl]   [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required, [dir=rtl][_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required, [dir=rtl]   [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required{float:left}[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required+ion-input, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required+ion-select, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required+ion-input, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required+ion-select{padding-right:20px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required+ion-input, [_nghost-%COMP%]   .addon-data-contents[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]     .core-mark-required+ion-select, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required+ion-input, [_nghost-%COMP%]   form[_ngcontent-%COMP%]   .addon-data-advanced-search[_ngcontent-%COMP%]     .core-mark-required+ion-select{padding-right:unset;-webkit-padding-end:20px;padding-inline-end:20px}}"]}),AddonModDataEditPage})();var j=e("1Rj0"),z=e("5pQw"),Q=e("ULAo"),S=e("vwQL"),q=e("3CSS"),U=e("fY5/"),H=e("OoUD"),W=e("3jOR");const entry_c0=function(t){return{$a:t}};function AddonModDataEntryPage_ion_card_13_Template(t,n){if(1&t&&(D.Ec(0,"ion-card",14),D.Ec(1,"ion-item"),D.zc(2,"ion-icon",15),D.Ec(3,"ion-label"),D.pd(4),D.Pc(5,"translate"),D.Dc(),D.Dc(),D.Dc()),2&t){const t=D.Oc();D.lc(4),D.qd(D.Rc(5,1,"core.hasdatatosync",D.ad(4,entry_c0,t.moduleName)))}}function AddonModDataEntryPage_ion_item_14_ng_container_2_Template(t,n){1&t&&(D.Cc(0),D.pd(1),D.Pc(2,"translate"),D.Bc()),2&t&&(D.lc(1),D.qd(D.Qc(2,1,"core.groupsvisible")))}function AddonModDataEntryPage_ion_item_14_ng_container_3_Template(t,n){1&t&&(D.Cc(0),D.pd(1),D.Pc(2,"translate"),D.Bc()),2&t&&(D.lc(1),D.qd(D.Qc(2,1,"core.groupsseparate")))}function AddonModDataEntryPage_ion_item_14_ion_select_option_6_Template(t,n){if(1&t&&(D.Ec(0,"ion-select-option",21),D.pd(1),D.Dc()),2&t){const t=n.$implicit;D.Vc("value",t.id),D.lc(1),D.rd(" ",t.name," ")}}const entry_c1=function(t){return{header:t}};function AddonModDataEntryPage_ion_item_14_Template(t,n){if(1&t){const t=D.Fc();D.Ec(0,"ion-item",16),D.Ec(1,"ion-label",17),D.nd(2,AddonModDataEntryPage_ion_item_14_ng_container_2_Template,3,3,"ng-container",18),D.nd(3,AddonModDataEntryPage_ion_item_14_ng_container_3_Template,3,3,"ng-container",18),D.Dc(),D.Ec(4,"ion-select",19),D.Mc("ngModelChange",(function AddonModDataEntryPage_ion_item_14_Template_ion_select_ngModelChange_4_listener(n){D.fd(t);return D.Oc().selectedGroup=n}))("ionChange",(function AddonModDataEntryPage_ion_item_14_Template_ion_select_ionChange_4_listener(){D.fd(t);const n=D.Oc();return n.setGroup(n.selectedGroup)})),D.Pc(5,"translate"),D.nd(6,AddonModDataEntryPage_ion_item_14_ion_select_option_6_Template,2,2,"ion-select-option",20),D.Dc(),D.Dc()}if(2&t){const t=D.Oc();D.lc(2),D.Vc("ngIf",t.groupInfo.separateGroups),D.lc(1),D.Vc("ngIf",t.groupInfo.visibleGroups),D.lc(1),D.Vc("ngModel",t.selectedGroup)("interfaceOptions",D.ad(7,entry_c1,D.Qc(5,5,"core.group"))),D.lc(2),D.Vc("ngForOf",t.groupInfo.groups)}}function AddonModDataEntryPage_div_15_Template(t,n){if(1&t){const t=D.Fc();D.Ec(0,"div"),D.zc(1,"core-style",22),D.Ec(2,"core-compile-html",23),D.Mc("compiling",(function AddonModDataEntryPage_div_15_Template_core_compile_html_compiling_2_listener(n){D.fd(t);return D.Oc().setRenderingEntry(n)})),D.Dc(),D.Dc()}if(2&t){const t=D.Oc();D.oc("addon-data-contents addon-data-entry addon-data-entries-",t.database.id,""),D.lc(1),D.Xc("prefix",".addon-data-entries-",t.database.id,""),D.Vc("css",t.database.csstemplate),D.lc(1),D.Vc("text",t.entryHtml)("jsData",t.jsData)("extraImports",t.extraImports)}}function AddonModDataEntryPage_core_rating_rate_16_Template(t,n){if(1&t){const t=D.Fc();D.Ec(0,"core-rating-rate",24),D.Mc("onLoading",(function AddonModDataEntryPage_core_rating_rate_16_Template_core_rating_rate_onLoading_0_listener(n){D.fd(t);return D.Oc().setLoadingRating(n)}))("onUpdate",(function AddonModDataEntryPage_core_rating_rate_16_Template_core_rating_rate_onUpdate_0_listener(){D.fd(t);return D.Oc().ratingUpdated()})),D.Dc()}if(2&t){const t=D.Oc();D.Vc("ratingInfo",t.ratingInfo)("instanceId",t.database.coursemodule)("itemId",t.entry.id)("itemSetId",0)("courseId",t.courseId)("aggregateMethod",t.database.assessed)("scaleId",t.database.scale)("userId",t.entry.userid)}}function AddonModDataEntryPage_core_rating_aggregate_17_Template(t,n){if(1&t&&D.zc(0,"core-rating-aggregate",25),2&t){const t=D.Oc();D.Vc("ratingInfo",t.ratingInfo)("instanceId",t.database.coursemodule)("itemId",t.entry.id)("courseId",t.courseId)("aggregateMethod",t.database.assessed)("scaleId",t.database.scale)}}function AddonModDataEntryPage_core_comments_18_Template(t,n){if(1&t){const t=D.Fc();D.Ec(0,"core-comments",26),D.Mc("onLoading",(function AddonModDataEntryPage_core_comments_18_Template_core_comments_onLoading_0_listener(n){D.fd(t);return D.Oc().setLoadingComments(n)})),D.Dc()}if(2&t){const t=D.Oc();D.Vc("instanceId",t.database.coursemodule)("itemId",t.entry.id)("courseId",t.courseId)("showItem",!0)}}function AddonModDataEntryPage_div_19_Template(t,n){if(1&t){const t=D.Fc();D.Ec(0,"div",27),D.Ec(1,"ion-row",28),D.Ec(2,"ion-col",29),D.Ec(3,"ion-button",30),D.Mc("click",(function AddonModDataEntryPage_div_19_Template_ion_button_click_3_listener(){D.fd(t);const n=D.Oc();return n.gotoEntry(n.offset-1)})),D.Pc(4,"translate"),D.zc(5,"ion-icon",31),D.Dc(),D.Dc(),D.zc(6,"ion-col",32),D.Ec(7,"ion-col",33),D.Ec(8,"ion-button",30),D.Mc("click",(function AddonModDataEntryPage_div_19_Template_ion_button_click_8_listener(){D.fd(t);const n=D.Oc();return n.gotoEntry(n.offset+1)})),D.Pc(9,"translate"),D.zc(10,"ion-icon",34),D.Dc(),D.Dc(),D.Dc(),D.Dc()}if(2&t){const t=D.Oc();D.lc(3),D.Vc("disabled",!t.hasPrevious),D.mc("aria-label",D.Qc(4,4,"core.previous")),D.lc(5),D.Vc("disabled",!t.hasNext),D.mc("aria-label",D.Qc(9,6,"core.next"))}}let $=(()=>{class AddonModDataEntryPage{constructor(t){this.cdr=t,this.fields={},this.fieldsArray=[],this.logAfterFetch=!0,this.moduleId=0,this.title="",this.moduleName="data",this.component=I.c.COMPONENT,this.entryLoaded=!1,this.renderingEntry=!1,this.loadingComments=!1,this.loadingRating=!1,this.selectedGroup=0,this.hasPrevious=!1,this.hasNext=!1,this.showComments=!1,this.entryHtml="",this.extraImports=[s.a],this.isPullingToRefresh=!1,this.commentsEnabled=!1,this.moduleName=Q.a.translateModuleName("data"),this.siteId=v.b.getCurrentSiteId(),this.syncObserver=y.b.on(S.b.AUTO_SYNCED,(t=>{var n;void 0!==t.entryId&&(t.entryId!=this.entryId&&t.offlineEntryId!=this.entryId||(null===(n=this.database)||void 0===n?void 0:n.id)!=t.dataId||(t.deleted?M.a.back():(this.entryId=t.entryId,this.entryLoaded=!1,this.fetchEntryData(!0))))}),this.siteId),this.entryChangedObserver=y.b.on(I.c.ENTRY_CHANGED,(t=>{var n;t.entryId==this.entryId&&(null===(n=this.database)||void 0===n?void 0:n.id)==t.dataId&&(t.deleted?M.a.back():(this.entryLoaded=!1,this.fetchEntryData(!0)))}),this.siteId)}ngOnInit(){return Object(l.a)(this,void 0,void 0,(function*(){try{this.moduleId=M.a.getRequiredRouteNumberParam("cmId"),this.courseId=M.a.getRequiredRouteNumberParam("courseId"),this.entryId=M.a.getRouteNumberParam("entryId")||void 0,this.title=M.a.getRouteParam("title")||"",this.selectedGroup=M.a.getRouteNumberParam("group")||0,this.offset=M.a.getRouteNumberParam("offset")}catch(t){return P.a.showErrorModal(t),M.a.back(),void 0}this.commentsEnabled=!z.a.areCommentsDisabledInSite(),yield this.fetchEntryData()}))}fetchEntryData(t=!1,n=!1){var e,a;return Object(l.a)(this,void 0,void 0,(function*(){this.isPullingToRefresh=n;try{this.database=yield I.a.getDatabase(this.courseId,this.moduleId),this.title=this.database.name||this.title,this.fieldsArray=yield I.a.getFields(this.database.id,{cmId:this.moduleId}),this.fields=C.a.arrayToObject(this.fieldsArray,"id"),yield this.setEntryFromOffset(),this.access=yield I.a.getDatabaseAccessInformation(this.database.id,{cmId:this.moduleId}),this.groupInfo=yield f.a.getActivityGroupInfo(this.database.coursemodule),this.groupInfo.visibleGroups&&(null===(e=this.groupInfo.groups)||void 0===e?void 0:e.length)&&(this.groupInfo.groups=this.groupInfo.groups.filter((t=>0!==t.id)),this.groupInfo.defaultGroupId=this.groupInfo.groups[0].id),this.selectedGroup=f.a.validateGroupId(this.selectedGroup,this.groupInfo);const t=x.a.getActions(this.database,this.access,this.entry),n=x.a.getTemplate(this.database,I.e.SINGLE,this.fieldsArray);this.entryHtml=x.a.displayShowFields(n,this.fieldsArray,this.entry,this.offset,I.d.SHOW,t),this.showComments=t.comments;const o={};o[this.entryId]=this.entry,this.jsData={fields:this.fields,entries:o,database:this.database,title:this.title,group:this.selectedGroup},this.logAfterFetch&&(this.logAfterFetch=!1,yield C.a.ignoreErrors(I.a.logView(this.database.id,this.database.name)),Q.a.storeModuleViewed(this.courseId,this.moduleId))}catch(e){if(!t)return this.refreshAllData(n);P.a.showErrorModalDefault(e,"core.course.errorgetmodule",!0)}finally{null===(a=this.content)||void 0===a?void 0:a.scrollToTop(),this.entryLoaded=!0}}))}gotoEntry(t){return Object(l.a)(this,void 0,void 0,(function*(){this.offset=t,this.entryId=void 0,this.entry=void 0,this.entryLoaded=!1,this.logAfterFetch=!0,yield this.fetchEntryData()}))}refreshAllData(t){return Object(l.a)(this,void 0,void 0,(function*(){const n=[];n.push(I.a.invalidateDatabaseData(this.courseId)),this.database&&(n.push(I.a.invalidateEntryData(this.database.id,this.entryId)),n.push(f.a.invalidateActivityGroupInfo(this.database.coursemodule)),n.push(I.a.invalidateEntriesData(this.database.id)),n.push(I.a.invalidateFieldsData(this.database.id)),this.database.comments&&this.entry&&this.entry.id>0&&this.commentsEnabled&&this.comments&&this.comments.doRefresh().catch((()=>{}))),yield Promise.all(n).finally((()=>this.fetchEntryData(!0,t)))}))}refreshDatabase(t){this.entryLoaded&&this.refreshAllData(!0).finally((()=>{null==t?void 0:t.complete()}))}setGroup(t){return Object(l.a)(this,void 0,void 0,(function*(){this.selectedGroup=t,this.offset=void 0,this.entry=void 0,this.entryId=void 0,this.entryLoaded=!1,this.logAfterFetch=!0,yield this.fetchEntryData()}))}setEntryFromOffset(){var t,n,e;return Object(l.a)(this,void 0,void 0,(function*(){if(void 0===this.offset&&void 0!==this.entryId){this.hasNext=!1,this.hasPrevious=!1;const t=yield x.a.fetchEntry(this.database,this.fieldsArray,this.entryId);return this.entry=t.entry,this.ratingInfo=t.ratinginfo,void 0}const a=I.c.PER_PAGE,o=void 0!==this.offset&&this.offset>=0?Math.floor(this.offset/a):0,d=yield x.a.fetchEntries(this.database,this.fieldsArray,{groupId:this.selectedGroup,sort:0,order:"DESC",page:o,perPage:a}),i=(d.offlineEntries||[]).concat(d.entries);let r=0;if(r=void 0===this.offset?0:this.offset>0?this.offset%a+((null===(t=d.offlineEntries)||void 0===t?void 0:t.length)||0):this.offset+((null===(n=d.offlineEntries)||void 0===n?void 0:n.length)||0),this.entry=i[r],this.entryId=this.entry.id,this.hasPrevious=o>0||r>0,r+1<i.length)this.hasNext=!0;else if(i.length<a)this.hasNext=!1;else{const t=yield I.a.getEntries(this.database.id,{groupId:this.selectedGroup,page:o+1,perPage:a});this.hasNext=(null===(e=null==t?void 0:t.entries)||void 0===e?void 0:e.length)>0}if(this.entryId>0){const t=yield I.a.getEntry(this.database.id,this.entryId,{cmId:this.moduleId});this.ratingInfo=t.ratinginfo}}))}setRenderingEntry(t){this.renderingEntry=t,this.cdr.detectChanges()}setLoadingComments(t){this.loadingComments=t,this.cdr.detectChanges()}setLoadingRating(t){this.loadingRating=t,this.cdr.detectChanges()}ratingUpdated(){I.a.invalidateEntryData(this.database.id,this.entryId)}ngOnDestroy(){var t,n;null===(t=this.syncObserver)||void 0===t?void 0:t.off(),null===(n=this.entryChangedObserver)||void 0===n||n.off()}}return AddonModDataEntryPage.ɵfac=function AddonModDataEntryPage_Factory(t){return new(t||AddonModDataEntryPage)(D.yc(D.j))},AddonModDataEntryPage.ɵcmp=D.sc({type:AddonModDataEntryPage,selectors:[["page-addon-mod-data-entry"]],viewQuery:function AddonModDataEntryPage_Query(t,n){var e;(1&t&&(D.ud(_.v,!0),D.ud(j.a,!0)),2&t)&&(D.dd(e=D.Nc())&&(n.content=e.first),D.dd(e=D.Nc())&&(n.comments=e.first))},decls:20,vars:18,consts:[["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","core-warning-card",4,"ngIf"],["class","ion-text-wrap core-group-selector",4,"ngIf"],[3,"class",4,"ngIf"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","itemSetId","courseId","aggregateMethod","scaleId","userId","onLoading","onUpdate",4,"ngIf"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","courseId","aggregateMethod","scaleId",4,"ngIf"],["contextLevel","module","component","mod_data","area","database_entry",3,"instanceId","itemId","courseId","showItem","onLoading",4,"ngIf"],["collapsible-footer","","slot","fixed","appearOnBottom","",4,"ngIf"],[1,"core-warning-card"],["name","fas-exclamation-triangle","slot","start","aria-hidden","true"],[1,"ion-text-wrap","core-group-selector"],["id","addon-data-groupslabel"],[4,"ngIf"],["aria-labelledby","addon-data-groupslabel","interface","action-sheet",3,"ngModel","interfaceOptions","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[3,"css","prefix"],[3,"text","jsData","extraImports","compiling"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","itemSetId","courseId","aggregateMethod","scaleId","userId","onLoading","onUpdate"],["contextLevel","module",3,"ratingInfo","instanceId","itemId","courseId","aggregateMethod","scaleId"],["contextLevel","module","component","mod_data","area","database_entry",3,"instanceId","itemId","courseId","showItem","onLoading"],["collapsible-footer","","slot","fixed","appearOnBottom",""],[1,"ion-justify-content-between","ion-align-items-center","ion-no-padding","ion-wrap"],["size","auto",1,"ion-text-start","ion-no-padding","core-navigation-arrow"],["fill","clear",3,"disabled","click"],["name","fas-chevron-left","slot","icon-only","aria-hidden","true"],[1,"ion-text-center"],["size","auto",1,"ion-text-end","ion-no-padding","core-navigation-arrow"],["name","fas-chevron-right","slot","icon-only","aria-hidden","true"]],template:function AddonModDataEntryPage_Template(t,n){1&t&&(D.Ec(0,"ion-header"),D.Ec(1,"ion-toolbar"),D.Ec(2,"ion-buttons",0),D.zc(3,"ion-back-button",1),D.Pc(4,"translate"),D.Dc(),D.Ec(5,"ion-title"),D.Ec(6,"h1"),D.zc(7,"core-format-text",2),D.Dc(),D.Dc(),D.Dc(),D.Dc(),D.Ec(8,"ion-content",3),D.Ec(9,"ion-refresher",4),D.Mc("ionRefresh",(function AddonModDataEntryPage_Template_ion_refresher_ionRefresh_9_listener(t){return n.refreshDatabase(t.target)})),D.zc(10,"ion-refresher-content",5),D.Pc(11,"translate"),D.Dc(),D.Ec(12,"core-loading",6),D.nd(13,AddonModDataEntryPage_ion_card_13_Template,6,6,"ion-card",7),D.nd(14,AddonModDataEntryPage_ion_item_14_Template,7,9,"ion-item",8),D.nd(15,AddonModDataEntryPage_div_15_Template,3,8,"div",9),D.nd(16,AddonModDataEntryPage_core_rating_rate_16_Template,1,8,"core-rating-rate",10),D.nd(17,AddonModDataEntryPage_core_rating_aggregate_17_Template,1,6,"core-rating-aggregate",11),D.nd(18,AddonModDataEntryPage_core_comments_18_Template,1,4,"core-comments",12),D.Dc(),D.nd(19,AddonModDataEntryPage_div_19_Template,11,8,"div",13),D.Dc()),2&t&&(D.lc(3),D.Vc("text",D.Qc(4,14,"core.back")),D.lc(4),D.Vc("text",n.title)("contextInstanceId",n.moduleId)("courseId",n.courseId),D.lc(2),D.Vc("disabled",!n.entryLoaded||!(n.isPullingToRefresh||!n.renderingEntry&&!n.loadingRating&&!n.loadingComments)),D.lc(1),D.Wc("pullingText",D.Qc(11,16,"core.pulltorefresh")),D.lc(2),D.Vc("hideUntil",n.entryLoaded&&(n.isPullingToRefresh||!n.renderingEntry&&!n.loadingRating&&!n.loadingComments)),D.lc(1),D.Vc("ngIf",n.entry&&n.entry.hasOffline),D.lc(1),D.Vc("ngIf",n.groupInfo&&(n.groupInfo.separateGroups||n.groupInfo.visibleGroups)),D.lc(1),D.Vc("ngIf",n.database&&n.entry),D.lc(1),D.Vc("ngIf",n.database&&n.entry&&n.ratingInfo&&(!n.database.approval||n.entry.approved)),D.lc(1),D.Vc("ngIf",n.database&&n.entry&&n.ratingInfo),D.lc(1),D.Vc("ngIf",n.database&&n.database.comments&&n.entry&&n.entry.id>0&&n.commentsEnabled),D.lc(1),D.Vc("ngIf",n.entryLoaded&&n.hasPrevious||n.hasNext))},directives:[_.C,_.Ab,_.m,_.h,_.i,_.yb,w.a,k.a,_.v,_.bb,_.cb,T.a,A.t,_.n,_.I,_.D,q.a,_.O,_.lb,_.Ob,h.r,h.u,A.s,_.mb,G.a,L.a,U.a,H.a,j.a,W.a,_.hb,_.u,F.a,_.l],pipes:[R.d],styles:["[_nghost-%COMP%]{--border-color:var(--stroke)}.addon-data-contents[_ngcontent-%COMP%]{overflow:visible;white-space:normal;word-break:break-word;padding:16px;background-color:var(--ion-item-background);border-bottom:1px solid var(--border-color)}.addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tbody{display:block}.addon-data-contents[_ngcontent-%COMP%]     tr{display:flex;flex-wrap:wrap;padding:0}@media (max-width:575.98px){.addon-data-contents[_ngcontent-%COMP%]     tr{flex-direction:column}}.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));margin:0;box-sizing:border-box;position:relative;flex-basis:0;flex-grow:1;width:100%;max-width:100%;min-height:auto}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-xs,var(--ion-grid-column-padding,5px))}}@media (min-width:576px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-sm,var(--ion-grid-column-padding,5px))}}}@media (min-width:768px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-md,var(--ion-grid-column-padding,5px))}}}@media (min-width:992px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-lg,var(--ion-grid-column-padding,5px))}}}@media (min-width:1200px){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px))}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){.addon-data-contents[_ngcontent-%COMP%]     td, .addon-data-contents[_ngcontent-%COMP%]     th{padding-left:unset;padding-right:unset;-webkit-padding-start:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));padding-inline-start:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));-webkit-padding-end:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px));padding-inline-end:var(--ion-grid-column-padding-xl,var(--ion-grid-column-padding,5px))}}}.addon-data-contents[_ngcontent-%COMP%]     address, .addon-data-contents[_ngcontent-%COMP%]     article, .addon-data-contents[_ngcontent-%COMP%]     aside, .addon-data-contents[_ngcontent-%COMP%]     blockquote, .addon-data-contents[_ngcontent-%COMP%]     canvas, .addon-data-contents[_ngcontent-%COMP%]     dd, .addon-data-contents[_ngcontent-%COMP%]     div, .addon-data-contents[_ngcontent-%COMP%]     dl, .addon-data-contents[_ngcontent-%COMP%]     dt, .addon-data-contents[_ngcontent-%COMP%]     fieldset, .addon-data-contents[_ngcontent-%COMP%]     figcaption, .addon-data-contents[_ngcontent-%COMP%]     figure, .addon-data-contents[_ngcontent-%COMP%]     footer, .addon-data-contents[_ngcontent-%COMP%]     form, .addon-data-contents[_ngcontent-%COMP%]     h1, .addon-data-contents[_ngcontent-%COMP%]     h2, .addon-data-contents[_ngcontent-%COMP%]     h3, .addon-data-contents[_ngcontent-%COMP%]     h4, .addon-data-contents[_ngcontent-%COMP%]     h5, .addon-data-contents[_ngcontent-%COMP%]     h6, .addon-data-contents[_ngcontent-%COMP%]     header, .addon-data-contents[_ngcontent-%COMP%]     li, .addon-data-contents[_ngcontent-%COMP%]     main, .addon-data-contents[_ngcontent-%COMP%]     nav, .addon-data-contents[_ngcontent-%COMP%]     noscript, .addon-data-contents[_ngcontent-%COMP%]     ol, .addon-data-contents[_ngcontent-%COMP%]     p, .addon-data-contents[_ngcontent-%COMP%]     pre, .addon-data-contents[_ngcontent-%COMP%]     section, .addon-data-contents[_ngcontent-%COMP%]     table, .addon-data-contents[_ngcontent-%COMP%]     tfoot, .addon-data-contents[_ngcontent-%COMP%]     ul, .addon-data-contents[_ngcontent-%COMP%]     video{width:auto!important;height:auto!important;min-width:auto!important;min-height:auto!important;max-height:none!important}.addon-data-contents[_ngcontent-%COMP%]     hr{border-top:1px solid var(--stroke)}"]}),AddonModDataEntryPage})();var J=e("ghUQ"),Y=e("DHaU"),B=e("4JiN");let X=(()=>{class AddonModDataIndexPage extends J.a{constructor(){super(...arguments),this.group=0}ngOnInit(){super.ngOnInit(),this.group=M.a.getRouteNumberParam("group")||0}}return AddonModDataIndexPage.ɵfac=function AddonModDataIndexPage_Factory(t){return K(t||AddonModDataIndexPage)},AddonModDataIndexPage.ɵcmp=D.sc({type:AddonModDataIndexPage,selectors:[["page-addon-mod-data-index"]],viewQuery:function AddonModDataIndexPage_Query(t,n){var e;(1&t&&D.ud(Y.a,!0),2&t)&&(D.dd(e=D.Nc())&&(n.activityComponent=e.first))},features:[D.ic],decls:14,vars:13,consts:[["collapsible",""],["slot","start"],[3,"text"],["contextLevel","module",3,"text","contextInstanceId","courseId"],["slot","end"],[1,"limited-width"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"module","courseId","group","dataRetrieved"]],template:function AddonModDataIndexPage_Template(t,n){1&t&&(D.Ec(0,"ion-header",0),D.Ec(1,"ion-toolbar"),D.Ec(2,"ion-buttons",1),D.zc(3,"ion-back-button",2),D.Pc(4,"translate"),D.Dc(),D.Ec(5,"ion-title"),D.Ec(6,"h1"),D.zc(7,"core-format-text",3),D.Dc(),D.Dc(),D.zc(8,"ion-buttons",4),D.Dc(),D.Dc(),D.Ec(9,"ion-content",5),D.Ec(10,"ion-refresher",6),D.Mc("ionRefresh",(function AddonModDataIndexPage_Template_ion_refresher_ionRefresh_10_listener(t){return null==n.activityComponent?null:n.activityComponent.doRefresh(t.target)})),D.zc(11,"ion-refresher-content",7),D.Pc(12,"translate"),D.Dc(),D.Ec(13,"addon-mod-data-index",8),D.Mc("dataRetrieved",(function AddonModDataIndexPage_Template_addon_mod_data_index_dataRetrieved_13_listener(t){return n.updateData(t)})),D.Dc(),D.Dc()),2&t&&(D.lc(3),D.Vc("text",D.Qc(4,9,"core.back")),D.lc(4),D.Vc("text",n.title)("contextInstanceId",n.module.id)("courseId",n.courseId),D.lc(3),D.Vc("disabled",null==n.activityComponent?null:n.activityComponent.showLoading),D.lc(1),D.Wc("pullingText",D.Qc(12,11,"core.pulltorefresh")),D.lc(2),D.Vc("module",n.module)("courseId",n.courseId)("group",n.group))},directives:[_.C,B.b,_.Ab,_.m,_.h,_.i,_.yb,w.a,k.a,_.v,_.bb,_.cb,Y.a],pipes:[R.d],encapsulation:2}),AddonModDataIndexPage})();const K=D.Gc(X),Z=[{path:":courseId/:cmId",component:X},{path:":courseId/:cmId/edit",component:N,canDeactivate:[c.a]},{path:":courseId/:cmId/edit/:entryId",component:N,canDeactivate:[c.a]},{path:":courseId/:cmId/:entryId",component:$}];let tt=(()=>{class AddonModDataLazyModule{}return AddonModDataLazyModule.ɵmod=D.wc({type:AddonModDataLazyModule}),AddonModDataLazyModule.ɵinj=D.vc({factory:function AddonModDataLazyModule_Factory(t){return new(t||AddonModDataLazyModule)},imports:[[o.m.forChild(Z),a.a,g.a,s.a,d.a,r.a,i.a]]}),AddonModDataLazyModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&D.kd(tt,{declarations:[X,$,N],imports:[o.m,a.a,g.a,s.a,d.a,r.a,i.a]}))}}]);