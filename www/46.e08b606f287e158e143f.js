(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{o7gM:function(e,s,t){"use strict";t.r(s),t.d(s,"AddonMessagesDiscussionPageModule",(function(){return Y}));var n=t("tyNb"),o=t("L3Fv"),i=t("mrSG"),a=t("TEn/"),r=t("fjkH"),c=t("9+EE"),d=t("KMk0"),l=t("nopL"),g=t("fTjU"),m=t("4pns"),h=t("3LXp"),u=t("bFG1"),_=t("vuGA"),f=t("3j9v"),M=t("nvXB"),v=t("xpMl"),p=t("kScs"),b=t("wd/R"),P=t.n(b),C=t("MUy3"),I=t("93ts"),O=t("j3ag"),D=t("pHTc"),y=t("fXoL"),w=t("ACYt"),E=t("3CSS"),A=t("nt/U"),k=t("PgjG"),x=t("ofXK"),T=t("NcPy"),S=t("hMzs"),V=t("FeAf"),L=t("sYmb");function AddonMessagesConversationInfoComponent_ion_item_15_core_format_text_7_Template(e,s){if(1&e&&y.zc(0,"core-format-text",12),2&e){const e=y.Oc(2);y.Vc("text",e.conversation.subname)("contextInstanceId",0)}}const _c0=function(e){return{$a:e}};function AddonMessagesConversationInfoComponent_ion_item_15_Template(e,s){if(1&e&&(y.Ec(0,"ion-item",9),y.Ec(1,"ion-label"),y.Ec(2,"div",10),y.zc(3,"img",11),y.Dc(),y.Ec(4,"h2"),y.zc(5,"core-format-text",12),y.Dc(),y.Ec(6,"p"),y.nd(7,AddonMessagesConversationInfoComponent_ion_item_15_core_format_text_7_Template,1,2,"core-format-text",13),y.Dc(),y.Ec(8,"p"),y.pd(9),y.Pc(10,"translate"),y.Dc(),y.Dc(),y.Dc()),2&e){const e=y.Oc();y.lc(3),y.Vc("src",e.conversation.imageurl,y.id)("alt",e.conversation.name),y.lc(2),y.Vc("text",e.conversation.name)("contextInstanceId",0),y.lc(2),y.Vc("ngIf",e.conversation.subname),y.lc(2),y.qd(y.Rc(10,6,"addon.messages.numparticipants",y.ad(9,_c0,e.conversation.membercount)))}}function AddonMessagesConversationInfoComponent_ion_item_16_ion_icon_5_Template(e,s){1&e&&(y.zc(0,"ion-icon",18),y.Pc(1,"translate")),2&e&&y.mc("aria-label",y.Qc(1,1,"addon.messages.contactblocked"))}function AddonMessagesConversationInfoComponent_ion_item_16_Template(e,s){if(1&e){const e=y.Fc();y.Ec(0,"ion-item",14),y.Mc("click",(function AddonMessagesConversationInfoComponent_ion_item_16_Template_ion_item_click_0_listener(){y.fd(e);const t=s.$implicit;return y.Oc().closeModal(t.id)})),y.zc(1,"core-user-avatar",15),y.Ec(2,"ion-label"),y.Ec(3,"p",16),y.pd(4),y.nd(5,AddonMessagesConversationInfoComponent_ion_item_16_ion_icon_5_Template,2,3,"ion-icon",17),y.Dc(),y.Dc(),y.Dc()}if(2&e){const e=s.$implicit;y.lc(1),y.Vc("user",e)("linkProfile",!1)("checkOnline",e.showonlinestatus),y.lc(3),y.rd(" ",e.fullname," "),y.lc(1),y.Vc("ngIf",e.isblocked)}}let N=(()=>{class AddonMessagesConversationInfoComponent{constructor(e){this.route=e,this.conversationId=0,this.loaded=!1,this.members=[],this.canLoadMore=!1,this.loadMoreError=!1}ngOnInit(){this.fetchData().finally((()=>{this.loaded=!0}))}fetchData(){return Object(i.a)(this,void 0,void 0,(function*(){try{const e=yield d.a.getConversation(this.conversationId,!1,!0,0,0);this.conversation=e,yield this.fetchMembers()}catch(e){h.a.showErrorModalDefault(e,"Error getting members.")}}))}fetchMembers(e){return Object(i.a)(this,void 0,void 0,(function*(){this.loadMoreError=!1;const s=e?this.members.length:0,t=yield d.a.getConversationMembers(this.conversationId,s);this.members=e?this.members.concat(t.members):t.members,this.canLoadMore=t.canLoadMore}))}loadMoreMembers(e){return Object(i.a)(this,void 0,void 0,(function*(){try{yield this.fetchMembers(!0)}catch(e){h.a.showErrorModalDefault(e,"Error getting members."),this.loadMoreError=!0}finally{e&&e()}}))}refreshData(e){return Object(i.a)(this,void 0,void 0,(function*(){const s=[];s.push(d.a.invalidateConversation(this.conversationId)),s.push(d.a.invalidateConversationMembers(this.conversationId)),yield Promise.all(s),yield this.fetchData().finally((()=>{null==e?void 0:e.complete()}))}))}closeModal(e){O.y.dismiss(e)}}return AddonMessagesConversationInfoComponent.ɵfac=function AddonMessagesConversationInfoComponent_Factory(e){return new(e||AddonMessagesConversationInfoComponent)(y.yc(n.a))},AddonMessagesConversationInfoComponent.ɵcmp=y.sc({type:AddonMessagesConversationInfoComponent,selectors:[["page-addon-messages-conversation-info"]],inputs:{conversationId:"conversationId"},decls:18,vars:15,consts:[["slot","end"],["fill","clear",3,"click"],["name","fas-times","slot","icon-only","aria-hidden","true"],["slot","fixed",3,"disabled","ionRefresh"],[3,"pullingText"],[3,"hideUntil"],["class","ion-text-center",4,"ngIf"],["class","ion-text-wrap addon-messages-conversation-item","detail","true","button","",3,"click",4,"ngFor","ngForOf"],[3,"enabled","error","action"],[1,"ion-text-center"],[1,"large-avatar"],["core-external-content","","onError","this.src='assets/img/group-avatar.svg'",1,"avatar",3,"src","alt"],["contextLevel","system",3,"text","contextInstanceId"],["contextLevel","system",3,"text","contextInstanceId",4,"ngIf"],["detail","true","button","",1,"ion-text-wrap","addon-messages-conversation-item",3,"click"],["slot","start",3,"user","linkProfile","checkOnline"],[1,"item-heading"],["name","fas-user-slash",4,"ngIf"],["name","fas-user-slash"]],template:function AddonMessagesConversationInfoComponent_Template(e,s){1&e&&(y.Ec(0,"ion-header"),y.Ec(1,"ion-toolbar"),y.Ec(2,"ion-title"),y.Ec(3,"h2"),y.pd(4),y.Pc(5,"translate"),y.Dc(),y.Dc(),y.Ec(6,"ion-buttons",0),y.Ec(7,"ion-button",1),y.Mc("click",(function AddonMessagesConversationInfoComponent_Template_ion_button_click_7_listener(){return s.closeModal()})),y.Pc(8,"translate"),y.zc(9,"ion-icon",2),y.Dc(),y.Dc(),y.Dc(),y.Dc(),y.Ec(10,"ion-content"),y.Ec(11,"ion-refresher",3),y.Mc("ionRefresh",(function AddonMessagesConversationInfoComponent_Template_ion_refresher_ionRefresh_11_listener(e){return s.refreshData(e.target)})),y.zc(12,"ion-refresher-content",4),y.Pc(13,"translate"),y.Dc(),y.Ec(14,"core-loading",5),y.nd(15,AddonMessagesConversationInfoComponent_ion_item_15_Template,11,11,"ion-item",6),y.nd(16,AddonMessagesConversationInfoComponent_ion_item_16_Template,6,5,"ion-item",7),y.Ec(17,"core-infinite-loading",8),y.Mc("action",(function AddonMessagesConversationInfoComponent_Template_core_infinite_loading_action_17_listener(e){return s.loadMoreMembers(e)})),y.Dc(),y.Dc(),y.Dc()),2&e&&(y.lc(4),y.qd(y.Qc(5,9,"addon.messages.groupinfo")),y.lc(3),y.mc("aria-label",y.Qc(8,11,"core.close")),y.lc(4),y.Vc("disabled",!s.loaded),y.lc(1),y.Wc("pullingText",y.Qc(13,13,"core.pulltorefresh")),y.lc(2),y.Vc("hideUntil",s.loaded),y.lc(1),y.Vc("ngIf",s.conversation),y.lc(1),y.Vc("ngForOf",s.members),y.lc(1),y.Vc("enabled",s.canLoadMore)("error",s.loadMoreError))},directives:[a.C,a.Ab,a.yb,a.m,w.a,a.l,a.D,E.a,A.a,a.v,a.bb,a.cb,k.a,x.t,x.s,v.a,a.I,a.O,T.a,S.a,V.a],pipes:[L.d],encapsulation:2}),AddonMessagesConversationInfoComponent})();var R=t("BaYo"),q=t("6s78"),F=t("ACV2"),U=t("fQ68"),z=t("8/N+"),j=t("iJls"),Q=t("r8G5"),B=t("yNDK"),G=t("O4u7"),$=t("uYHD");function AddonMessagesDiscussionPage_img_7_Template(e,s){if(1&e&&y.zc(0,"img",25),2&e){const e=y.Oc();y.Vc("src",e.conversationImage,y.id)("siteId",e.siteId||null)}}function AddonMessagesDiscussionPage_core_user_avatar_8_Template(e,s){if(1&e&&y.zc(0,"core-user-avatar",26),2&e){const e=y.Oc();y.Vc("user",e.otherMember)("linkProfile",!1)("checkOnline",e.otherMember.showonlinestatus)}}function AddonMessagesDiscussionPage_ion_icon_10_Template(e,s){1&e&&(y.zc(0,"ion-icon",27),y.Pc(1,"translate")),2&e&&y.mc("aria-label",y.Qc(1,1,"core.favourites"))}function AddonMessagesDiscussionPage_ion_icon_11_Template(e,s){1&e&&(y.zc(0,"ion-icon",28),y.Pc(1,"translate")),2&e&&y.mc("aria-label",y.Qc(1,1,"addon.messages.mutedconversation"))}function AddonMessagesDiscussionPage_ng_container_39_Template(e,s){1&e&&(y.Cc(0),y.Ec(1,"p",29),y.pd(2),y.Pc(3,"translate"),y.Dc(),y.Ec(4,"p",29),y.Ec(5,"i"),y.pd(6),y.Pc(7,"translate"),y.Dc(),y.Dc(),y.Bc()),2&e&&(y.lc(2),y.qd(y.Qc(3,2,"addon.messages.selfconversation")),y.lc(4),y.qd(y.Qc(7,4,"addon.messages.selfconversationdefaultmessage")))}function AddonMessagesDiscussionPage_ng_container_43_h3_1_Template(e,s){if(1&e&&(y.Ec(0,"h3",40),y.pd(1),y.Pc(2,"coreFormatDate"),y.Dc()),2&e){const e=y.Oc().$implicit;y.lc(1),y.rd(" ",y.Rc(2,1,e.timecreated,"strftimedayshort")," ")}}function AddonMessagesDiscussionPage_ng_container_43_ion_chip_2_Template(e,s){1&e&&(y.Ec(0,"ion-chip",41),y.Ec(1,"ion-label"),y.pd(2),y.Pc(3,"translate"),y.Dc(),y.zc(4,"ion-icon",42),y.Dc()),2&e&&(y.lc(2),y.qd(y.Qc(3,1,"addon.messages.newmessages")))}function AddonMessagesDiscussionPage_ng_container_43_div_5_Template(e,s){if(1&e&&(y.Ec(0,"div",43),y.zc(1,"core-user-avatar",44),y.Ec(2,"div"),y.pd(3),y.Dc(),y.Dc()),2&e){const e=y.Oc().$implicit,s=y.Oc();y.lc(1),y.Vc("user",s.members[e.useridfrom])("linkProfile",!1),y.lc(2),y.qd(s.members[e.useridfrom].fullname)}}function AddonMessagesDiscussionPage_ng_container_43_div_6_Template(e,s){if(1&e&&(y.Ec(0,"div",19),y.pd(1),y.Pc(2,"translate"),y.Dc()),2&e){const e=y.Oc().$implicit,s=y.Oc();y.lc(1),y.rd(" ",e.useridfrom==s.currentUserId?y.Qc(2,1,"addon.messages.you"):s.members[e.useridfrom].fullname," ")}}function AddonMessagesDiscussionPage_ng_container_43_ion_note_9_Template(e,s){if(1&e&&(y.Ec(0,"ion-note",7),y.pd(1),y.Pc(2,"coreFormatDate"),y.Dc()),2&e){const e=y.Oc().$implicit;y.lc(1),y.qd(y.Rc(2,1,e.timecreated,"strftimetime"))}}function AddonMessagesDiscussionPage_ng_container_43_ion_note_10_Template(e,s){1&e&&(y.Ec(0,"ion-note",7),y.zc(1,"ion-icon",45),y.Pc(2,"translate"),y.Dc()),2&e&&(y.lc(1),y.mc("aria-label",y.Qc(2,1,"core.notsent")))}function AddonMessagesDiscussionPage_ng_container_43_ion_button_11_Template(e,s){if(1&e){const e=y.Fc();y.Ec(0,"ion-button",46),y.Mc("click",(function AddonMessagesDiscussionPage_ng_container_43_ion_button_11_Template_ion_button_click_0_listener(){y.fd(e);const s=y.Oc(),t=s.$implicit,n=s.index;return y.Oc().deleteMessage(t,n)})),y.Pc(1,"translate"),y.zc(2,"ion-icon",47),y.Dc()}2&e&&(y.Vc("@coreSlideInOut","fromRight"),y.mc("aria-label",y.Qc(1,2,"addon.messages.deletemessage")))}function AddonMessagesDiscussionPage_ng_container_43_div_12_Template(e,s){1&e&&y.zc(0,"div",48)}function AddonMessagesDiscussionPage_ng_container_43_Template(e,s){if(1&e){const e=y.Fc();y.Cc(0),y.nd(1,AddonMessagesDiscussionPage_ng_container_43_h3_1_Template,3,4,"h3",30),y.nd(2,AddonMessagesDiscussionPage_ng_container_43_ion_chip_2_Template,5,3,"ion-chip",31),y.Ec(3,"ion-item",32),y.Mc("longPress",(function AddonMessagesDiscussionPage_ng_container_43_Template_ion_item_longPress_3_listener(){y.fd(e);const t=s.$implicit;return y.Oc().copyMessage(t)})),y.Ec(4,"ion-label"),y.nd(5,AddonMessagesDiscussionPage_ng_container_43_div_5_Template,4,3,"div",33),y.nd(6,AddonMessagesDiscussionPage_ng_container_43_div_6_Template,3,3,"div",34),y.Ec(7,"div",35),y.Ec(8,"core-format-text",36),y.Mc("afterRender",(function AddonMessagesDiscussionPage_ng_container_43_Template_core_format_text_afterRender_8_listener(){y.fd(e);const t=s.last,n=y.Oc();return t&&n.scrollToBottom()})),y.Dc(),y.Dc(),y.Dc(),y.nd(9,AddonMessagesDiscussionPage_ng_container_43_ion_note_9_Template,3,4,"ion-note",37),y.nd(10,AddonMessagesDiscussionPage_ng_container_43_ion_note_10_Template,3,3,"ion-note",37),y.nd(11,AddonMessagesDiscussionPage_ng_container_43_ion_button_11_Template,3,4,"ion-button",38),y.nd(12,AddonMessagesDiscussionPage_ng_container_43_div_12_Template,1,0,"div",39),y.Dc(),y.Bc()}if(2&e){const e=s.$implicit,t=y.Oc();y.lc(1),y.Vc("ngIf",e.showDate),y.lc(1),y.Vc("ngIf",t.unreadMessageFrom>0&&e.id==t.unreadMessageFrom),y.lc(1),y.qc("addon-message-mine",e.useridfrom==t.currentUserId)("addon-message-not-mine",e.useridfrom!=t.currentUserId)("addon-message-no-user",!e.showUserData),y.Vc("@coreSlideInOut",e.useridfrom==t.currentUserId?"":"fromLeft"),y.lc(2),y.Vc("ngIf",e.showUserData),y.lc(1),y.Vc("ngIf",!e.showUserData),y.lc(2),y.Vc("text",e.text)("contextInstanceId",0),y.lc(1),y.Vc("ngIf",!e.pending),y.lc(1),y.Vc("ngIf",e.pending),y.lc(1),y.Vc("ngIf",!e.sending&&t.showDelete),y.lc(1),y.Vc("ngIf",e.showTail)}}function AddonMessagesDiscussionPage_core_empty_box_44_Template(e,s){1&e&&(y.zc(0,"core-empty-box",49),y.Pc(1,"translate")),2&e&&y.Vc("message",y.Qc(1,1,"addon.messages.nomessagesfound"))}function AddonMessagesDiscussionPage_ion_fab_45_Template(e,s){if(1&e){const e=y.Fc();y.Ec(0,"ion-fab",50),y.Ec(1,"ion-fab-button",51),y.Mc("click",(function AddonMessagesDiscussionPage_ion_fab_45_Template_ion_fab_button_click_1_listener(){y.fd(e);return y.Oc().scrollToFirstUnreadMessage()})),y.Pc(2,"translate"),y.zc(3,"ion-icon",42),y.Ec(4,"span",19),y.pd(5),y.Pc(6,"translate"),y.Dc(),y.Dc(),y.Ec(7,"ion-badge",52),y.pd(8),y.Dc(),y.Dc()}if(2&e){const e=y.Oc();y.lc(1),y.mc("aria-label",y.Qc(2,3,"addon.messages.newmessages")),y.lc(4),y.qd(y.Qc(6,5,"addon.messages.newmessages")),y.lc(3),y.qd(e.newMessages)}}function AddonMessagesDiscussionPage_ion_footer_46_p_2_Template(e,s){1&e&&(y.Ec(0,"p",58),y.pd(1),y.Pc(2,"translate"),y.Dc()),2&e&&(y.lc(1),y.rd(" ",y.Qc(2,1,"addon.messages.unabletomessage")," "))}function AddonMessagesDiscussionPage_ion_footer_46_div_3_Template(e,s){if(1&e){const e=y.Fc();y.Ec(0,"div",59),y.Ec(1,"p",29),y.pd(2),y.Pc(3,"translate"),y.Dc(),y.Ec(4,"ion-button",60),y.Mc("click",(function AddonMessagesDiscussionPage_ion_footer_46_div_3_Template_ion_button_click_4_listener(){y.fd(e);return y.Oc(2).unblockUser()})),y.pd(5),y.Pc(6,"translate"),y.Dc(),y.Dc()}2&e&&(y.lc(2),y.qd(y.Qc(3,2,"addon.messages.youhaveblockeduser")),y.lc(3),y.rd(" ",y.Qc(6,4,"addon.messages.unblockuser")," "))}const discussion_page_c0=function(e){return{$a:e}};function AddonMessagesDiscussionPage_ion_footer_46_div_4_Template(e,s){if(1&e){const e=y.Fc();y.Ec(0,"div",59),y.Ec(1,"p",29),y.Ec(2,"strong"),y.pd(3),y.Pc(4,"translate"),y.Dc(),y.Dc(),y.Ec(5,"p",29),y.pd(6),y.Pc(7,"translate"),y.Dc(),y.Ec(8,"ion-button",60),y.Mc("click",(function AddonMessagesDiscussionPage_ion_footer_46_div_4_Template_ion_button_click_8_listener(){y.fd(e);return y.Oc(2).createContactRequest()})),y.pd(9),y.Pc(10,"translate"),y.Dc(),y.Dc()}if(2&e){const e=y.Oc(2);y.lc(3),y.qd(y.Rc(4,3,"addon.messages.isnotinyourcontacts",y.ad(11,discussion_page_c0,e.otherMember.fullname))),y.lc(3),y.qd(y.Rc(7,6,"addon.messages.requirecontacttomessage",y.ad(13,discussion_page_c0,e.otherMember.fullname))),y.lc(3),y.rd(" ",y.Qc(10,9,"addon.messages.sendcontactrequest")," ")}}function AddonMessagesDiscussionPage_ion_footer_46_div_5_Template(e,s){if(1&e){const e=y.Fc();y.Ec(0,"div",59),y.Ec(1,"p",29),y.pd(2),y.Pc(3,"translate"),y.Dc(),y.Ec(4,"ion-button",60),y.Mc("click",(function AddonMessagesDiscussionPage_ion_footer_46_div_5_Template_ion_button_click_4_listener(){y.fd(e);return y.Oc(2).confirmContactRequest()})),y.pd(5),y.Pc(6,"translate"),y.Dc(),y.Ec(7,"ion-button",61),y.Mc("click",(function AddonMessagesDiscussionPage_ion_footer_46_div_5_Template_ion_button_click_7_listener(){y.fd(e);return y.Oc(2).declineContactRequest()})),y.pd(8),y.Pc(9,"translate"),y.Dc(),y.Dc()}if(2&e){const e=y.Oc(2);y.lc(2),y.qd(y.Rc(3,3,"addon.messages.userwouldliketocontactyou",y.ad(10,discussion_page_c0,e.otherMember.fullname))),y.lc(3),y.rd(" ",y.Qc(6,6,"addon.messages.acceptandaddcontact")," "),y.lc(3),y.rd(" ",y.Qc(9,8,"addon.messages.decline")," ")}}function AddonMessagesDiscussionPage_ion_footer_46_div_6_p_5_Template(e,s){if(1&e&&(y.Ec(0,"p",29),y.pd(1),y.Pc(2,"translate"),y.Dc()),2&e){const e=y.Oc(3);y.lc(1),y.rd(" ",y.Rc(2,1,"addon.messages.yourcontactrequestpending",y.ad(4,discussion_page_c0,e.otherMember.fullname))," ")}}function AddonMessagesDiscussionPage_ion_footer_46_div_6_Template(e,s){if(1&e&&(y.Ec(0,"div",59),y.Ec(1,"p",29),y.Ec(2,"strong"),y.pd(3),y.Pc(4,"translate"),y.Dc(),y.Dc(),y.nd(5,AddonMessagesDiscussionPage_ion_footer_46_div_6_p_5_Template,3,6,"p",62),y.Dc()),2&e){const e=y.Oc(2);y.lc(3),y.qd(y.Qc(4,2,"addon.messages.contactrequestsent")),y.lc(2),y.Vc("ngIf",e.otherMember)}}function AddonMessagesDiscussionPage_ion_footer_46_core_send_message_form_7_Template(e,s){if(1&e){const e=y.Fc();y.Ec(0,"core-send-message-form",63),y.Mc("onSubmit",(function AddonMessagesDiscussionPage_ion_footer_46_core_send_message_form_7_Template_core_send_message_form_onSubmit_0_listener(s){y.fd(e);return y.Oc(2).sendMessage(s)})),y.Pc(1,"translate"),y.Dc()}if(2&e){const e=y.Oc(2);y.Vc("showKeyboard",e.showKeyboard)("placeholder",y.Qc(1,2,"addon.messages.newmessage"))}}function AddonMessagesDiscussionPage_ion_footer_46_Template(e,s){if(1&e&&(y.Ec(0,"ion-footer",53),y.Ec(1,"ion-toolbar",54),y.nd(2,AddonMessagesDiscussionPage_ion_footer_46_p_2_Template,3,3,"p",55),y.nd(3,AddonMessagesDiscussionPage_ion_footer_46_div_3_Template,7,6,"div",56),y.nd(4,AddonMessagesDiscussionPage_ion_footer_46_div_4_Template,11,15,"div",56),y.nd(5,AddonMessagesDiscussionPage_ion_footer_46_div_5_Template,10,12,"div",56),y.nd(6,AddonMessagesDiscussionPage_ion_footer_46_div_6_Template,6,4,"div",56),y.nd(7,AddonMessagesDiscussionPage_ion_footer_46_core_send_message_form_7_Template,2,4,"core-send-message-form",57),y.Dc(),y.Dc()),2&e){const e=y.Oc();y.lc(1),y.Vc("color","message"==e.footerType?"contrast":"light"),y.lc(1),y.Vc("ngIf","unable"==e.footerType),y.lc(1),y.Vc("ngIf","blocked"==e.footerType),y.lc(1),y.Vc("ngIf","requiresContact"==e.footerType&&e.otherMember),y.lc(1),y.Vc("ngIf","requestReceived"==e.footerType&&e.otherMember),y.lc(1),y.Vc("ngIf","requestSent"==e.footerType||"message"==e.footerType&&e.requestContactSent),y.lc(1),y.Vc("ngIf","message"==e.footerType)}}let K=(()=>{class AddonMessagesDiscussionPage{constructor(e,s){this.route=e,this.elementRef=s,this.fetching=!1,this.messagesBeingSent=0,this.pagesLoaded=1,this.lastMessage={text:"",timecreated:0},this.keepMessageMap={},this.oldContentHeight=0,this.scrollBottom=!0,this.viewDestroyed=!1,this.showLoadingModal=!1,this.showInfo=!1,this.loaded=!1,this.showKeyboard=!1,this.canLoadMore=!1,this.loadMoreError=!1,this.messages=[],this.showDelete=!1,this.canDelete=!1,this.isGroup=!1,this.members={},this.favouriteIcon="fa-star",this.deleteIcon="fas-trash",this.blockIcon="fas-user-lock",this.addRemoveIcon="fas-user-plus",this.muteIcon="fas-bell-slash",this.favouriteIconSlash=!1,this.muteEnabled=!1,this.footerType="unable",this.requestContactSent=!1,this.requestContactReceived=!1,this.isSelf=!1,this.newMessages=0,this.unreadMessageFrom=0,this.initialized=!1,this.hostElement=s.nativeElement,this.siteId=c.b.getCurrentSiteId(),this.currentUserId=c.b.getCurrentSiteUserId(),this.groupMessagingEnabled=d.a.isGroupMessagingEnabled(),this.muteEnabled=d.a.isMuteConversationEnabled(),this.logger=f.a.getInstance("AddonMessagesDiscussionPage"),this.syncObserver=r.b.on(g.b.AUTO_SYNCED,(e=>{(e.userId&&e.userId==this.userId||e.conversationId&&e.conversationId==this.conversationId)&&(this.fetchMessages(),e.warnings&&e.warnings[0]&&h.a.showErrorModal(e.warnings[0]))}),this.siteId),this.memberInfoObserver=r.b.on(d.b.MEMBER_INFO_CHANGED_EVENT,(e=>{e.userId&&(this.members[e.userId]||this.otherMember&&e.userId==this.otherMember.id)&&this.fetchData()}),this.siteId)}ngOnInit(){return Object(i.a)(this,void 0,void 0,(function*(){this.route.queryParams.subscribe((e=>Object(i.a)(this,void 0,void 0,(function*(){const s=this.conversationId,t=this.userId;let n=!1;this.conversationId=D.a.getRouteNumberParam("conversationId",{params:e})||void 0,this.userId=D.a.getRouteNumberParam("userId",{params:e})||void 0,this.showInfo=!e.hideInfo,s==this.conversationId&&t==this.userId||(this.loaded=!1,this.initialized=!1,n=!0),this.showKeyboard=D.a.getRouteBooleanParam("showKeyboard",{params:e})||!1,yield this.fetchData(),this.scrollToBottom(n)}))))}))}ngAfterViewInit(){var e;return Object(i.a)(this,void 0,void 0,(function*(){this.scrollElement=yield null===(e=this.content)||void 0===e?void 0:e.getScrollElement()}))}addMessage(e,s=!0){e.hash=p.Md5.hashAsciiStr(String(("id"in e?e.id:"")||e.text||""))+"#"+e.timecreated+"#"+e.useridfrom;let t=!1;return void 0===this.keepMessageMap[e.hash]&&(this.messages.push(e),t=e.useridfrom!=this.currentUserId),this.keepMessageMap[e.hash]=s,t}removeMessage(e){if(this.keepMessageMap[e])return this.keepMessageMap[e]=!1,void 0;delete this.keepMessageMap[e];const s=this.messages.findIndex((s=>s.hash==e));s>=0&&this.messages.splice(s,1)}fetchData(){return Object(i.a)(this,void 0,void 0,(function*(){let e;this.showLoadingModal&&(e=yield h.a.showModalLoading()),!this.groupMessagingEnabled&&this.userId&&m.a.getProfile(this.userId,void 0,!0).then((e=>{this.title||(this.title=e.fullname),this.conversationImage=e.profileimageurl,this.members[e.id]=e})).catch((()=>{}));try{const e=yield g.a.syncDiscussion(this.conversationId,this.userId);e.warnings&&e.warnings[0]&&h.a.showErrorModal(e.warnings[0])}catch(e){}try{const s=[];if(this.groupMessagingEnabled){const e=yield this.getConversation(this.conversationId,this.userId);e&&s.push(this.fetchMessages()),this.userId?s.push(d.a.invalidateMemberInfo(this.userId).then((()=>Object(i.a)(this,void 0,void 0,(function*(){this.otherMember=yield d.a.getMemberInfo(this.userId),!e&&this.otherMember&&(this.conversationImage=this.otherMember.profileimageurl,this.title=this.otherMember.fullname),this.blockIcon=this.otherMember.isblocked?"fas-user-check":"fas-user-lock"}))))):this.otherMember=void 0}else this.userId&&s.push(m.a.getProfile(this.userId).then((e=>Object(i.a)(this,void 0,void 0,(function*(){this.otherMember={id:e.id,fullname:e.fullname,profileurl:"",profileimageurl:e.profileimageurl||"",profileimageurlsmall:e.profileimageurlsmall||"",isonline:!1,showonlinestatus:!1,isblocked:!1,iscontact:!1,isdeleted:!1,canmessageevenifblocked:!0,canmessage:!0,requirescontact:!1},this.otherMember.isblocked=yield d.a.isBlocked(this.userId),this.otherMember.iscontact=yield d.a.isContact(this.userId),this.blockIcon=this.otherMember.isblocked?"fas-user-check":"fas-user-lock"}))))),s.push(this.fetchMessages().then((()=>{if(!this.title&&this.messages.length){const e=this.messages[0];"usertofullname"in e&&(this.title=e.useridto!=this.currentUserId?e.usertofullname||"":e.userfromfullname||"")}})));yield Promise.all(s)}catch(e){h.a.showErrorModalDefault(e,"addon.messages.errorwhileretrievingmessages",!0)}finally{this.checkCanDelete(),this.loaded=!0,this.setPolling(),this.setContactRequestInfo(),this.setFooterType(),e&&e.dismiss()}}))}ionViewDidEnter(){this.setPolling()}ionViewWillLeave(){this.unsetPolling()}fetchMessages(e=!0){return Object(i.a)(this,void 0,void 0,(function*(){if(this.loadMoreError=!1,!(this.messagesBeingSent>0||this.fetching)){if(this.groupMessagingEnabled&&!this.conversationId)throw new I.a("No enough data provided to fetch messages");if(this.conversationId)this.logger.debug(`Polling new messages for conversation '${this.conversationId}'`);else{if(!this.userId)throw new I.a("No enough data provided to fetch messages");this.logger.debug(`Polling new messages for discussion with user '${this.userId}'`)}this.fetching=!0;try{yield g.a.waitForSyncConversation(this.conversationId,this.userId);let s=[];this.groupMessagingEnabled?(yield d.a.invalidateConversationMessages(this.conversationId),s=yield this.getConversationMessages(this.pagesLoaded)):(yield d.a.invalidateDiscussionCache(this.userId),s=yield this.getDiscussionMessages(this.pagesLoaded)),this.loadMessages(s,e)}finally{this.fetching=!1}}}))}loadMessages(e,s=!0){if(this.viewDestroyed)return;if(this.scrollBottom=q.a.scrollIsBottom(this.scrollElement,5),this.messagesBeingSent>0)return;const t=e.reduce(((e,s)=>e+(this.addMessage(s)?1:0)),0);s&&this.setNewMessagesBadge(this.newMessages+t);for(const e in this.keepMessageMap)this.removeMessage(e);d.a.sortMessages(this.messages),this.messages.forEach(((e,s)=>{e.showDate=this.showDate(e,this.messages[s-1]),e.showUserData=this.showUserData(e,this.messages[s-1]),e.showTail=this.showTail(e,this.messages[s+1])}));const n=this.messages[this.messages.length-1],o=this.groupMessagingEnabled&&n&&n.useridfrom!=this.currentUserId&&""!=this.lastMessage.text&&(n.text!==this.lastMessage.text||n.timecreated!==this.lastMessage.timecreated);this.notifyNewMessage(),this.markMessagesAsRead(o)}setNewMessagesBadge(e){0==this.newMessages&&e>0&&this.scrollFunction(),this.newMessages=e}scrollFunction(){var e;if(0==this.newMessages)return;if(q.a.scrollIsBottom(this.scrollElement,40))return this.setNewMessagesBadge(0),void 0;const s=null===(e=this.scrollElement)||void 0===e?void 0:e.getBoundingClientRect(),t=s&&s.bottom||0;if(0==t)return;const n=Array.from(this.hostElement.querySelectorAll(".addon-message-not-mine")).slice(-this.newMessages).reverse().findIndex((e=>{const s=e.getBoundingClientRect();return!!s&&s.bottom<=t}));n>0&&n<this.newMessages&&this.setNewMessagesBadge(n)}getConversation(e,s){return Object(i.a)(this,void 0,void 0,(function*(){let t;if(!e&&s)try{t=s==this.currentUserId&&d.a.isSelfConversationEnabled()?yield d.a.getSelfConversation():yield d.a.getConversationBetweenUsers(s,void 0,!0),e=t.id}catch(e){this.isSelf=s==this.currentUserId;const t=yield l.a.getMessages(s);if(t&&t.length)t.forEach((e=>{e.pending=!0,e.text=e.smallmessage})),this.loadMessages(t);else if("errorconversationdoesnotexist"!=e.errorcode)throw e;return!1}yield d.a.invalidateConversation(e);try{this.conversation=yield d.a.getConversation(e,void 0,!0)}catch(e){if(!t)throw e;this.conversation=t}return!!this.conversation&&(this.conversationId=this.conversation.id,this.title=this.conversation.name,this.conversationImage=this.conversation.imageurl,this.isGroup=this.conversation.type==d.b.MESSAGE_CONVERSATION_TYPE_GROUP,this.favouriteIcon="fas-star",this.favouriteIconSlash=this.conversation.isfavourite,this.muteIcon=this.conversation.ismuted?"fas-bell":"fas-bell-slash",this.isGroup||(this.userId=this.conversation.userid),this.isSelf=this.conversation.type==d.b.MESSAGE_CONVERSATION_TYPE_SELF,!0)}))}getConversationMessages(e,s=0){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.conversationId)return[];const t=s>0,n=yield d.a.getConversationMessages(this.conversationId,{excludePending:t,limitFrom:s});e--,n.members&&n.members.forEach((e=>{this.members[e.id]=e}));const o=n.messages;if(e>0&&n.canLoadMore){s+=d.b.LIMIT_MESSAGES;const t=yield this.getConversationMessages(e,s);return o.concat(t)}return this.canLoadMore=!!n.canLoadMore,o}))}getDiscussionMessages(e,s=0,t=0,n=0,o=0){return Object(i.a)(this,void 0,void 0,(function*(){const i=s>0||t>0||n>0||o>0,a=yield d.a.getDiscussion(this.userId,i,s,t,n,o);if(--e>0&&a.canLoadMore){a.messages.forEach((e=>{!e.pending&&"read"in e&&(e.useridfrom==this.userId?e.read?t++:s++:e.read?o++:n++)}));const i=yield this.getDiscussionMessages(e,s,t,n,o);return a.messages.concat(i)}return this.canLoadMore=a.canLoadMore,a.messages}))}markMessagesAsRead(e){var s,t;return Object(i.a)(this,void 0,void 0,(function*(){let n=!1,o=!1;o=!!e||(this.groupMessagingEnabled?!!((null===(s=this.conversation)||void 0===s?void 0:s.unreadcount)&&(null===(t=this.conversation)||void 0===t?void 0:t.unreadcount)>0&&this.conversationId&&this.conversationId>0):this.messages.some((e=>e.useridfrom!=this.currentUserId&&"read"in e&&!e.read))),o&&(this.setUnreadLabelPosition(),this.groupMessagingEnabled?yield d.a.markAllConversationMessagesRead(this.conversationId):(yield d.a.markAllMessagesRead(this.userId),this.messages.forEach((e=>{"read"in e&&(e.read=!0)}))),n=!0),n&&r.b.trigger(d.b.READ_CHANGED_EVENT,{conversationId:this.conversationId,userId:this.userId},this.siteId)}))}notifyNewMessage(){var e,s;const t=this.messages[this.messages.length-1];let n=!1;if(t?t.text===this.lastMessage.text&&t.timecreated===this.lastMessage.timecreated||(this.lastMessage={text:t.text||"",timecreated:t.timecreated},n=!0):(this.lastMessage={text:"",timecreated:0},n=!0),n){r.b.trigger(d.b.NEW_MESSAGE_EVENT,{conversationId:this.conversationId,userId:this.userId,message:this.lastMessage.text,timecreated:this.lastMessage.timecreated,isfavourite:!!(null===(e=this.conversation)||void 0===e?void 0:e.isfavourite),type:null===(s=this.conversation)||void 0===s?void 0:s.type},this.siteId);this.canDelete!=(t&&"id"in t&&t.id&&1==this.messages.length||this.messages.length>1)&&this.checkCanDelete()}}setUnreadLabelPosition(){var e,s;if(0==this.unreadMessageFrom){if(this.groupMessagingEnabled){if(this.conversation&&(null===(e=this.conversation)||void 0===e?void 0:e.unreadcount)&&(null===(s=this.conversation)||void 0===s?void 0:s.unreadcount)>0&&this.messages){let e=0;for(let s=this.messages.length-1;s>=0;s--){const t=this.messages[s];if(!t.pending&&t.useridfrom!=this.currentUserId&&"id"in t&&(e++,e==this.conversation.unreadcount)){this.unreadMessageFrom=Number(t.id);break}}}}else{let e=!1;for(const s in this.messages){const t=this.messages[s];if(t.useridfrom!=this.currentUserId&&"read"in t){if(!t.read&&e){this.unreadMessageFrom=Number(t.id);break}e=!!t.read}}}0==this.unreadMessageFrom&&(this.unreadMessageFrom=-1)}}checkCanDelete(){const e=this.messages[0];this.canDelete=e&&!e.sending}hideUnreadLabel(){this.unreadMessageFrom>0&&(this.unreadMessageFrom=-1)}waitForFetch(){if(!this.fetching)return Promise.resolve();const e=u.a.promiseDefer();return setTimeout((()=>this.waitForFetch().finally((()=>{e.resolve()}))),400),e.promise}setPolling(){this.groupMessagingEnabled&&!this.conversationId||this.polling||(this.polling=window.setInterval((()=>{this.fetchMessages().catch((()=>{}))}),d.b.POLL_INTERVAL))}unsetPolling(){this.polling&&(this.logger.debug(`Cancelling polling for conversation with user '${this.userId}'`),clearInterval(this.polling),this.polling=void 0)}copyMessage(e){u.a.copyToClipboard(_.a.decodeHTMLEntities("smallmessage"in e?e.smallmessage||e.text||"":e.text||""))}deleteMessage(e,s){return Object(i.a)(this,void 0,void 0,(function*(){const t=this.conversation&&this.conversation.candeletemessagesforallusers,n=e.pending||t||this.isSelf?"core.areyousure":"addon.messages.deletemessageconfirmation",o={};t&&!e.pending&&(o.inputs=[{type:"checkbox",name:"deleteforall",checked:!1,value:!0,label:O.M.instant("addon.messages.deleteforeveryone")}]);try{const t=yield h.a.showConfirm(O.M.instant(n),void 0,void 0,void 0,o),i=yield h.a.showModalLoading("core.deleting",!0);try{yield d.a.deleteMessage(e,t&&t[0]),this.messages.splice(s,1),this.removeMessage(e.hash),this.notifyNewMessage(),this.fetchMessages()}finally{i.dismiss()}}catch(e){h.a.showErrorModalDefault(e,"addon.messages.errordeletemessage",!0)}}))}loadPrevious(e){var s,t,n,o;return Object(i.a)(this,void 0,void 0,(function*(){if(!this.initialized)return e&&e(),void 0;let i=(null===(s=this.infinite)||void 0===s?void 0:s.hostElement.getBoundingClientRect().height)||0;const a=(null===(t=this.scrollElement)||void 0===t?void 0:t.scrollHeight)||0;try{yield this.waitForFetch()}finally{this.pagesLoaded++;try{yield this.fetchMessages(!1);const s=a-((null===(n=this.scrollElement)||void 0===n?void 0:n.scrollTop)||0),t=(null===(o=this.infinite)||void 0===o?void 0:o.hostElement.getBoundingClientRect().height)||0;this.canLoadMore&&i&&this.infinite?i-=t:this.canLoadMore||(i=i||t),this.keepScroll(a,s,i)}catch(e){this.loadMoreError=!0,this.pagesLoaded--,h.a.showErrorModalDefault(e,"addon.messages.errorwhileretrievingmessages",!0)}finally{e&&e()}}}))}keepScroll(e,s,t,n=0){setTimeout((()=>{var o;if(((null===(o=this.scrollElement)||void 0===o?void 0:o.scrollHeight)||0)==e)return n<=10&&this.keepScroll(e,s,t,n+1),void 0;setTimeout((()=>{var e;const n=(null===(e=this.scrollElement)||void 0===e?void 0:e.scrollHeight)||0;this.content.scrollToPoint(0,n-s+t,0)}),30)}),30)}scrollToBottom(e=!1){return Object(i.a)(this,void 0,void 0,(function*(){(this.scrollBottom||e)&&(this.scrollBottom=!1,this.setNewMessagesBadge(0),yield u.a.nextTicks(5),!this.viewDestroyed&&this.content&&this.content.scrollToBottom(0),e&&(this.initialized=!0))}))}scrollToFirstUnreadMessage(){if(this.newMessages>0){const e=Array.from(this.hostElement.querySelectorAll(".addon-message-not-mine"));q.a.scrollToElement(e[e.length-this.newMessages])}}sendMessage(e){return Object(i.a)(this,void 0,void 0,(function*(){this.hideUnreadLabel(),this.showDelete=!1,this.scrollBottom=!0,this.setNewMessagesBadge(0);const s={id:-1,pending:!0,sending:!0,useridfrom:this.currentUserId,smallmessage:e,text:e,timecreated:(new Date).getTime()};s.showDate=this.showDate(s,this.messages[this.messages.length-1]),this.addMessage(s,!1),this.messagesBeingSent++;try{yield this.waitForFetch()}finally{try{let t;t=this.conversationId?yield d.a.sendMessageToConversation(this.conversation,e):yield d.a.sendMessage(this.userId,e),this.messagesBeingSent--;let n=!1;if(t.sent)try{if(!this.conversationId&&t.message&&"conversationid"in t.message){yield this.getConversation(t.message.conversationid,this.userId);try{yield this.fetchMessages()}finally{this.setPolling()}}else yield this.fetchMessages()}catch(e){n=!0}!n&&t.sent||(s.sending=!1,t.sent?s.pending=!1:t.message&&(s.timecreated=t.message.timecreated||0),this.notifyNewMessage())}catch(e){this.messagesBeingSent--,M.a.closeKeyboard(),h.a.showErrorModalDefault(e,"addon.messages.messagenotsent",!0),this.removeMessage(s.hash)}}}))}showDate(e,s){return!s||!P()(e.timecreated).isSame(s.timecreated,"day")}showUserData(e,s){return this.isGroup&&e.useridfrom!=this.currentUserId&&this.members[e.useridfrom||0]&&(!s||s.useridfrom!=e.useridfrom||!!e.showDate)}showTail(e,s){return!s||s.useridfrom!=e.useridfrom||!!s.showDate}viewInfo(){return Object(i.a)(this,void 0,void 0,(function*(){if(this.isGroup){const e=yield h.a.openSideModal({component:N,componentProps:{conversationId:this.conversationId}});if(void 0!==e){D.a.isCurrentPathInTablet("**/messages/**/discussion")?r.b.trigger(d.b.OPEN_CONVERSATION_EVENT,{userId:e},this.siteId):D.a.navigateToSitePath("/messages/discussion",{params:{userId:e}})}}else D.a.navigateToSitePath("/user/profile",{params:{userId:this.userId}})}))}changeFavourite(e){return Object(i.a)(this,void 0,void 0,(function*(){if(this.conversation){this.favouriteIcon=R.a.ICON_LOADING;try{yield d.a.setFavouriteConversation(this.conversation.id,!this.conversation.isfavourite),this.conversation.isfavourite=!this.conversation.isfavourite,d.a.getConversation(this.conversation.id,void 0,!0),r.b.trigger(d.b.UPDATE_CONVERSATION_LIST_EVENT,{conversationId:this.conversation.id,action:"favourite",value:this.conversation.isfavourite},this.siteId)}catch(e){h.a.showErrorModalDefault(e,"Error changing favourite state.")}finally{this.favouriteIcon="fas-star",this.favouriteIconSlash=this.conversation.isfavourite,e&&e()}}}))}changeMute(e){return Object(i.a)(this,void 0,void 0,(function*(){if(this.conversation){this.muteIcon=R.a.ICON_LOADING;try{yield d.a.muteConversation(this.conversation.id,!this.conversation.ismuted),this.conversation.ismuted=!this.conversation.ismuted,d.a.getConversation(this.conversation.id,void 0,!0),r.b.trigger(d.b.UPDATE_CONVERSATION_LIST_EVENT,{conversationId:this.conversation.id,action:"mute",value:this.conversation.ismuted},this.siteId)}catch(e){h.a.showErrorModalDefault(e,"Error changing muted state.")}finally{this.muteIcon=this.conversation.ismuted?"fas-bell":"fas-bell-slash",e&&e()}}}))}setContactRequestInfo(){var e,s;this.requestContactSent=!1,this.requestContactReceived=!1,this.otherMember&&!this.otherMember.iscontact&&(this.requestContactSent=!!(null===(e=this.otherMember.contactrequests)||void 0===e?void 0:e.some((e=>e.userid==this.currentUserId&&e.requesteduserid==this.otherMember.id))),this.requestContactReceived=!!(null===(s=this.otherMember.contactrequests)||void 0===s?void 0:s.some((e=>e.userid==this.otherMember.id&&e.requesteduserid==this.currentUserId))))}setFooterType(){this.footerType=this.otherMember?this.otherMember.isblocked?"blocked":this.requestContactReceived?"requestReceived":this.otherMember.canmessage?"message":this.requestContactSent?"requestSent":this.otherMember.requirescontact?"requiresContact":"unable":"message"}blockUser(){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.otherMember)throw new I.a("No member selected to be blocked.");if(this.otherMember.canmessageevenifblocked)return h.a.showErrorModal(O.M.instant("addon.messages.cantblockuser",{$a:this.otherMember.fullname})),void 0;const e=O.M.instant("addon.messages.blockuserconfirm",{$a:this.otherMember.fullname}),s=O.M.instant("addon.messages.blockuser");try{yield h.a.showConfirm(e,void 0,s),this.blockIcon=R.a.ICON_LOADING;const t=yield h.a.showModalLoading("core.sending",!0);this.showLoadingModal=!0;try{try{yield d.a.blockContact(this.otherMember.id)}finally{t.dismiss(),this.showLoadingModal=!1}}catch(e){h.a.showErrorModalDefault(e,"core.error",!0)}finally{this.blockIcon=this.otherMember.isblocked?"fas-user-check":"fas-user-lock"}}catch(e){}}))}deleteConversation(e){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.conversation)return;const s="addon.messages."+(this.isSelf?"deleteallselfconfirm":"deleteallconfirm");try{yield h.a.showDeleteConfirm(s),this.deleteIcon=R.a.ICON_LOADING;try{try{yield d.a.deleteConversation(this.conversation.id),r.b.trigger(d.b.UPDATE_CONVERSATION_LIST_EVENT,{conversationId:this.conversation.id,action:"delete"},this.siteId),this.messages=[]}finally{e&&e()}}catch(e){h.a.showErrorModalDefault(e,"Error deleting conversation.")}finally{this.deleteIcon="fas-trash"}}catch(e){}}))}unblockUser(){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.otherMember)throw new I.a("No member selected to be unblocked.");const e=O.M.instant("addon.messages.unblockuserconfirm",{$a:this.otherMember.fullname}),s=O.M.instant("addon.messages.unblockuser");try{yield h.a.showConfirm(e,void 0,s),this.blockIcon=R.a.ICON_LOADING;const t=yield h.a.showModalLoading("core.sending",!0);this.showLoadingModal=!0;try{try{yield d.a.unblockContact(this.otherMember.id)}finally{t.dismiss(),this.showLoadingModal=!1}}catch(e){h.a.showErrorModalDefault(e,"core.error",!0)}finally{this.blockIcon=this.otherMember.isblocked?"fas-user-check":"fas-user-lock"}}catch(e){}}))}createContactRequest(){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.otherMember)throw new I.a("No member selected to be requested.");const e=O.M.instant("addon.messages.addcontactconfirm",{$a:this.otherMember.fullname}),s=O.M.instant("core.add");try{yield h.a.showConfirm(e,void 0,s),this.addRemoveIcon=R.a.ICON_LOADING;const t=yield h.a.showModalLoading("core.sending",!0);this.showLoadingModal=!0;try{try{yield d.a.createContactRequest(this.otherMember.id)}finally{t.dismiss(),this.showLoadingModal=!1}}catch(e){h.a.showErrorModalDefault(e,"core.error",!0)}finally{this.addRemoveIcon="fas-user-plus"}}catch(e){}}))}confirmContactRequest(){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.otherMember)throw new I.a("No member selected to be confirmed.");const e=yield h.a.showModalLoading("core.sending",!0);this.showLoadingModal=!0;try{try{yield d.a.confirmContactRequest(this.otherMember.id)}finally{e.dismiss(),this.showLoadingModal=!1}}catch(e){h.a.showErrorModalDefault(e,"core.error",!0)}}))}declineContactRequest(){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.otherMember)throw new I.a("No member selected to be declined.");const e=yield h.a.showModalLoading("core.sending",!0);this.showLoadingModal=!0;try{try{yield d.a.declineContactRequest(this.otherMember.id)}finally{e.dismiss(),this.showLoadingModal=!1}}catch(e){h.a.showErrorModalDefault(e,"core.error",!0)}}))}removeContact(){return Object(i.a)(this,void 0,void 0,(function*(){if(!this.otherMember)throw new I.a("No member selected to be removed.");const e=O.M.instant("addon.messages.removecontactconfirm",{$a:this.otherMember.fullname}),s=O.M.instant("core.remove");try{yield h.a.showConfirm(e,void 0,s),this.addRemoveIcon=R.a.ICON_LOADING;const t=yield h.a.showModalLoading("core.sending",!0);this.showLoadingModal=!0;try{try{yield d.a.removeContact(this.otherMember.id)}finally{t.dismiss(),this.showLoadingModal=!1}}catch(e){h.a.showErrorModalDefault(e,"core.error",!0)}finally{this.addRemoveIcon="fas-user-plus"}}catch(e){}}))}ngOnDestroy(){var e,s;this.unsetPolling(),null===(e=this.syncObserver)||void 0===e||e.off(),null===(s=this.memberInfoObserver)||void 0===s||s.off(),this.viewDestroyed=!0}}return AddonMessagesDiscussionPage.ɵfac=function AddonMessagesDiscussionPage_Factory(e){return new(e||AddonMessagesDiscussionPage)(y.yc(n.a),y.yc(y.r))},AddonMessagesDiscussionPage.ɵcmp=y.sc({type:AddonMessagesDiscussionPage,selectors:[["page-addon-messages-discussion"]],viewQuery:function AddonMessagesDiscussionPage_Query(e,s){var t;(1&e&&(y.ud(a.v,!0),y.ud(v.a,!0)),2&e)&&(y.dd(t=y.Nc())&&(s.content=t.first),y.dd(t=y.Nc())&&(s.infinite=t.first))},decls:47,vars:87,consts:[["slot","start"],[3,"text"],["class","core-bar-button-image","alt","","onError","this.src='assets/img/group-avatar.svg'","core-external-content","","role","presentation",3,"src","siteId",4,"ngIf"],["class","core-bar-button-image",3,"user","linkProfile","checkOnline",4,"ngIf"],["contextLevel","system",3,"text","contextInstanceId"],["name","fas-star",4,"ngIf"],["name","fas-bell-slash",4,"ngIf"],["slot","end"],["iconAction","fas-info-circle",3,"hidden","priority","content","action"],[3,"hidden","priority","closeOnClick","content","iconAction","iconSlash","action"],[3,"hidden","priority","content","iconAction","action"],[3,"hidden","priority","closeOnClick","content","iconAction","action"],["iconAction","toggle",3,"hidden","priority","content","toggle","toggleChange"],[3,"hidden","priority","content","closeOnClick","iconAction","action"],[3,"hidden","priority","content","iconAction","iconSlash","action"],[3,"ionScroll"],[3,"hideUntil"],["position","top",3,"enabled","error","action"],[4,"ngIf"],[1,"sr-only"],[1,"addon-messages-discussion-container"],[4,"ngFor","ngForOf"],["icon","far-comments",3,"message",4,"ngIf"],["slot","fixed","core-fab","","vertical","bottom","horizontal","end",4,"ngIf"],["class","footer-adjustable",4,"ngIf"],["alt","","onError","this.src='assets/img/group-avatar.svg'","core-external-content","","role","presentation",1,"core-bar-button-image",3,"src","siteId"],[1,"core-bar-button-image",3,"user","linkProfile","checkOnline"],["name","fas-star"],["name","fas-bell-slash"],[1,"ion-text-center"],["class","ion-text-center addon-messages-date",4,"ngIf"],["class","addon-messages-unreadfrom","color","light",4,"ngIf"],[1,"ion-text-wrap","addon-message",3,"longPress"],["class","item-heading addon-message-user",4,"ngIf"],["class","sr-only",4,"ngIf"],[1,"addon-message-text"],["contextLevel","system",3,"text","contextInstanceId","afterRender"],["slot","end",4,"ngIf"],["fill","clear","class","addon-messages-delete-button","slot","end",3,"click",4,"ngIf"],["class","tail",4,"ngIf"],[1,"ion-text-center","addon-messages-date"],["color","light",1,"addon-messages-unreadfrom"],["name","fas-arrow-down","aria-hidden","true"],[1,"item-heading","addon-message-user"],["slot","start","aria-hidden","true",3,"user","linkProfile"],["name","fas-clock","role","status"],["fill","clear","slot","end",1,"addon-messages-delete-button",3,"click"],["name","fas-trash","color","danger","slot","icon-only","aria-hidden","true"],[1,"tail"],["icon","far-comments",3,"message"],["slot","fixed","core-fab","","vertical","bottom","horizontal","end"],["size","small","color","light",3,"click"],[1,"core-discussion-messages-badge"],[1,"footer-adjustable"],[3,"color"],["class","ion-text-center ion-margin-horizontal",4,"ngIf"],["class","ion-padding-horizontal",4,"ngIf"],[3,"showKeyboard","placeholder","onSubmit",4,"ngIf"],[1,"ion-text-center","ion-margin-horizontal"],[1,"ion-padding-horizontal"],["expand","block",1,"ion-text-wrap","ion-margin-bottom",3,"click"],["expand","block","fill","outline",1,"ion-text-wrap","ion-margin-bottom",3,"click"],["class","ion-text-center",4,"ngIf"],[3,"showKeyboard","placeholder","onSubmit"]],template:function AddonMessagesDiscussionPage_Template(e,s){1&e&&(y.Ec(0,"ion-header"),y.Ec(1,"ion-toolbar"),y.Ec(2,"ion-buttons",0),y.zc(3,"ion-back-button",1),y.Pc(4,"translate"),y.Dc(),y.Ec(5,"ion-title"),y.Ec(6,"h1"),y.nd(7,AddonMessagesDiscussionPage_img_7_Template,1,2,"img",2),y.nd(8,AddonMessagesDiscussionPage_core_user_avatar_8_Template,1,3,"core-user-avatar",3),y.zc(9,"core-format-text",4),y.nd(10,AddonMessagesDiscussionPage_ion_icon_10_Template,2,3,"ion-icon",5),y.nd(11,AddonMessagesDiscussionPage_ion_icon_11_Template,2,3,"ion-icon",6),y.Dc(),y.Dc(),y.zc(12,"ion-buttons",7),y.Dc(),y.Ec(13,"core-navbar-buttons",7),y.Ec(14,"core-context-menu"),y.Pc(15,"translate"),y.Ec(16,"core-context-menu-item",8),y.Mc("action",(function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_16_listener(){return s.viewInfo()})),y.Pc(17,"translate"),y.Dc(),y.Ec(18,"core-context-menu-item",8),y.Mc("action",(function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_18_listener(){return s.viewInfo()})),y.Pc(19,"translate"),y.Dc(),y.Ec(20,"core-context-menu-item",9),y.Mc("action",(function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_20_listener(e){return s.changeFavourite(e)})),y.Pc(21,"translate"),y.Dc(),y.Ec(22,"core-context-menu-item",10),y.Mc("action",(function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_22_listener(){return s.blockUser()})),y.Pc(23,"translate"),y.Dc(),y.Ec(24,"core-context-menu-item",10),y.Mc("action",(function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_24_listener(){return s.unblockUser()})),y.Pc(25,"translate"),y.Dc(),y.Ec(26,"core-context-menu-item",11),y.Mc("action",(function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_26_listener(e){return s.changeMute(e)})),y.Pc(27,"translate"),y.Dc(),y.Ec(28,"core-context-menu-item",12),y.Mc("toggleChange",(function AddonMessagesDiscussionPage_Template_core_context_menu_item_toggleChange_28_listener(e){return s.showDelete=e})),y.Pc(29,"translate"),y.Dc(),y.Ec(30,"core-context-menu-item",13),y.Mc("action",(function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_30_listener(e){return s.deleteConversation(e)})),y.Pc(31,"translate"),y.Dc(),y.Ec(32,"core-context-menu-item",10),y.Mc("action",(function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_32_listener(){return s.createContactRequest()})),y.Pc(33,"translate"),y.Dc(),y.Ec(34,"core-context-menu-item",14),y.Mc("action",(function AddonMessagesDiscussionPage_Template_core_context_menu_item_action_34_listener(){return s.removeContact()})),y.Pc(35,"translate"),y.Dc(),y.Dc(),y.Dc(),y.Dc(),y.Ec(36,"ion-content",15),y.Mc("ionScroll",(function AddonMessagesDiscussionPage_Template_ion_content_ionScroll_36_listener(){return s.scrollFunction()})),y.Ec(37,"core-loading",16),y.Ec(38,"core-infinite-loading",17),y.Mc("action",(function AddonMessagesDiscussionPage_Template_core_infinite_loading_action_38_listener(e){return s.loadPrevious(e)})),y.Dc(),y.nd(39,AddonMessagesDiscussionPage_ng_container_39_Template,8,6,"ng-container",18),y.Ec(40,"h2",19),y.pd(41),y.Dc(),y.Ec(42,"ion-list",20),y.nd(43,AddonMessagesDiscussionPage_ng_container_43_Template,13,17,"ng-container",21),y.Dc(),y.nd(44,AddonMessagesDiscussionPage_core_empty_box_44_Template,2,3,"core-empty-box",22),y.Dc(),y.nd(45,AddonMessagesDiscussionPage_ion_fab_45_Template,9,7,"ion-fab",23),y.Dc(),y.nd(46,AddonMessagesDiscussionPage_ion_footer_46_Template,8,7,"ion-footer",24)),2&e&&(y.lc(3),y.Vc("text",y.Qc(4,63,"core.back")),y.lc(4),y.Vc("ngIf",s.loaded&&!s.otherMember&&s.conversationImage),y.lc(1),y.Vc("ngIf",s.loaded&&s.otherMember),y.lc(1),y.Vc("text",s.title)("contextInstanceId",0),y.lc(1),y.Vc("ngIf",s.conversation&&s.conversation.isfavourite),y.lc(1),y.Vc("ngIf",s.conversation&&s.conversation.ismuted),y.lc(3),y.mc("aria-label",y.Qc(15,65,"addon.messages.conversationactions")),y.lc(2),y.Vc("hidden",s.isSelf||!s.showInfo||s.isGroup)("priority",1e3)("content",y.Qc(17,67,"addon.messages.info")),y.lc(2),y.Vc("hidden",s.isSelf||!s.showInfo||!s.isGroup)("priority",1e3)("content",y.Qc(19,69,"addon.messages.groupinfo")),y.lc(2),y.Vc("hidden",!s.groupMessagingEnabled||!s.conversation)("priority",800)("closeOnClick",!1)("content",y.Qc(21,71,s.conversation&&s.conversation.isfavourite?"addon.messages.removefromfavourites":"addon.messages.addtofavourites"))("iconAction",s.favouriteIcon)("iconSlash",s.favouriteIconSlash),y.lc(2),y.Vc("hidden",s.isSelf||!s.otherMember||s.otherMember.isblocked)("priority",700)("content",y.Qc(23,73,"addon.messages.blockuser"))("iconAction",s.blockIcon),y.lc(2),y.Vc("hidden",s.isSelf||!s.otherMember||!s.otherMember.isblocked)("priority",700)("content",y.Qc(25,75,"addon.messages.unblockuser"))("iconAction",s.blockIcon),y.lc(2),y.Vc("hidden",s.isSelf||!s.muteEnabled||!s.conversation)("priority",600)("closeOnClick",!1)("content",y.Qc(27,77,s.conversation&&s.conversation.ismuted?"addon.messages.unmuteconversation":"addon.messages.muteconversation"))("iconAction",s.muteIcon),y.lc(2),y.Vc("hidden",!s.canDelete||!s.messages||!s.messages.length)("priority",400)("content",y.Qc(29,79,"addon.messages.showdeletemessages"))("toggle",s.showDelete),y.lc(2),y.Vc("hidden",!s.groupMessagingEnabled||!s.conversationId||s.isGroup||!s.messages||!s.messages.length)("priority",200)("content",y.Qc(31,81,"addon.messages.deleteconversation"))("closeOnClick",!1)("iconAction",s.deleteIcon),y.lc(2),y.Vc("hidden",s.isSelf||!s.otherMember||s.otherMember.iscontact||s.requestContactSent||s.requestContactReceived)("priority",100)("content",y.Qc(33,83,"addon.messages.addtoyourcontacts"))("iconAction",s.addRemoveIcon),y.lc(2),y.Vc("hidden",s.isSelf||!s.otherMember||!s.otherMember.iscontact)("priority",100)("content",y.Qc(35,85,"addon.messages.removefromyourcontacts"))("iconAction",s.addRemoveIcon)("iconSlash",!0),y.lc(3),y.Vc("hideUntil",s.loaded),y.lc(1),y.Vc("enabled",s.canLoadMore)("error",s.loadMoreError),y.lc(1),y.Vc("ngIf",s.isSelf&&!s.canLoadMore),y.lc(2),y.qd(s.title),y.lc(1),y.qc("addon-messages-discussion-group",s.isGroup),y.mc("aria-live","polite"),y.lc(1),y.Vc("ngForOf",s.messages),y.lc(1),y.Vc("ngIf",!s.messages||s.messages.length<=0),y.lc(1),y.Vc("ngIf",s.loaded&&s.newMessages>0),y.lc(1),y.Vc("ngIf",s.loaded&&(!s.conversationId||s.conversation)))},directives:[a.C,a.Ab,a.m,a.h,a.i,a.yb,x.t,S.a,F.a,U.a,z.a,A.a,a.v,k.a,v.a,a.P,x.s,T.a,V.a,a.D,E.a,a.I,j.a,a.O,a.t,a.W,w.a,a.l,Q.a,a.x,B.a,a.y,a.k,a.A,G.a],pipes:[L.d,$.a],styles:['.ios[_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child, .ios   [_nghost-%COMP%]   ion-footer[_ngcontent-%COMP%]   .toolbar[_ngcontent-%COMP%]:last-child{padding-bottom:4px;min-height:0}ion-content[_ngcontent-%COMP%]{--content-background:var(--background-alternative);--background:var(--content-background)}ion-content[_ngcontent-%COMP%]::part(scroll){padding-bottom:0!important}.addon-messages-discussion-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding-bottom:16px!important;background:var(--content-background)}.addon-messages-date[_ngcontent-%COMP%]{font-weight:400;font-size:.9rem}ion-item.addon-message[_ngcontent-%COMP%]{--message-background:var(--addon-messages-message-bg);--message-activated-background:var(--addon-messages-message-activated-bg);--message-alignment:flex-start;border:0;border-radius:var(--medium-radius);padding:0 8px;margin:8px;--background:var(--message-background);background:var(--message-background);align-self:var(--message-alignment);width:90%;max-width:var(--list-item-max-width);--min-height:var(--a11y-min-target-size);position:relative;transition:width .5s ease-in-out;overflow:visible}ion-item.addon-message[_ngcontent-%COMP%]::part(native){--inner-border-width:0px;--inner-padding-end:0px;padding:0;margin:0}ion-item.addon-message[_ngcontent-%COMP%]:hover{filter:drop-shadow(2px 2px 2px rgba(0,0,0,.3))}ion-item.addon-message[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:only-child{display:inline}ion-item.addon-message[_ngcontent-%COMP%]   .addon-message-user[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;align-items:center;margin-bottom:.5rem;margin-top:0;color:var(--ion-text-color)}ion-item.addon-message[_ngcontent-%COMP%]   .addon-message-user[_ngcontent-%COMP%]   core-user-avatar[_ngcontent-%COMP%]{display:block;--core-avatar-size:var(--addon-messages-avatar-size);margin:0}ion-item.addon-message[_ngcontent-%COMP%]   .addon-message-user[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{font-weight:500;flex-grow:1;padding-left:.5rem;padding-right:.5rem;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}ion-item.addon-message[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{color:var(--addon-messages-message-note-text);font-size:var(--addon-messages-message-note-font-size);margin:0;padding:8px 0;align-self:flex-start}ion-item.addon-message[tappable][_ngcontent-%COMP%]:active{--message-background:var(--message-activated-background)}ion-item.addon-message[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin:0;padding:8px 0}ion-item.addon-message[_ngcontent-%COMP%]   .addon-message-text[_ngcontent-%COMP%]{display:inline-flex}ion-item.addon-message[_ngcontent-%COMP%]   .addon-message-text[_ngcontent-%COMP%]   *[_ngcontent-%COMP%]{color:var(--ion-text-color)}ion-item.addon-message[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{content:"";width:0;height:0;position:absolute;touch-action:none;bottom:0;border:.5rem solid transparent;border-bottom:.5rem solid var(--message-background)}ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]{--message-background:var(--addon-messages-message-mine-bg);--message-activated-background:var(--addon-messages-message-mine-activated-bg);--message-alignment:flex-end}ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{float:right;margin:2px -3px -2px 5px}[dir=rtl][_nghost-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{float:left}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{margin-left:unset;margin-right:unset;-webkit-margin-start:5px;margin-inline-start:5px;-webkit-margin-end:-3px;margin-inline-end:-3px}}ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{width:16px;height:16px}ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{right:-8px;margin-right:-.5rem}[dir=rtl][_nghost-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{left:unset;right:unset;left:-8px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){ion-item.addon-message.addon-message-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{margin-right:unset;-webkit-margin-end:-.5rem;margin-inline-end:-.5rem}}ion-item.addon-message.addon-message-not-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{left:-8px;margin-left:-.5rem}[dir=rtl][_nghost-%COMP%]   ion-item.addon-message.addon-message-not-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   ion-item.addon-message.addon-message-not-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%], [dir=rtl][_ngcontent-%COMP%]   ion-item.addon-message.addon-message-not-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{left:unset;right:unset;right:-8px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){ion-item.addon-message.addon-message-not-mine[_ngcontent-%COMP%]   .tail[_ngcontent-%COMP%]{margin-left:unset;-webkit-margin-start:-.5rem;margin-inline-start:-.5rem}}ion-item.addon-message[_ngcontent-%COMP%]   .addon-messages-delete-button[_ngcontent-%COMP%]{min-height:0;line-height:normal;margin-top:0;margin-bottom:0;height:var(--a11y-min-target-size)!important;align-self:flex-end}ion-item.addon-message[_ngcontent-%COMP%]   .addon-messages-delete-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.4em;line-height:normal;color:var(--danger)}ion-item.addon-message.addon-message-no-user[_ngcontent-%COMP%]{margin-top:0}[_nghost-%COMP%]   .addon-messages-unreadfrom[_ngcontent-%COMP%]{margin-top:6px;margin-left:auto;margin-right:auto}[_nghost-%COMP%]   .addon-messages-unreadfrom[_ngcontent-%COMP%], [_nghost-%COMP%]   .addon-messages-unreadfrom[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{color:var(--primary);background-color:initial}[_nghost-%COMP%]   .has-fab[_ngcontent-%COMP%]   .scroll-content[_ngcontent-%COMP%]{padding-bottom:0}[_nghost-%COMP%]   ion-fab[_ngcontent-%COMP%]   .core-discussion-messages-badge[_ngcontent-%COMP%]{position:absolute;color:var(--addon-messages-discussion-badge-text);background-color:var(--addon-messages-discussion-badge);display:block;right:0;top:0}[dir=rtl][_nghost-%COMP%]   ion-fab[_ngcontent-%COMP%]   .core-discussion-messages-badge[_ngcontent-%COMP%], [dir=rtl]   [_nghost-%COMP%]   ion-fab[_ngcontent-%COMP%]   .core-discussion-messages-badge[_ngcontent-%COMP%]{left:unset;right:unset;left:0}[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]{padding:0}[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0}[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .core-bar-button-image[_ngcontent-%COMP%]{margin-right:6px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   .core-bar-button-image[_ngcontent-%COMP%]{margin-right:unset;-webkit-margin-end:6px;margin-inline-end:6px}}[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;flex-shrink:1}[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:6px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   ion-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-left:unset;-webkit-margin-start:6px;margin-inline-start:6px}}.ios[_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%], .ios   [_nghost-%COMP%]   ion-header[_ngcontent-%COMP%]   ion-toolbar[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{justify-content:center}'],data:{animation:[C.a.SLIDE_IN_OUT]}}),AddonMessagesDiscussionPage})(),H=(()=>{class AddonMessagesComponentsModule{}return AddonMessagesComponentsModule.ɵmod=y.wc({type:AddonMessagesComponentsModule}),AddonMessagesComponentsModule.ɵinj=y.vc({factory:function AddonMessagesComponentsModule_Factory(e){return new(e||AddonMessagesComponentsModule)},imports:[[o.a]]}),AddonMessagesComponentsModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&y.kd(H,{declarations:[N],imports:[o.a]}));const J=[{path:"",component:K}];let Y=(()=>{class AddonMessagesDiscussionPageModule{}return AddonMessagesDiscussionPageModule.ɵmod=y.wc({type:AddonMessagesDiscussionPageModule}),AddonMessagesDiscussionPageModule.ɵinj=y.vc({factory:function AddonMessagesDiscussionPageModule_Factory(e){return new(e||AddonMessagesDiscussionPageModule)},imports:[[n.m.forChild(J),o.a,H],n.m]}),AddonMessagesDiscussionPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&y.kd(Y,{declarations:[K],imports:[n.m,o.a,H],exports:[n.m]}))}}]);