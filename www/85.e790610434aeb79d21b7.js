(window.webpackJsonp=window.webpackJsonp||[]).push([[85],{csSw:function(t,o,i){"use strict";i.r(o),i.d(o,"AddonNotificationsNotificationPageModule",(function(){return y}));var n=i("tyNb"),e=i("L3Fv"),c=i("mrSG"),a=i("yjU1"),r=i("ssuw"),s=i("mbU7"),d=i("pHTc"),l=i("9+EE"),m=i("3LXp"),g=i("bFG1"),f=i("fXoL"),_=i("TEn/"),u=i("nt/U"),p=i("PgjG"),h=i("ofXK"),P=i("hMzs"),O=i("FeAf"),b=i("eAud"),M=i("3jOR"),v=i("ACYt"),N=i("3CSS"),x=i("sYmb"),C=i("lAaw"),A=i("dne1");function AddonNotificationsNotificationPage_core_user_avatar_13_div_1_Template(t,o){if(1&t&&(f.Ec(0,"div",15),f.zc(1,"img",16),f.Dc()),2&t){const t=f.Oc(2);f.lc(1),f.Vc("src",t.iconUrl,f.id)}}function AddonNotificationsNotificationPage_core_user_avatar_13_core_mod_icon_2_Template(t,o){if(1&t&&f.zc(0,"core-mod-icon",17),2&t){const t=f.Oc(2);f.Vc("modicon",t.iconUrl)("modname",t.modname)("showAlt",!1)}}function AddonNotificationsNotificationPage_core_user_avatar_13_Template(t,o){if(1&t&&(f.Ec(0,"core-user-avatar",12),f.nd(1,AddonNotificationsNotificationPage_core_user_avatar_13_div_1_Template,2,1,"div",13),f.nd(2,AddonNotificationsNotificationPage_core_user_avatar_13_core_mod_icon_2_Template,1,3,"core-mod-icon",14),f.Dc()),2&t){const t=f.Oc();f.Vc("userId",t.userIdFrom)("profileUrl",t.profileImageUrlFrom)("fullname",t.userFromFullName),f.lc(1),f.Vc("ngIf",t.iconUrl&&!t.modname),f.lc(1),f.Vc("ngIf",t.modname)}}function AddonNotificationsNotificationPage_ng_container_14_div_1_Template(t,o){if(1&t&&(f.Ec(0,"div",20),f.zc(1,"img",16),f.Dc()),2&t){const t=f.Oc(2);f.lc(1),f.Vc("src",t.iconUrl,f.id)}}function AddonNotificationsNotificationPage_ng_container_14_core_mod_icon_2_Template(t,o){if(1&t&&f.zc(0,"core-mod-icon",21),2&t){const t=f.Oc(2);f.Vc("modicon",t.iconUrl)("modname",t.modname)("showAlt",!1)}}function AddonNotificationsNotificationPage_ng_container_14_Template(t,o){if(1&t&&(f.Cc(0),f.nd(1,AddonNotificationsNotificationPage_ng_container_14_div_1_Template,2,1,"div",18),f.nd(2,AddonNotificationsNotificationPage_ng_container_14_core_mod_icon_2_Template,1,3,"core-mod-icon",19),f.Bc()),2&t){const t=f.Oc();f.lc(1),f.Vc("ngIf",!t.modname),f.lc(1),f.Vc("ngIf",t.modname)}}function AddonNotificationsNotificationPage_ng_container_21_Template(t,o){if(1&t&&(f.Cc(0),f.pd(1),f.Bc()),2&t){const t=f.Oc();f.lc(1),f.rd(" · ",t.userFromFullName,"")}}function AddonNotificationsNotificationPage_div_26_ion_button_2_Template(t,o){if(1&t&&(f.Ec(0,"ion-button",25),f.Mc("click",(function AddonNotificationsNotificationPage_div_26_ion_button_2_Template_ion_button_click_0_listener(){return o.$implicit.action()})),f.zc(1,"ion-icon",26),f.pd(2),f.Pc(3,"translate"),f.Dc()),2&t){const t=o.$implicit;f.lc(1),f.Wc("name",t.icon),f.lc(1),f.rd(" ",f.Qc(3,2,t.message)," ")}}function AddonNotificationsNotificationPage_div_26_Template(t,o){if(1&t&&(f.Ec(0,"div",22),f.Ec(1,"div",23),f.nd(2,AddonNotificationsNotificationPage_div_26_ion_button_2_Template,4,4,"ion-button",24),f.Dc(),f.Dc()),2&t){const t=f.Oc();f.lc(2),f.Vc("ngForOf",t.actions)}}let I=(()=>{class AddonNotificationsNotificationPage{constructor(){this.subject="",this.content="",this.userIdFrom=-1,this.loaded=!1,this.timecreated=0,this.actions=[]}ngOnInit(){var t;return Object(c.a)(this,void 0,void 0,(function*(){let o;try{o=d.a.getRequiredRouteParam("notification")}catch(t){return m.a.showErrorModal(t),d.a.back(),void 0}if(!("subject"in o)){const t=Number(o.savedmessageid),i=yield g.a.ignoreErrors(a.a.getNotifications([],{siteId:o.site})),n=null==i?void 0:i.notifications.find((o=>o.id===t));n&&(o=r.a.formatNotificationText(n))}if("subject"in o){if(this.subject=o.subject,this.content=o.mobiletext||o.fullmessagehtml,this.userIdFrom=o.useridfrom,this.profileImageUrlFrom=o.profileimageurlfrom,this.userFromFullName=o.userfromfullname,this.iconUrl=o.iconurl,(null===(t=o.moodlecomponent)||void 0===t?void 0:t.startsWith("mod_"))&&o.iconurl){const t=o.moodlecomponent.substring(4);(o.iconurl.match("/theme/image.php/[^/]+/"+t+"/[-0-9]*/")||o.iconurl.match("/theme/image.php/[^/]+/"+o.moodlecomponent+"/[-0-9]*/"))&&(this.modname=t)}this.timecreated=o.timecreated}else this.subject=o.title||"",this.content=o.message||"",this.userIdFrom=o.userfromid?Number(o.userfromid):-1,this.profileImageUrlFrom=o.senderImage,this.userFromFullName=o.userfromfullname;yield this.loadActions(o),r.a.markNotificationAsRead(o),this.loaded=!0}))}loadActions(t){var o;return Object(c.a)(this,void 0,void 0,(function*(){if(!(t.contexturl||t.customdata&&t.customdata.appurl))return;let i=[];this.actionsData=t.customdata,this.contextUrl=t.contexturl,this.courseId="courseid"in t?t.courseid:void 0,(null===(o=this.actionsData)||void 0===o?void 0:o.appurl)&&(i=yield s.a.getActionsFor(this.actionsData.appurl,this.courseId,void 0,this.actionsData)),!i.length&&this.contextUrl&&(i=yield s.a.getActionsFor(this.contextUrl,this.courseId,void 0,this.actionsData)),i.length||i.push({message:"core.view",icon:"fas-eye",action:this.openInBrowser.bind(this)}),this.actions=i}))}openInBrowser(t){var o;return Object(c.a)(this,void 0,void 0,(function*(){const i=(null===(o=this.actionsData)||void 0===o?void 0:o.appurl)||this.contextUrl;if(!i)return;(yield l.b.getSite(t)).openInBrowserWithAutoLogin(i)}))}}return AddonNotificationsNotificationPage.ɵfac=function AddonNotificationsNotificationPage_Factory(t){return new(t||AddonNotificationsNotificationPage)},AddonNotificationsNotificationPage.ɵcmp=f.sc({type:AddonNotificationsNotificationPage,selectors:[["page-addon-notifications-notification"]],decls:27,vars:21,consts:[["slot","start"],[3,"text"],[3,"hideUntil"],[1,"list-item-limited-width"],["lines","full",1,"ion-text-wrap","core-notification-title"],["slot","start",3,"userId","profileUrl","fullname",4,"ngIf"],[4,"ngIf"],[1,"item-heading"],["contextLevel","system",3,"text","contextInstanceId","wsNotFiltered"],[1,"ion-text-wrap","core-notification-body"],["contextLevel","system",3,"text","contextInstanceId"],["collapsible-footer","","appearOnBottom","","slot","fixed",4,"ngIf"],["slot","start",3,"userId","profileUrl","fullname"],["class","core-avatar-extra-img",4,"ngIf"],[3,"modicon","modname","showAlt",4,"ngIf"],[1,"core-avatar-extra-img"],["alt","","role","presentation",3,"src"],[3,"modicon","modname","showAlt"],["class","core-notification-icon","slot","start",4,"ngIf"],["class","core-notification-icon","slot","start",3,"modicon","modname","showAlt",4,"ngIf"],["slot","start",1,"core-notification-icon"],["slot","start",1,"core-notification-icon",3,"modicon","modname","showAlt"],["collapsible-footer","","appearOnBottom","","slot","fixed"],[1,"list-item-limited-width","adaptable-buttons-row"],["expand","block",3,"click",4,"ngFor","ngForOf"],["expand","block",3,"click"],["slot","start","aria-hidden","true",3,"name"]],template:function AddonNotificationsNotificationPage_Template(t,o){1&t&&(f.Ec(0,"ion-header"),f.Ec(1,"ion-toolbar"),f.Ec(2,"ion-buttons",0),f.zc(3,"ion-back-button",1),f.Pc(4,"translate"),f.Dc(),f.Ec(5,"ion-title"),f.Ec(6,"h1"),f.pd(7),f.Pc(8,"translate"),f.Dc(),f.Dc(),f.Dc(),f.Dc(),f.Ec(9,"ion-content"),f.Ec(10,"core-loading",2),f.Ec(11,"div",3),f.Ec(12,"ion-item",4),f.nd(13,AddonNotificationsNotificationPage_core_user_avatar_13_Template,3,5,"core-user-avatar",5),f.nd(14,AddonNotificationsNotificationPage_ng_container_14_Template,3,2,"ng-container",6),f.Ec(15,"ion-label"),f.Ec(16,"p",7),f.zc(17,"core-format-text",8),f.Dc(),f.Ec(18,"p"),f.pd(19),f.Pc(20,"coreTimeAgo"),f.nd(21,AddonNotificationsNotificationPage_ng_container_21_Template,2,1,"ng-container",6),f.Dc(),f.Dc(),f.Dc(),f.Ec(22,"ion-item",9),f.Ec(23,"ion-label"),f.zc(24,"core-format-text",10),f.Pc(25,"coreCreateLinks"),f.Dc(),f.Dc(),f.Dc(),f.nd(26,AddonNotificationsNotificationPage_div_26_Template,3,1,"div",11),f.Dc(),f.Dc()),2&t&&(f.lc(3),f.Vc("text",f.Qc(4,13,"core.back")),f.lc(4),f.qd(f.Qc(8,15,"addon.notifications.notifications")),f.lc(3),f.Vc("hideUntil",o.loaded),f.lc(3),f.Vc("ngIf",o.userIdFrom>0),f.lc(1),f.Vc("ngIf",o.userIdFrom<=0&&o.iconUrl),f.lc(3),f.Vc("text",o.subject)("contextInstanceId",0)("wsNotFiltered",!0),f.lc(2),f.qd(f.Qc(20,17,o.timecreated)),f.lc(2),f.Vc("ngIf",o.userIdFrom>0),f.lc(3),f.Vc("text",f.Qc(25,19,o.content))("contextInstanceId",0),f.lc(2),f.Vc("ngIf",o.loaded&&o.actions&&o.actions.length>0))},directives:[_.C,_.Ab,_.m,_.h,_.i,_.yb,u.a,_.v,p.a,_.I,h.t,_.O,P.a,O.a,b.a,M.a,h.s,v.a,_.l,_.D,N.a],pipes:[x.d,C.a,A.a],styles:["[_nghost-%COMP%]{--extra-icon-size:16px;--icon-size:24px}[_nghost-%COMP%]     core-user-avatar .core-avatar-extra-img, [_nghost-%COMP%]     core-user-avatar core-mod-icon{margin:0!important;position:absolute;right:-4px;bottom:-4px;padding:.2rem}[_nghost-%COMP%]     core-user-avatar .core-avatar-extra-img{background:var(--background-color);border-radius:var(--medium-radius)}[_nghost-%COMP%]     core-user-avatar .core-avatar-extra-img img{max-width:var(--extra-icon-size);max-height:var(--extra-icon-size);display:block}[_nghost-%COMP%]     core-user-avatar core-mod-icon{--size:var(--extra-icon-size)}[_nghost-%COMP%]   div.core-notification-icon[_ngcontent-%COMP%]{padding:.7rem;background:var(--background-color);border-radius:var(--small-radius)}[_nghost-%COMP%]   div.core-notification-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:var(--icon-size);height:var(--icon-size)}[_nghost-%COMP%]   .core-notification-icon[_ngcontent-%COMP%]{--module-icon-size:var(--icon-size);margin:6px 8px 6px 0}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .core-notification-icon[_ngcontent-%COMP%]{margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px}}","[_nghost-%COMP%]   .core-notification-title[_ngcontent-%COMP%]   [slot=start][_ngcontent-%COMP%]{align-self:start;margin-top:16px}[_nghost-%COMP%]   .core-notification-title[_ngcontent-%COMP%]   p.item-heading[_ngcontent-%COMP%]{font-size:16px}[_nghost-%COMP%]   .core-notification-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:12px}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]{font-size:var(--text-size)}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .forumpost{border:1px solid var(--gray-200);width:100%;margin:0 0 1em}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .forumpost td{padding:10px}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .forumpost .header{background-color:var(--light)}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .forumpost .header .picture{width:48px;text-align:center;padding-left:4px;padding-right:0;padding-top:8px}@supports ((-webkit-margin-start:0) or (margin-inline-start:0)) or (-webkit-margin-start:0){[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .forumpost .header .picture{padding-left:unset;padding-right:unset;-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:0;padding-inline-end:0}}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .forumpost .header .picture img{width:44px!important}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .forumpost .subject{font-weight:700;margin-bottom:1rem}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     a{text-decoration:none}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .userpicture{border-radius:50%}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .mdl-right{text-align:end}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .mdl-right a{display:none}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .mdl-right font{font-size:.9em}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     .commands{display:none}[_nghost-%COMP%]   .core-notification-body[_ngcontent-%COMP%]   core-format-text[_ngcontent-%COMP%]     hr{margin-top:1.5rem;margin-bottom:1.5rem;background-color:var(--gray-200)}"]}),AddonNotificationsNotificationPage})();const w=[{path:"",component:I}];let y=(()=>{class AddonNotificationsNotificationPageModule{}return AddonNotificationsNotificationPageModule.ɵmod=f.wc({type:AddonNotificationsNotificationPageModule}),AddonNotificationsNotificationPageModule.ɵinj=f.vc({factory:function AddonNotificationsNotificationPageModule_Factory(t){return new(t||AddonNotificationsNotificationPageModule)},imports:[[n.m.forChild(w),e.a],n.m]}),AddonNotificationsNotificationPageModule})();void(("undefined"==typeof ngJitMode||ngJitMode)&&f.kd(y,{declarations:[I],imports:[n.m,e.a],exports:[n.m]}))}}]);